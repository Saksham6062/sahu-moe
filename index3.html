<html lang="en" __gchrome_remoteframetoken="ca798d32ddcee8ff3647ed549e2ae610"><head>
  <script type="module" src="/@vite/client"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <title>SahuAI Agent - Official Saksham Intelligence AI Models Chat</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" href="./icon-512.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@8.2.0/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- File Creation Libraries -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- SAHU 2.0 Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/string-similarity@4.0.4/umd/string-similarity.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas-pro"></script>

    <style>
        :root { --bg-primary: #ffffff; --bg-secondary: #f8f8f8; --bg-tertiary: #efefef; --text-primary: #1a1a1a; --text-secondary: #525252; --accent: #667eea; --accent-hover: #5a6fd6; --border: #e0e0e0; }
        .dark-mode { --bg-primary: #0a0a0a; --bg-secondary: #141414; --bg-tertiary: #1e1e1e; --text-primary: #e5e5e5; --text-secondary: #a3a3a3; --accent: #667eea; --accent-hover: #7c8ff0; --border: #2a2a2a; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        body { background-color: var(--bg-primary); color: var(--text-primary); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; }
        .sidebar { background-color: var(--bg-secondary); border-color: var(--border); }
        .message-user { background: linear-gradient(135deg, var(--accent) 0%, #764ba2 100%); }
        .message-assistant { background-color: var(--bg-tertiary); }
        .input-area { background-color: var(--bg-secondary); border-color: var(--border); }
        .expert-card { background-color: var(--bg-tertiary); border: 1px solid var(--border); transition: all 0.3s ease; }
        .expert-card.thinking { border-color: #f59e0b; box-shadow: 0 0 15px rgba(245, 158, 11, 0.15); }
        .expert-card.complete { border-color: #22c55e; }
        .expert-card.error { border-color: #ef4444; }
        .typing-indicator span { animation: typing 1.4s infinite; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 60%, 100% { transform: translateY(0); opacity: 0.5; } 30% { transform: translateY(-6px); opacity: 1; } }
        .scrollbar-thin::-webkit-scrollbar { width: 5px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: var(--bg-secondary); }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
        pre code { display: block; padding: 12px; background: #1a1a1a; border-radius: 8px; overflow-x: auto; font-family: 'SF Mono', Monaco, monospace; font-size: 12px; line-height: 1.5; color: #e5e5e5; }
        .thinking-block { background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; padding: 12px; margin-bottom: 12px; font-size: 13px; display: block; }
        .thinking-header { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; color: #d97706; font-weight: 600; font-size: 12px; }
        .aggregator-response { background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(102, 126, 234, 0.1) 100%); border: 2px solid var(--accent); }
        .export-buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; padding: 12px; background: var(--bg-tertiary); border-radius: 10px; }
        .export-btn { padding: 8px 14px; border-radius: 8px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 6px; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); min-height: 40px; }
        .export-btn:hover { background: var(--accent); color: white; border-color: var(--accent); }
        .toast { animation: slideIn 0.3s ease-out; position: fixed; bottom: 80px; right: 16px; z-index: 1000; padding: 12px 20px; border-radius: 10px; color: white; display: flex; align-items: center; gap: 10px; font-size: 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .provider-badge { font-size: 10px; padding: 3px 8px; border-radius: 6px; font-weight: 600; margin-bottom: 4px; display: inline-block; }
        .provider-huggingface { background: rgba(255, 213, 0, 0.2); color: #ca8a04; }
        .provider-openrouter { background: rgba(168, 85, 247, 0.2); color: #9333ea; }
        .provider-groq { background: rgba(249, 115, 22, 0.2); color: #ea580c; }
        .provider-together { background: rgba(34, 197, 94, 0.2); color: #16a34a; }
        .provider-cerebras { background: rgba(99, 102, 241, 0.2); color: #6366f1; }
        .provider-sambanova { background: rgba(14, 165, 233, 0.2); color: #0284c7; }
        .provider-fireworks { background: rgba(239, 68, 68, 0.2); color: #dc2626; }
        .provider-routeway { background: rgba(16, 185, 129, 0.2); color: #059669; }
        .provider-mistral { background: rgba(251, 146, 60, 0.2); color: #ea580c; }
        .provider-gemini { background: rgba(59, 130, 246, 0.2); color: #2563eb; }
        .provider-longcat { background: rgba(139, 92, 246, 0.2); color: #7c3aed; }
        .provider-ollama { background: rgba(75, 85, 99, 0.2); color: #374151; }
        .provider-zenmusk { background: rgba(236, 72, 153, 0.2); color: #be185d; }
        .provider-ionet { background: rgba(6, 182, 212, 0.2); color: #0891b2; }
        .provider-nvidia { background: rgba(118, 185, 0, 0.2); color: #76b900; }
        .stage-btn { padding: 4px 10px; font-size: 11px; border-radius: 6px; cursor: pointer; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-secondary); transition: all 0.2s; min-width: 32px; text-align: center; }
        .stage-btn:hover { border-color: var(--accent); }
        .stage-btn.active-1 { background: #f59e0b; color: white; border-color: #f59e0b; }
        .stage-btn.active-2 { background: #06b6d4; color: white; border-color: #06b6d4; }
        .stage-btn.active-3 { background: #22c55e; color: white; border-color: #22c55e; }
        .model-card { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.2s; background: var(--bg-secondary); }
        .model-card:hover { border-color: var(--accent); }
        .model-card.selected { border-color: var(--accent); background: rgba(102, 126, 234, 0.1); }
        .sidebar { position: fixed; left: -100%; top: 0; bottom: 0; z-index: 100; width: 85%; max-width: 300px; transition: left 0.3s ease; overflow-y: auto; }
        .sidebar.open { left: 0; }
        .sidebar-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 99; }
        .sidebar-overlay.show { display: block; }
        .blur-content { filter: blur(5px); user-select: none; pointer-events: none; }
        @media (min-width: 768px) { .sidebar { position: relative; left: 0; width: 280px; } .sidebar-overlay { display: none !important; } }
        @media (max-width: 480px) { .export-btn span { display: none; } .export-btn { padding: 10px 12px; } }

        /* SAHU 2.0 Feature Styles */
        .citation { vertical-align: super; font-size: 0.7em; color: var(--accent); cursor: pointer; margin: 0 1px; font-weight: bold; text-decoration: none; padding: 0 2px; border-radius: 3px; background: rgba(102, 126, 234, 0.1); }
        .citation:hover { text-decoration: none; background: rgba(102, 126, 234, 0.2); }
        
        /* Inline Citation Tooltip */
        .citation-tooltip {
            visibility: hidden;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            text-align: left;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 50;
            width: 250px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            font-size: 11px;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.2s;
        }
        .citation:hover .citation-tooltip { visibility: visible; opacity: 1; }

        .sources-panel { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; padding: 12px; margin-top: 10px; display: block; }
        
        /* SAHUAI SEARCH MODE STYLES */
        body.mode-search-ui .sources-panel { display: none; } /* Replaced by top widget */
        body.mode-search-ui .expert-card { display: none !important; } /* HIDE ALL EXPERT CARDS */
        body.mode-search-ui .consensus-panel { display: none !important; }
        body.mode-search-ui .thinking-block { display: none !important; }
        body.mode-search-ui .aggregator-response { border: none; background: transparent; padding: 0; }
        body.mode-search-ui .stage-btn { display: none; }
        
        /* SEARCH DISCOVERY STYLES */
        /* Animated Gradient for SahuAI Search */
        .shine-text {
            background: linear-gradient(to right, #ef4444, #f59e0b, #10b981, #3b82f6, #6366f1, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            background-size: 200% auto;
            animation: shine 4s linear infinite;
        }
        @keyframes shine { 
            to { background-position: 200% center; } 
        }

        .sahu-search-header { 
            font-family: 'Google Sans', Roboto, sans-serif;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            display: none;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .sahu-search-header:hover { transform: scale(1.02); }

        .discovery-grid { display: none; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; margin-top: 20px; }
        .discovery-card { 
            background: var(--bg-tertiary); 
            border-radius: 12px; 
            padding: 16px; 
            display: flex; 
            flex-direction: column; 
            gap: 8px; 
            text-decoration: none; 
            color: var(--text-primary);
            transition: all 0.2s;
            border: 1px solid var(--border);
        }
        .discovery-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-color: var(--accent); }
        .discovery-source { font-size: 10px; color: var(--text-secondary); display: flex; align-items: center; gap: 6px; }
        .discovery-title { font-weight: 600; font-size: 14px; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .discovery-snippet { font-size: 12px; color: var(--text-secondary); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        body.mode-search-ui .sahu-search-header { display: block; }
        
        .source-card { display: flex; align-items: center; gap: 10px; padding: 10px; border-radius: 8px; background: var(--bg-tertiary); font-size: 12px; text-decoration: none; color: var(--text-primary); margin-bottom: 6px; border: 1px solid transparent; transition: all 0.2s; }
        .source-card:hover { border-color: var(--accent); transform: translateX(2px); }
        .source-favicon { width: 16px; height: 16px; border-radius: 4px; }
        
        .consensus-panel { margin-top: 12px; padding: 10px; background: rgba(102, 126, 234, 0.05); border: 1px solid var(--accent); border-radius: 10px; }
        .tool-card { border: 1px dashed var(--text-secondary); padding: 8px; margin: 4px 0; border-radius: 6px; font-size: 12px; background: var(--bg-secondary); }
        .token-counter { padding: 0 8px; height: 32px; border-radius: 16px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; color: var(--text-secondary); transition: all 0.3s; background: var(--bg-tertiary); gap: 6px; min-width: 80px; }
        .pinned-msg { border-left: 3px solid #f59e0b; background: rgba(245, 158, 11, 0.05); }

        /* Artifact & Code Styles */
        .artifact-container { border: 1px solid var(--border); border-radius: 8px; margin-top: 10px; overflow: hidden; background: var(--bg-primary); }
        .artifact-header { background: var(--bg-tertiary); padding: 8px 12px; font-size: 11px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); font-family: monospace; color: var(--text-secondary); }
        .artifact-content { padding: 0; margin: 0; }
        .artifact-content pre { margin: 0; border-radius: 0; }
        .render-btn { font-size: 11px; padding: 4px 8px; border-radius: 4px; background: #ecfdf5; color: #047857; border: 1px solid #059669; cursor: pointer; display: inline-flex; align-items: center; gap: 4px; margin-top: 8px; }
        .render-btn:hover { background: #d1fae5; }

        /* Agreement Table */
        .agreement-table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 8px; }
        .agreement-table th, .agreement-table td { padding: 6px; border: 1px solid var(--border); text-align: left; }
        .agreement-table th { background: var(--bg-tertiary); font-weight: 600; white-space: nowrap; }
        
        .mode-badge { font-size: 10px; text-transform: uppercase; padding: 2px 6px; border-radius: 4px; margin-left: 6px; font-weight: bold; }
        .mode-standard { background: #e0f2fe; color: #0369a1; }
        .mode-research { background: #fef9c3; color: #a16207; }
        .mode-task { background: #f3e8ff; color: #7e22ce; }
        .mode-search { background: #dcfce7; color: #15803d; }
        .task-btn-vibe { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; }
        .task-btn-agentic { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none; }
        .task-btn-file { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; }

        /* Canvas / Artifact Modal */
        #artifactModal {
            transition: opacity 0.2s ease-in-out;
        }
        .canvas-container {
            display: flex;
            flex-direction: column;
            height: 85vh;
            background: var(--bg-secondary);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .canvas-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }
        .canvas-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-secondary);
            padding: 4px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        .canvas-tab {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .canvas-tab.active {
            background: var(--accent);
            color: white;
        }
        .canvas-body {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        .canvas-editor, .canvas-preview {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
        }
        .canvas-editor.active, .canvas-preview.active {
            display: block;
        }
        .canvas-editor textarea {
            width: 100%;
            height: 100%;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            line-height: 1.6;
            border: none;
            resize: none;
            outline: none;
        }
        iframe.preview-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }
        
        /* Settings Sub-menus */
        .settings-view { display: none; }
        .settings-view.active { display: block; }
        
        /* Research Stage Cards */
        .research-stage { border-left: 2px solid var(--border); padding-left: 12px; margin-bottom: 16px; position: relative; }
        .research-stage::before { content: ''; position: absolute; left: -5px; top: 0; width: 8px; height: 8px; border-radius: 50%; background: var(--border); }
        .research-stage.active { border-color: var(--accent); }
        .research-stage.active::before { background: var(--accent); }
        .research-header { display: flex; align-items: center; justify-content: space-between; font-size: 12px; font-weight: 600; margin-bottom: 8px; cursor: pointer; user-select: none; }
        .research-content { display: none; font-size: 12px; color: var(--text-secondary); background: var(--bg-secondary); padding: 8px; border-radius: 8px; }
        /* Timeline Styles */
        .timeline-container { position: relative; padding: 20px 0; margin-top: 20px; border-top: 1px solid var(--border); }
        .timeline-item { position: relative; padding-left: 30px; margin-bottom: 20px; }
        .timeline-item::before { content: ''; position: absolute; left: 0; top: 5px; width: 12px; height: 12px; border-radius: 50%; background: var(--accent); z-index: 2; }
        .timeline-item::after { content: ''; position: absolute; left: 5px; top: 17px; bottom: -25px; width: 2px; background: var(--border); z-index: 1; }
        .timeline-item:last-child::after { display: none; }
        .timeline-date { font-size: 11px; font-weight: bold; color: var(--accent); margin-bottom: 4px; }
        .timeline-content { font-size: 13px; background: var(--bg-tertiary); padding: 10px; border-radius: 8px; border: 1px solid var(--border); }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
<script src="/_aistudio-iframe.js"></script><script src="https://cdn.jsdelivr.net/npm/html2canvas-pro"></script><style>.aistudio-hover-highlight { box-shadow: inset 0 0 0 0.5px white, inset 0 0 0 1.5px rgba(128,128,128,0.6) !important; }.aistudio-active-highlight { box-shadow: inset 0 0 0 0.5px white, inset 0 0 0 1.5px #87a9ff !important; }#aistudio-focus-mode-tag { position: absolute; display: none; background: #87a9ff; border-radius: 4px; border: 0.5px solid white; z-index: 10000; text-transform: lowercase; padding: 2px 4px; color: #32302c; font-family: Inter, sans-serif; font-size: 12px; font-style: normal; font-weight: 400; line-height: 16px; pointer-events: none; }#aistudio-hover-mode-tag { position: absolute; display: none; background: rgba(128,128,128,0.6); border-radius: 4px; border: 0.5px solid white; z-index: 10000; text-transform: lowercase; padding: 2px 4px; color: white; font-family: Inter, sans-serif; font-size: 12px; font-style: normal; font-weight: 400; line-height: 16px; pointer-events: none; }</style><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.bottom-20{bottom:5rem}.left-4{left:1rem}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:0.5rem}.h-4{height:1rem}.h-full{height:100%}.h-screen{height:100vh}.h-24{height:6rem}.h-5{height:1.25rem}.h-8{height:2rem}.max-h-\[85vh\]{max-height:85vh}.max-h-60{max-height:15rem}.min-h-0{min-height:0px}.w-10{width:2.5rem}.w-16{width:4rem}.w-2{width:0.5rem}.w-4{width:1rem}.w-64{width:16rem}.w-8{width:2rem}.w-full{width:100%}.w-5{width:1.25rem}.min-w-0{min-width:0px}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-md{max-width:28rem}.max-w-lg{max-width:32rem}.flex-1{flex:1 1 0%}.border-collapse{border-collapse:collapse}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.resize-none{resize:none}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.appearance-none{-webkit-appearance:none;appearance:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.rounded{border-radius:0.25rem}.border{border-width:1px}.border-4{border-width:4px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-l-2{border-left-width:2px}.border-\[var\(--border\)\]{border-color:var(--border)}.border-\[var\(--accent\)\]{border-color:var(--accent)}.border-transparent{border-color:transparent}.bg-\[var\(--accent\)\]{background-color:var(--accent)}.bg-\[var\(--bg-secondary\)\]{background-color:var(--bg-secondary)}.bg-\[var\(--bg-tertiary\)\]{background-color:var(--bg-tertiary)}.bg-black\/60{background-color:rgb(0 0 0 / 0.6)}.bg-black\/80{background-color:rgb(0 0 0 / 0.8)}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-indigo-100{--tw-bg-opacity:1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-purple-100{--tw-bg-opacity:1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-teal-100{--tw-bg-opacity:1;background-color:rgb(204 251 241 / var(--tw-bg-opacity, 1))}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity:1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-\[var\(--bg-primary\)\]{background-color:var(--bg-primary)}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right, var(--tw-gradient-stops))}.from-\[\#667eea\]{--tw-gradient-from:#667eea var(--tw-gradient-from-position);--tw-gradient-to:rgb(102 126 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-\[\#764ba2\]{--tw-gradient-to:#764ba2 var(--tw-gradient-to-position)}.p-1\.5{padding:0.375rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-2\.5{padding:0.625rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pb-2{padding-bottom:0.5rem}.pl-2{padding-left:0.5rem}.pl-4{padding-left:1rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-\[10px\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-relaxed{line-height:1.625}.tracking-wider{letter-spacing:0.05em}.text-\[\#667eea\]{--tw-text-opacity:1;color:rgb(102 126 234 / var(--tw-text-opacity, 1))}.text-\[var\(--accent\)\]{color:var(--accent)}.text-\[var\(--text-secondary\)\]{color:var(--text-secondary)}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity:1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity:1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-cyan-500{--tw-text-opacity:1;color:rgb(6 182 212 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity:1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-pink-500{--tw-text-opacity:1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-teal-500{--tw-text-opacity:1;color:rgb(20 184 166 / var(--tw-text-opacity, 1))}.text-teal-600{--tw-text-opacity:1;color:rgb(13 148 136 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity:1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.accent-\[var\(--accent\)\]{accent-color:var(--accent)}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-200{transition-duration:200ms}.ease-in{transition-timing-function:cubic-bezier(0.4, 0, 1, 1)}.hover\:bg-\[var\(--bg-tertiary\)\]:hover{background-color:var(--bg-tertiary)}.hover\:bg-\[var\(--border\)\]:hover{background-color:var(--border)}.hover\:bg-\[var\(--accent-hover\)\]:hover{background-color:var(--accent-hover)}.hover\:bg-\[var\(--accent\)\]:hover{background-color:var(--accent)}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:border-\[var\(--accent\)\]:focus{border-color:var(--accent)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:opacity-50:disabled{opacity:0.5}@media (min-width: 768px){.md\:flex{display:flex}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (prefers-color-scheme: dark){.dark\:bg-yellow-900\/30{background-color:rgb(113 63 18 / 0.3)}.dark\:text-yellow-300{--tw-text-opacity:1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}}</style><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.bottom-20{bottom:5rem}.left-4{left:1rem}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:0.5rem}.h-4{height:1rem}.h-full{height:100%}.h-screen{height:100vh}.h-24{height:6rem}.h-5{height:1.25rem}.h-8{height:2rem}.max-h-\[85vh\]{max-height:85vh}.max-h-60{max-height:15rem}.min-h-0{min-height:0px}.w-10{width:2.5rem}.w-16{width:4rem}.w-2{width:0.5rem}.w-4{width:1rem}.w-64{width:16rem}.w-8{width:2rem}.w-full{width:100%}.w-5{width:1.25rem}.min-w-0{min-width:0px}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-md{max-width:28rem}.max-w-lg{max-width:32rem}.flex-1{flex:1 1 0%}.border-collapse{border-collapse:collapse}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.resize-none{resize:none}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.appearance-none{-webkit-appearance:none;appearance:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.rounded{border-radius:0.25rem}.border{border-width:1px}.border-4{border-width:4px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-l-2{border-left-width:2px}.border-\[var\(--border\)\]{border-color:var(--border)}.border-\[var\(--accent\)\]{border-color:var(--accent)}.border-transparent{border-color:transparent}.bg-\[var\(--accent\)\]{background-color:var(--accent)}.bg-\[var\(--bg-secondary\)\]{background-color:var(--bg-secondary)}.bg-\[var\(--bg-tertiary\)\]{background-color:var(--bg-tertiary)}.bg-black\/60{background-color:rgb(0 0 0 / 0.6)}.bg-black\/80{background-color:rgb(0 0 0 / 0.8)}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-indigo-100{--tw-bg-opacity:1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-purple-100{--tw-bg-opacity:1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-teal-100{--tw-bg-opacity:1;background-color:rgb(204 251 241 / var(--tw-bg-opacity, 1))}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity:1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-\[var\(--bg-primary\)\]{background-color:var(--bg-primary)}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right, var(--tw-gradient-stops))}.from-\[\#667eea\]{--tw-gradient-from:#667eea var(--tw-gradient-from-position);--tw-gradient-to:rgb(102 126 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-\[\#764ba2\]{--tw-gradient-to:#764ba2 var(--tw-gradient-to-position)}.p-1\.5{padding:0.375rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-2\.5{padding:0.625rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pb-2{padding-bottom:0.5rem}.pl-2{padding-left:0.5rem}.pl-4{padding-left:1rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-\[10px\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-relaxed{line-height:1.625}.tracking-wider{letter-spacing:0.05em}.text-\[\#667eea\]{--tw-text-opacity:1;color:rgb(102 126 234 / var(--tw-text-opacity, 1))}.text-\[var\(--accent\)\]{color:var(--accent)}.text-\[var\(--text-secondary\)\]{color:var(--text-secondary)}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity:1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity:1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-cyan-500{--tw-text-opacity:1;color:rgb(6 182 212 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity:1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-pink-500{--tw-text-opacity:1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-teal-500{--tw-text-opacity:1;color:rgb(20 184 166 / var(--tw-text-opacity, 1))}.text-teal-600{--tw-text-opacity:1;color:rgb(13 148 136 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity:1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.accent-\[var\(--accent\)\]{accent-color:var(--accent)}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-200{transition-duration:200ms}.ease-in{transition-timing-function:cubic-bezier(0.4, 0, 1, 1)}.hover\:bg-\[var\(--bg-tertiary\)\]:hover{background-color:var(--bg-tertiary)}.hover\:bg-\[var\(--border\)\]:hover{background-color:var(--border)}.hover\:bg-\[var\(--accent-hover\)\]:hover{background-color:var(--accent-hover)}.hover\:bg-\[var\(--accent\)\]:hover{background-color:var(--accent)}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:border-\[var\(--accent\)\]:focus{border-color:var(--accent)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:opacity-50:disabled{opacity:0.5}@media (min-width: 768px){.md\:flex{display:flex}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (prefers-color-scheme: dark){.dark\:bg-yellow-900\/30{background-color:rgb(113 63 18 / 0.3)}.dark\:text-yellow-300{--tw-text-opacity:1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}}</style></head>
<body class="h-screen overflow-hidden" style="-webkit-text-size-adjust: 50%;">
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
    
    <div id="app" class="flex h-full">
        <aside id="sidebar" class="sidebar flex flex-col border-r border-[var(--border)]">
            <div class="p-4 border-b border-[var(--border)]">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-[#667eea] to-[#764ba2] flex items-center justify-center shadow-lg">
                        <i class="fas fa-robot text-white"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg gradient-text" id="header-title">SahuAI Agent</h1>
                        <p class="text-xs text-[var(--text-secondary)]">Version 4.5</p>
                    </div>
                </div>
            </div>

            <div class="p-3 space-y-2">
                <a href="./sahu-moe.apk" download="" id="btn-install" class="w-full py-2.5 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] text-[var(--text-secondary)] font-medium text-sm flex items-center justify-center gap-2 hover:bg-[var(--border)] transition-colors active:scale-95" style="text-decoration: none;">
                    <i class="fab fa-android text-green-600"></i>
                    <span>Install Android App</span>
                </a>
                <button onclick="newChat()" id="btn-new-chat" class="w-full py-3 px-4 rounded-xl bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white font-semibold flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-transform"><i class="fas fa-plus"></i> New Chat</button>
            </div>

            <!-- PINNED MESSAGES -->
            <div id="pinnedSection" class="px-3 pb-2 hidden">
                <label class="text-xs text-[var(--text-secondary)] mb-2 block font-medium">Pinned</label>
                <div id="pinnedList" class="space-y-1"></div>
            </div>

            <!-- HISTORY LIST (Maximized) -->
            <div class="flex-1 overflow-y-auto scrollbar-thin px-3 min-h-0 flex flex-col">
                 <div class="mb-2 relative mt-2">
                     <input type="text" id="historySearch" placeholder="Search chats..." class="w-full p-2 rounded-lg bg-[var(--bg-tertiary)] text-xs border border-[var(--border)] outline-none" oninput="filterHistory(this.value)" __gchrome_uniqueid="1">
                </div>
                <div id="chatHistory" class="space-y-1 flex-1 overflow-y-auto"></div>
            </div>

            <!-- BOTTOM ACTIONS -->
            <div class="p-3 border-t border-[var(--border)] space-y-2">
                 <button onclick="openModelSelector()" id="btn-config-models" class="w-full py-2 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] text-sm flex items-center justify-between active:scale-95 transition-transform">
                    <span class="flex items-center gap-2">
                        <i class="fas fa-cubes text-[var(--accent)]"></i>
                        Configure Models
                    </span>
                    <span id="selectedModelCount" class="text-xs bg-[var(--accent)] text-white px-2 py-0.5 rounded-full">8</span>
                </button>
                <button onclick="openSettings()" id="btn-settings" class="w-full py-3 px-4 rounded-xl hover:bg-[var(--bg-tertiary)] flex items-center gap-3 transition-colors active:scale-95 border border-[var(--border)]">
                    <i class="fas fa-cog text-[var(--text-secondary)]"></i>
                    <span class="text-sm">Settings</span>
                </button>
                <button onclick="openDocs()" id="btn-docs" class="w-full py-3 px-4 rounded-xl hover:bg-[var(--bg-tertiary)] flex items-center gap-3 transition-colors active:scale-95 border border-[var(--border)] mt-2">
                    <i class="fas fa-book text-[var(--text-secondary)]"></i>
                    <span class="text-sm">DOCS</span>
                </button>
            </div>
        </aside>

        <main class="flex-1 flex flex-col h-full min-w-0">
            <header class="h-14 border-b border-[var(--border)] flex items-center justify-between px-4 bg-[var(--bg-secondary)]">
                <div class="flex items-center gap-3">
                    <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors active:scale-95">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="flex items-center gap-2">
                        <i class="fas fa-robot text-[var(--accent)]"></i>
                        <span class="font-semibold text-sm">SahuAI Agent v4.5</span>
                    </div>
                </div>
                
                <div class="flex items-center gap-3">
                     <!-- Real-time Metrics -->
                    <div id="liveMetrics" class="hidden md:flex items-center gap-2 text-[10px] text-[var(--text-secondary)] bg-[var(--bg-tertiary)] px-2 py-1 rounded-lg border border-[var(--border)]">
                        <span><i class="fas fa-clock"></i> <span id="metricTime">0s</span></span>
                        <span class="border-l border-[var(--border)] pl-2"><i class="fas fa-bolt"></i> <span id="metricSpeed">0 t/s</span></span>
                        <span class="border-l border-[var(--border)] pl-2"><i class="fas fa-coins"></i> <span id="metricTotal">0 tok</span></span>
                    </div>

                     <!-- Token Counter -->
                    <div id="tokenCounter" class="token-counter" title="Session Tokens">
                        <i class="fas fa-coins text-yellow-500"></i> <span id="totalTokensVal">0</span>
                    </div>

                    <!-- Mode Selector -->
                    <select id="modeSelector" class="bg-[var(--bg-tertiary)] text-xs rounded-lg p-1.5 border border-[var(--border)] outline-none font-medium" onchange="updateMode(this.value)" __gchrome_uniqueid="2">
                        <option value="standard"> Standard</option>
                        <option value="task"> Task / Code</option>
                        <option value="research"> Research</option>
                        <option value="search"> SahuAI Search</option>
                    </select>

                    <button onclick="generateShareLink()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors text-[var(--accent)]" title="Share Conversation">
                        <i class="fas fa-share-alt"></i>
                    </button>

                    <div id="connectionStatus" class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-[var(--bg-tertiary)]">
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        <span class="text-xs">Ready</span>
                    </div>
                </div>
            </header>

            <div id="chatArea" class="flex-1 overflow-y-auto scrollbar-thin p-4">
                <!-- WELCOME SCREEN -->
                <div id="welcomeScreen" class="h-full flex flex-col items-center justify-center px-4">
                    <!-- SahuAI Search Header (Only visible in search mode) -->
                    <div id="sahuSearchHeader" class="sahu-search-header shine-text">SahuAI Search</div>

                    <div id="defaultWelcomeContent">
                        <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-[#667eea] to-[#764ba2] flex items-center justify-center mb-6 shadow-xl mx-auto">
                            <i class="fas fa-robot text-2xl text-white"></i>
                        </div>
                        <h2 class="text-xl font-bold mb-2 gradient-text text-center">SahuAI Agent v4.5</h2>
                        <p class="text-[var(--text-secondary)] mb-4 text-center text-sm max-w-md mx-auto">
                            Official Saksham Intelligence AI Models Chat
                        </p>
                        <div class="flex flex-wrap justify-center gap-2 mb-6">
                            <!-- Provider Badges -->
                            <span class="provider-badge provider-nvidia">Saksham Intelligence</span>
                            <span class="provider-badge provider-sambanova">SambaNova</span>
                            <span class="provider-badge provider-huggingface">HuggingFace</span>
                            <span class="provider-badge provider-openrouter">OpenRouter</span>
                            <span class="provider-badge provider-groq">Groq</span>
                            <span class="provider-badge provider-together">Together</span>
                            <span class="provider-badge provider-cerebras">Cerebras</span>
                            <span class="provider-badge provider-fireworks">Fireworks</span>
                            <span class="provider-badge provider-routeway">Routeway</span>
                            <span class="provider-badge provider-mistral">Mistral</span>
                            <span class="provider-badge provider-gemini">Gemini</span>
                            <span class="provider-badge provider-longcat">LongCat</span>
                            <span class="provider-badge provider-ollama">Ollama Cloud</span>
                            <span class="provider-badge provider-zenmusk">ZenMusk</span>
                            <span class="provider-badge provider-ionet">io.net</span>
                        </div>
                        <div class="grid grid-cols-1 gap-3 w-full max-w-md mx-auto">
                            <button onclick="quickPrompt('Build a modern landing page with hero section')" class="p-4 rounded-xl bg-[var(--bg-tertiary)] hover:bg-[var(--border)] text-left transition-all active:scale-98">
                                <i class="fas fa-code text-[#667eea] mb-2"></i>
                                <p class="text-sm font-medium">Task: Landing Page</p>
                                <p class="text-xs text-[var(--text-secondary)]">Generates Vibe Code &amp; Agentic Code</p>
                            </button>
                            <button onclick="quickPrompt('Research the latest breakthroughs in Fusion Energy')" class="p-4 rounded-xl bg-[var(--bg-tertiary)] hover:bg-[var(--border)] text-left transition-all active:scale-98">
                                <i class="fas fa-brain text-yellow-500 mb-2"></i>
                                <p class="text-sm font-medium">Research</p>
                                <p class="text-xs text-[var(--text-secondary)]">Multi-step autonomous investigation</p>
                            </button>
                        </div>
                    </div>

                    <!-- SEARCH DISCOVERY FEED -->
                    <div id="discoveryFeed" class="discovery-grid w-full max-w-4xl">
                        <!-- Content populated via JS -->
                    </div>
                </div>

                <div id="messagesContainer" class="hidden space-y-4 max-w-4xl mx-auto"></div>
            </div>

            <div class="p-3 border-t border-[var(--border)] bg-[var(--bg-secondary)] safe-area-bottom">
                <div class="max-w-3xl mx-auto">
                    <div id="fileUploadPreview" class="hidden mb-3"></div>
                    
                    <!-- Tools Menu Popover -->
                    <div id="toolsMenu" class="hidden absolute bottom-20 left-4 bg-[var(--bg-secondary)] border border-[var(--border)] rounded-xl shadow-xl p-3 w-64 z-50">
                        <div class="text-xs font-bold text-[var(--text-secondary)] mb-2 uppercase tracking-wider">Tools &amp; Config</div>
                        <div class="space-y-2">
                            <label class="flex items-center justify-between p-2 hover:bg-[var(--bg-tertiary)] rounded-lg cursor-pointer">
                                <span class="text-sm flex items-center gap-2"><i class="fas fa-brain text-purple-500"></i> DeepThink</span>
                                <div class="relative inline-block w-8 h-4 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="toolDeepThink" class="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 appearance-none cursor-pointer" onclick="toggleDeepThinkFromMenu(this.checked)" __gchrome_uniqueid="3">
                                    <label for="toolDeepThink" class="toggle-label block overflow-hidden h-4 rounded-full bg-gray-300 cursor-pointer"></label>
                                </div>
                            </label>
                            <label class="flex items-center justify-between p-2 hover:bg-[var(--bg-tertiary)] rounded-lg cursor-pointer">
                                <span class="text-sm flex items-center gap-2"><i class="fas fa-globe text-blue-500"></i> Web Search</span>
                                <div class="relative inline-block w-8 h-4 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="toolWebSearch" class="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 appearance-none cursor-pointer" onclick="toggleWebSearchFromMenu(this.checked)" __gchrome_uniqueid="4">
                                    <label for="toolWebSearch" class="toggle-label block overflow-hidden h-4 rounded-full bg-gray-300 cursor-pointer"></label>
                                </div>
                            </label>
                            <button onclick="triggerFileUpload()" class="w-full text-left p-2 hover:bg-[var(--bg-tertiary)] rounded-lg text-sm flex items-center gap-2">
                                <i class="fas fa-paperclip text-gray-500"></i> Attach File
                            </button>
                            <button onclick="startVoiceInput()" class="w-full text-left p-2 hover:bg-[var(--bg-tertiary)] rounded-lg text-sm flex items-center gap-2">
                                <i class="fas fa-microphone text-red-500"></i> Voice Input
                            </button>
                        </div>
                    </div>

                    <div class="input-area rounded-2xl border p-2 shadow-sm relative">
                        <div class="flex items-end gap-3">
                            <button onclick="toggleToolsMenu()" id="toolsBtn" class="p-2 rounded-xl hover:bg-[var(--bg-tertiary)] text-[var(--text-secondary)] transition-colors active:scale-95" title="Tools">
                                <i class="fas fa-th text-lg text-[var(--accent)]"></i>
                            </button>
                            
                             <!-- TASK TYPE BUTTON (New) -->
                             <button onclick="toggleTaskType()" id="taskTypeBtn" class="hidden p-2 rounded-xl task-btn-vibe transition-all active:scale-95 font-bold text-xs flex items-center gap-1" title="Toggle Code Mode">
                                <i class="fas fa-laptop-code"></i> <span id="taskTypeLabel">VIBE</span>
                            </button>
                            <input type="file" id="fileInput" class="hidden" accept=".txt,.pdf,.doc,.docx,.md,.json,.csv,.js,.py,.html,.css,.png,.jpg,.jpeg" onchange="handleFileUpload(event)">
                            <textarea id="userInput" placeholder="Ask anything..." class="flex-1 bg-transparent resize-none outline-none text-base leading-relaxed py-2" style="min-height: 44px; max-height: 120px;" rows="1" onkeydown="handleKeyDown(event)" oninput="autoResize(this)" __gchrome_uniqueid="5"></textarea>
                            <button onclick="sendMessage()" id="sendBtn" class="p-3 rounded-xl bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white transition-all disabled:opacity-50 active:scale-95 shadow-lg">
                                <i class="fas fa-arrow-up"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-xs text-center text-[var(--text-secondary)] mt-2">
                        Parallel Execution  Default Web Search  Deep Research
                    </p>
                </div>
            </div>
        </main>
    </div>

    <!-- DOCS MODAL -->
    <div id="docsModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-[var(--bg-secondary)] rounded-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden shadow-2xl flex flex-col transition-all">
            <div class="flex items-center justify-between p-4 border-b border-[var(--border)]">
                <h2 class="text-lg font-bold flex items-center gap-2">
                    <i class="fas fa-book text-[var(--accent)]"></i>
                    Documentation
                </h2>
                <button onclick="closeDocs()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto flex-1 space-y-6 text-sm">
                <!-- How It Works -->
                <section>
                    <h3 class="text-lg font-bold mb-3 gradient-text">How SahuAI Works</h3>
                    <p class="mb-2">SahuAI Agent provides <strong>truly unlimited access</strong> to Saksham Intelligence free models without requiring an API key. It aggregates multiple top-tier AI models into a single interface.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
                        <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)]">
                            <div class="font-bold mb-1 text-[var(--accent)]">Core Features</div>
                            <ul class="list-disc pl-4 space-y-1 text-xs text-[var(--text-secondary)]">
                                <li><strong>DeepThink:</strong> Advanced reasoning chains (Fast, Balanced, Ultra)</li>
                                <li><strong>Neural Consensus:</strong> Multi-model voting &amp; confidence scores</li>
                                <li><strong>Deep Research:</strong> Autonomous multi-stage investigation</li>
                                <li><strong>Debate Mode:</strong> Pro/Con/Neutral multi-perspective analysis</li>
                                <li><strong>Temporal Reasoning:</strong> Timeline extraction &amp; freshness checks</li>
                            </ul>
                        </div>
                        <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)]">
                            <div class="font-bold mb-1 text-blue-500">Built-in Tools</div>
                            <ul class="list-disc pl-4 space-y-1 text-xs text-[var(--text-secondary)]">
                                <li><strong>Web Search:</strong> Real-time internet access with citations</li>
                                <li><strong>File Analysis:</strong> Process PDF, DOCX, CSV, Code files</li>
                                <li><strong>Voice Input:</strong> Speech-to-text integration</li>
                                <li><strong>Code Artifacts:</strong> Live HTML/JS preview &amp; execution</li>
                            </ul>
                        </div>
                    </div>

                    <h4 class="font-bold mb-2 mt-4">Model Comparison</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse">
                            <thead>
                                <tr class="bg-[var(--bg-tertiary)] text-left">
                                    <th class="p-2 border border-[var(--border)]">Proprietary</th>
                                    <th class="p-2 border border-[var(--border)]">Open Source</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td class="p-2 border border-[var(--border)]">Gemini (Google)</td><td class="p-2 border border-[var(--border)]">ChatGLM</td></tr>
                                <tr><td class="p-2 border border-[var(--border)]">ChatGPT (OpenAI)</td><td class="p-2 border border-[var(--border)]">Qwen</td></tr>
                                <tr><td class="p-2 border border-[var(--border)]">Perplexity</td><td class="p-2 border border-[var(--border)]">DeepSeek</td></tr>
                                <tr><td class="p-2 border border-[var(--border)]">Claude (Anthropic)</td><td class="p-2 border border-[var(--border)]">Mistral</td></tr>
                                <tr><td class="p-2 border border-[var(--border)]">Ernie (Baidu)</td><td class="p-2 border border-[var(--border)]">MiniMax</td></tr>
                                <tr><td class="p-2 border border-[var(--border)]">Grok (xAI)</td><td class="p-2 border border-[var(--border)]">Kimi</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <hr class="border-[var(--border)]">

                <!-- Privacy Policy -->
                <section>
                    <h3 class="text-lg font-bold mb-3 text-purple-600">Privacy Policy</h3>
                    <p><strong>SahuAI Agent</strong> does not collect or store any personal information. All user data and API keys remain on your device and are never sent to our servers.</p>
                    <div class="space-y-2 mt-2">
                        <p><strong>1. API Keys:</strong> Users can connect external AI services (e.g., Google, OpenAI) using their own official API keys. These keys are handled securely on the client side and are never stored or transmitted elsewhere.</p>
                        <p><strong>2. Permissions:</strong> The app only requires Internet access to communicate with the selected AI APIs.</p>
                        <p><strong>3. Data Security:</strong> No user data is collected, logged, or shared by Saksham Intelligence.</p>
                        <p><strong>4. Age Requirement:</strong> This app is suitable for users aged 11 and above.</p>
                    </div>
                </section>

                <hr class="border-[var(--border)]">

                <!-- Terms -->
                <section>
                    <h3 class="text-lg font-bold mb-3 text-purple-600">Terms &amp; Conditions</h3>
                    <ul class="list-decimal pl-4 space-y-2">
                        <li><strong>Use of the App:</strong> Saksham AI Studio allows users to access external AI services using their own official API keys. Users are responsible for compliance with the terms of the respective API providers.</li>
                        <li><strong>Data and Security:</strong> We do not collect or store your data. All processing occurs locally on your device.</li>
                        <li><strong>Permissions:</strong> Internet access is required solely for API requests.</li>
                        <li><strong>Liability:</strong> We are not liable for any misuse, data loss, or errors caused by third-party API usage.</li>
                    </ul>
                    <p class="mt-4 text-xs text-[var(--text-secondary)]">Contact: <a href="mailto:sahusaksham453675@gmail.com" class="text-blue-500">sahusaksham453675@gmail.com</a></p>
                    <p class="text-xs text-[var(--text-secondary)]"> 2025 Saksham Intelligence</p>
                </section>
            </div>
        </div>
    </div>

    <!-- Canvas / Artifact Modal -->
    <div id="artifactModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="canvas-container w-full max-w-6xl">
            <div class="canvas-header">
                <div class="flex items-center gap-3">
                    <i class="fas fa-code text-[var(--accent)]"></i>
                    <span class="font-bold text-sm">Artifact Preview</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="canvas-tabs">
                        <div class="canvas-tab" id="tab-code" onclick="switchCanvasTab('code')">Code</div>
                        <div class="canvas-tab active" id="tab-preview" onclick="switchCanvasTab('preview')">Preview</div>
                    </div>
                    <button onclick="closeArtifact()" class="p-2 hover:bg-[var(--border)] rounded-lg transition-colors"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div class="canvas-body">
                <div id="canvas-editor" class="canvas-editor">
                    <textarea id="canvas-code-area" spellcheck="false" __gchrome_uniqueid="6"></textarea>
                </div>
                <div id="canvas-preview" class="canvas-preview active">
                    <iframe id="canvas-frame" class="preview-frame" sandbox="allow-scripts allow-forms allow-same-origin allow-modals" __gchrome_childframeremotetoken="0c45effd7dd323f14d9e72571700731e"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settingsModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-[var(--bg-secondary)] rounded-2xl w-full max-w-lg max-h-[85vh] overflow-hidden shadow-2xl flex flex-col transition-all">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b border-[var(--border)]">
                <h2 class="text-lg font-bold flex items-center gap-2" id="settingsTitle">Appearance</h2>
                <div class="flex gap-2">
                    <button onclick="navigateSettings('main')" id="settingsBackBtn" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors text-sm">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button onclick="closeSettings()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-4 space-y-4 overflow-y-auto flex-1 relative">
                <!-- MAIN MENU -->
                <div id="settings-main" class="settings-view space-y-3">
                    <button onclick="navigateSettings('consensus')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center"><i class="fas fa-star"></i></div>
                            <div>
                                <div class="font-medium text-sm">Specific Features</div>
                                <div class="text-xs text-[var(--text-secondary)]">Enable/Disable Advanced Capabilities</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                     <button onclick="navigateSettings('appearance')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center"><i class="fas fa-paint-brush"></i></div>
                            <div>
                                <div class="font-medium text-sm">Appearance &amp; Language</div>
                                <div class="text-xs text-[var(--text-secondary)]">Theme, Language, UI</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                    <button onclick="navigateSettings('search')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center"><i class="fas fa-search"></i></div>
                            <div>
                                <div class="font-medium text-sm">Search Engines</div>
                                <div class="text-xs text-[var(--text-secondary)]">Sources &amp; Fallback</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                    <button onclick="navigateSettings('pipeline')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center"><i class="fas fa-sliders-h"></i></div>
                            <div>
                                <div class="font-medium text-sm">Pipeline Strategy</div>
                                <div class="text-xs text-[var(--text-secondary)]">Consensus, Fallback, Safety</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                    <button onclick="navigateSettings('research')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-teal-100 text-teal-600 flex items-center justify-center"><i class="fas fa-flask"></i></div>
                            <div>
                                <div class="font-medium text-sm">Research Configuration</div>
                                <div class="text-xs text-[var(--text-secondary)]">Stages, Models &amp; Budgets</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                    <button onclick="navigateSettings('providers')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                         <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center"><i class="fas fa-network-wired"></i></div>
                            <div>
                                <div class="font-medium text-sm">Active Providers</div>
                                <div class="text-xs text-[var(--text-secondary)]">Toggle AI Services</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                    <button onclick="navigateSettings('keys')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center"><i class="fas fa-key"></i></div>
                            <div>
                                <div class="font-medium text-sm">API Keys</div>
                                <div class="text-xs text-[var(--text-secondary)]">Manage your credentials</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                     <button onclick="navigateSettings('instructions')" class="w-full py-4 px-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between hover:bg-[var(--border)] transition-colors text-left">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center"><i class="fas fa-user-edit"></i></div>
                            <div>
                                <div class="font-medium text-sm">Custom Instructions</div>
                                <div class="text-xs text-[var(--text-secondary)]">System prompts &amp; Persona</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-[var(--text-secondary)]"></i>
                    </button>
                </div>
                <!-- SUB MENUS -->
                <div id="settings-consensus" class="settings-view space-y-4">
                    <div class="space-y-4">
                         <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-brain text-orange-500"></i> Neural Consensus</span>
                            <input type="checkbox" id="neuralConsensusCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="7">
                        </label>
                        
                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-balance-scale text-purple-500"></i> Debate Mode</span>
                            <input type="checkbox" id="debateModeCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="8">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-history text-blue-500"></i> Temporal Reasoning</span>
                            <input type="checkbox" id="temporalReasoningCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="9">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-lightbulb text-yellow-500"></i> Adaptive Reasoning</span>
                            <input type="checkbox" id="adaptiveReasoningCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="10">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-shield-alt text-green-500"></i> Uncertainty Badge</span>
                            <input type="checkbox" id="uncertaintyBadgeCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="11">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-chart-line text-blue-500"></i> Token Estimator</span>
                            <input type="checkbox" id="tokenEstimatorCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="12">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-thumbs-up text-pink-500"></i> Response Rating</span>
                            <input type="checkbox" id="responseRatingCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="13">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-memory text-indigo-500"></i> Three-Tier Memory</span>
                            <input type="checkbox" id="threeTierMemoryCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="14">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-bug text-red-500"></i> Self-Correcting Code</span>
                            <input type="checkbox" id="selfCorrectingCodeCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="15">
                        </label>
                        
                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-chart-pie text-teal-500"></i> Usage Analytics</span>
                            <input type="checkbox" id="usageAnalyticsCheck" class="w-5 h-5 accent-[var(--accent)]" checked="" __gchrome_uniqueid="16">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-users text-cyan-500"></i> Agent Swarm</span>
                            <input type="checkbox" id="agentSwarmCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="17">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-eye text-purple-500"></i> Vision-to-Code</span>
                            <input type="checkbox" id="visionToCodeCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="18">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-palette text-pink-500"></i> Collaborative Canvas</span>
                            <input type="checkbox" id="collaborativeCanvasCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="19">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-video text-red-500"></i> Video Generation</span>
                            <input type="checkbox" id="videoGenerationCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="20">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-bolt text-yellow-500"></i> Rapid Learning</span>
                            <input type="checkbox" id="rapidLearningCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="21">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-globe text-blue-500"></i> Browser Agent</span>
                            <input type="checkbox" id="browserAgentCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="22">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-microphone-alt text-green-500"></i> Voice Cloning</span>
                            <input type="checkbox" id="voiceCloningCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="23">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-database text-orange-500"></i> 2M Token Context</span>
                            <input type="checkbox" id="tokenContextCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="24">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-gem text-purple-500"></i> Gems Marketplace</span>
                            <input type="checkbox" id="gemsMarketplaceCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="25">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-robot text-gray-500"></i> Physical Integration</span>
                            <input type="checkbox" id="physicalIntegrationCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="26">
                        </label>

                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-balance-scale text-teal-500"></i> Constitutional Safety</span>
                            <input type="checkbox" id="constitutionalSafetyCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="27">
                        </label>

                        <p class="text-xs text-[var(--text-secondary)] mt-2">
                            Enable specific features to enhance the AI's capabilities. Debate Mode will force models to argue different viewpoints in Standard and Research modes.
                        </p>
                    </div>
                </div>
                <div id="settings-appearance" class="settings-view space-y-3 active">
                    <div class="p-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)]">
                        <label class="block text-sm font-medium mb-2">Interface &amp; Response Language</label>
                        <select id="languageSelector" class="w-full p-2.5 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border)] text-sm outline-none" onchange="updateLanguage(this.value)" __gchrome_uniqueid="28"><option value="en" selected="">English</option><option value="es">Spanish</option><option value="fr">French</option><option value="de">German</option><option value="it">Italian</option><option value="pt">Portuguese</option><option value="zh">Chinese</option><option value="ja">Japanese</option><option value="ko">Korean</option><option value="ru">Russian</option><option value="hi">Hindi</option><option value="ar">Arabic</option><option value="bn">Bengali</option><option value="pa">Punjabi</option><option value="jv">Javanese</option><option value="vi">Vietnamese</option><option value="te">Telugu</option><option value="mr">Marathi</option><option value="ta">Tamil</option><option value="ur">Urdu</option><option value="tr">Turkish</option><option value="fa">Persian</option><option value="gu">Gujarati</option><option value="pl">Polish</option><option value="uk">Ukrainian</option><option value="ro">Romanian</option><option value="nl">Dutch</option><option value="el">Greek</option><option value="hu">Hungarian</option><option value="sv">Swedish</option><option value="cs">Czech</option><option value="th">Thai</option><option value="id">Indonesian</option><option value="ms">Malay</option><option value="da">Danish</option><option value="fi">Finnish</option><option value="no">Norwegian</option><option value="he">Hebrew</option><option value="bg">Bulgarian</option><option value="hr">Croatian</option><option value="sr">Serbian</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option value="et">Estonian</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="af">Afrikaans</option><option value="sw">Swahili</option><option value="ca">Catalan</option><option value="eu">Basque</option><option value="gl">Galician</option><option value="is">Icelandic</option><option value="ga">Irish</option><option value="sq">Albanian</option><option value="mk">Macedonian</option><option value="bs">Bosnian</option><option value="cy">Welsh</option><option value="hy">Armenian</option><option value="ka">Georgian</option><option value="be">Belarusian</option><option value="az">Azerbaijani</option><option value="kk">Kazakh</option><option value="ky">Kyrgyz</option><option value="uz">Uzbek</option><option value="tk">Turkmen</option><option value="tg">Tajik</option><option value="mn">Mongolian</option><option value="ne">Nepali</option><option value="si">Sinhala</option><option value="my">Burmese</option><option value="km">Khmer</option><option value="lo">Lao</option><option value="am">Amharic</option><option value="so">Somali</option><option value="yo">Yoruba</option><option value="ig">Igbo</option><option value="ha">Hausa</option><option value="zu">Zulu</option><option value="xh">Xhosa</option><option value="st">Sotho</option><option value="fil">Filipino</option><option value="mg">Malagasy</option><option value="ny">Chichewa</option><option value="sn">Shona</option><option value="co">Corsican</option><option value="fy">Frisian</option><option value="gd">Scots Gaelic</option><option value="ht">Haitian Creole</option><option value="haw">Hawaiian</option><option value="hmn">Hmong</option><option value="jw">Javanese</option><option value="kn">Kannada</option><option value="ku">Kurdish</option><option value="lb">Luxembourgish</option><option value="mi">Maori</option><option value="ml">Malayalam</option><option value="mt">Maltese</option><option value="ps">Pashto</option><option value="sd">Sindhi</option><option value="sm">Samoan</option><option value="su">Sundanese</option><option value="yi">Yiddish</option></select>
                        <p class="text-xs text-[var(--text-secondary)] mt-1">Changes UI text and instructs models to respond in this language.</p>
                    </div>
                    <button onclick="toggleTheme()" class="w-full p-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between">
                         <span class="flex items-center gap-2"><i id="themeIcon" class="fas fa-moon"></i> Toggle Dark Mode</span>
                         <span id="themeText" class="text-xs bg-[var(--bg-secondary)] px-2 py-1 rounded">Light</span>
                    </button>
                    <button onclick="openSourceCode()" class="w-full p-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] flex items-center justify-between">
                         <span class="flex items-center gap-2"><i class="fas fa-code"></i> View Source Code</span>
                    </button>
                </div>
                <div id="settings-search" class="settings-view space-y-3">
                    <div class="flex items-center justify-between mb-2">
                        <p class="text-xs text-[var(--text-secondary)]">Enable independent search sources.</p>
                        <button onclick="toggleAllSearchEngines()" class="text-xs bg-[var(--accent)] text-white px-2 py-1 rounded">Select All</button>
                    </div>
                    <div id="searchEngineList" class="grid grid-cols-1 gap-2 max-h-60 overflow-y-auto">
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('wikipedia', this.checked)">
                    <div class="flex-1 text-sm font-medium">Wikipedia <span class="text-[10px] text-[var(--text-secondary)]">(API)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('reddit', this.checked)">
                    <div class="flex-1 text-sm font-medium">Reddit <span class="text-[10px] text-[var(--text-secondary)]">(API)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('google', this.checked)">
                    <div class="flex-1 text-sm font-medium">Google <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('bing', this.checked)">
                    <div class="flex-1 text-sm font-medium">Bing <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('duckduckgo', this.checked)">
                    <div class="flex-1 text-sm font-medium">DuckDuckGo <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('yahoo', this.checked)">
                    <div class="flex-1 text-sm font-medium">Yahoo <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('yandex', this.checked)">
                    <div class="flex-1 text-sm font-medium">Yandex <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('qwant', this.checked)">
                    <div class="flex-1 text-sm font-medium">Qwant <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('brave', this.checked)">
                    <div class="flex-1 text-sm font-medium">Brave <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('startpage', this.checked)">
                    <div class="flex-1 text-sm font-medium">Startpage <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('baidu', this.checked)">
                    <div class="flex-1 text-sm font-medium">Baidu (English) <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('youtube', this.checked)">
                    <div class="flex-1 text-sm font-medium">YouTube <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('twitter', this.checked)">
                    <div class="flex-1 text-sm font-medium">X (Twitter) <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('ncert', this.checked)">
                    <div class="flex-1 text-sm font-medium">NCERT <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('diksha', this.checked)">
                    <div class="flex-1 text-sm font-medium">DIKSHA <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('cbse', this.checked)">
                    <div class="flex-1 text-sm font-medium">CBSE Academic <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('epathshala', this.checked)">
                    <div class="flex-1 text-sm font-medium">ePathshala <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('vedantu', this.checked)">
                    <div class="flex-1 text-sm font-medium">Vedantu <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('magnetbrains', this.checked)">
                    <div class="flex-1 text-sm font-medium">Magnet Brains <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('byjus', this.checked)">
                    <div class="flex-1 text-sm font-medium">Byjus <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('unacademy', this.checked)">
                    <div class="flex-1 text-sm font-medium">Unacademy <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('mpboard', this.checked)">
                    <div class="flex-1 text-sm font-medium">MP Board Solutions <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('sahuacademy', this.checked)">
                    <div class="flex-1 text-sm font-medium">Sahu Academy <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('copilot', this.checked)">
                    <div class="flex-1 text-sm font-medium">Microsoft Copilot <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('chatgpt', this.checked)">
                    <div class="flex-1 text-sm font-medium">ChatGPT <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('chatglm', this.checked)">
                    <div class="flex-1 text-sm font-medium">ChatGLM <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('gemini', this.checked)">
                    <div class="flex-1 text-sm font-medium">Gemini <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('deepseek', this.checked)">
                    <div class="flex-1 text-sm font-medium">DeepSeek <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('qwen', this.checked)">
                    <div class="flex-1 text-sm font-medium">Qwen <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('kimi', this.checked)">
                    <div class="flex-1 text-sm font-medium">Kimi <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('mistral', this.checked)">
                    <div class="flex-1 text-sm font-medium">Mistral <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('grok', this.checked)">
                    <div class="flex-1 text-sm font-medium">Grok <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('minimax', this.checked)">
                    <div class="flex-1 text-sm font-medium">MiniMax <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('ernie', this.checked)">
                    <div class="flex-1 text-sm font-medium">ERNIE <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('perplexity', this.checked)">
                    <div class="flex-1 text-sm font-medium">Perplexity <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('discord', this.checked)">
                    <div class="flex-1 text-sm font-medium">Discord <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('claude', this.checked)">
                    <div class="flex-1 text-sm font-medium">Claude <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('facebook', this.checked)">
                    <div class="flex-1 text-sm font-medium">Facebook <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('instagram', this.checked)">
                    <div class="flex-1 text-sm font-medium">Instagram <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('github', this.checked)">
                    <div class="flex-1 text-sm font-medium">GitHub <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('googlenews', this.checked)">
                    <div class="flex-1 text-sm font-medium">Google News <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('linkedin', this.checked)">
                    <div class="flex-1 text-sm font-medium">LinkedIn <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleSearchEngine('grokipedia', this.checked)">
                    <div class="flex-1 text-sm font-medium">Grokipedia <span class="text-[10px] text-[var(--text-secondary)]">(SearXNG)</span></div>
                </label>
            </div>
                </div>
                <div id="settings-pipeline" class="settings-view space-y-4">
                     <div>
                        <label class="text-xs text-[var(--text-secondary)] block mb-1">Consensus Strategy</label>
                        <select id="stageSelector" class="w-full p-3 rounded-xl bg-[var(--bg-tertiary)] text-sm border border-[var(--border)] outline-none" __gchrome_uniqueid="29">
                            <option value="none">Experts Only (Parallel)</option>
                            <option value="1" selected="">Direct Synthesis (Fast)</option>
                            <option value="2">Deep Synthesis (2-Step)</option>
                            <option value="3">Full Chain (3-Step)</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                         <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-shield-alt text-green-500"></i> Auto Fallback</span>
                            <input type="checkbox" id="autoFallback" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="30">
                        </label>
                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-user-shield text-blue-500"></i> Shield Gemma</span>
                            <input type="checkbox" id="shieldGemmaCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="31">
                        </label>
                        <label class="flex items-center justify-between p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer">
                            <span class="text-sm flex items-center gap-2"><i class="fas fa-vote-yea text-purple-500"></i> Self-Consistency</span>
                            <input type="checkbox" id="selfConsistencyCheck" class="w-5 h-5 accent-[var(--accent)]" __gchrome_uniqueid="32">
                        </label>
                    </div>
                </div>
                <div id="settings-research" class="settings-view space-y-4">
                    <div class="p-3 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)]">
                        <label class="text-sm font-medium flex items-center gap-2 mb-2"><i class="fas fa-brain text-pink-500"></i> Thinking Budget</label>
                        <select id="thinkingBudget" class="w-full p-2 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border)] text-xs outline-none" __gchrome_uniqueid="33">
                            <option value="original">Original (Model Native)</option>
                            <option value="fast">Fast (Original + Medium)</option>
                            <option value="balanced" selected="">Balanced (Original + High)</option>
                            <option value="ultra">Ultra (Original + X-High)</option>
                        </select>
                    </div>
                    <div class="p-3 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)]">
                        <label class="text-sm font-medium flex items-center gap-2 mb-2"><i class="fas fa-tasks text-blue-500"></i> Aggregation Style</label>
                        <select id="aggregationStyle" class="w-full p-2 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border)] text-xs outline-none" __gchrome_uniqueid="34">
                            <option value="synthesis" selected="">Synthesis (Best Logic)</option>
                            <option value="majority">Majority Vote</option>
                            <option value="weighted">Weighted Consensus</option>
                            <option value="critical">Critical Review</option>
                        </select>
                    </div>
                    <div id="researchStagesConfig" class="space-y-3">
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">Stage 1: Problem Decomposition</div>
                    <div class="grid grid-cols-1 gap-1">
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Strategic Planner</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage1_0" onchange="updateResearchStageConfig('stage1_0', this.value)" __gchrome_uniqueid="106">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct" selected="">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Assumption Detector</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage1_1" onchange="updateResearchStageConfig('stage1_1', this.value)" __gchrome_uniqueid="107">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct" selected="">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Multimodal Context</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage1_2" onchange="updateResearchStageConfig('stage1_2', this.value)" __gchrome_uniqueid="108">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct" selected="">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Sub-question Generator</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage1_3" onchange="updateResearchStageConfig('stage1_3', this.value)" __gchrome_uniqueid="109">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it" selected="">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Risk Identification</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage1_4" onchange="updateResearchStageConfig('stage1_4', this.value)" __gchrome_uniqueid="110">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b" selected="">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                    </div>
                </div>
                
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">Stage 2: Multi-Perspective Analysis</div>
                    <div class="grid grid-cols-1 gap-1">
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Analytical</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage2_0" onchange="updateResearchStageConfig('stage2_0', this.value)" __gchrome_uniqueid="111">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b" selected="">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Creative</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage2_1" onchange="updateResearchStageConfig('stage2_1', this.value)" __gchrome_uniqueid="112">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1" selected="">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Skeptical</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage2_2" onchange="updateResearchStageConfig('stage2_2', this.value)" __gchrome_uniqueid="113">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b" selected="">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Data-logic</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage2_3" onchange="updateResearchStageConfig('stage2_3', this.value)" __gchrome_uniqueid="114">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5" selected="">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Cross-domain</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage2_4" onchange="updateResearchStageConfig('stage2_4', this.value)" __gchrome_uniqueid="115">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking" selected="">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                    </div>
                </div>
                
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">Stage 3: Stress Testing</div>
                    <div class="grid grid-cols-1 gap-1">
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Logical Flaw</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage3_0" onchange="updateResearchStageConfig('stage3_0', this.value)" __gchrome_uniqueid="116">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b" selected="">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Counter Argument</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage3_1" onchange="updateResearchStageConfig('stage3_1', this.value)" __gchrome_uniqueid="117">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking" selected="">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Edge Case</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage3_2" onchange="updateResearchStageConfig('stage3_2', this.value)" __gchrome_uniqueid="118">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning" selected="">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Failure Mode</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage3_3" onchange="updateResearchStageConfig('stage3_3', this.value)" __gchrome_uniqueid="119">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512" selected="">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Consistency</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage3_4" onchange="updateResearchStageConfig('stage3_4', this.value)" __gchrome_uniqueid="120">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512" selected="">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                    </div>
                </div>
                
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">Stage 4: Synthesis</div>
                    <div class="grid grid-cols-1 gap-1">
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Deep Synthesizer</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage4_0" onchange="updateResearchStageConfig('stage4_0', this.value)" __gchrome_uniqueid="121">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5" selected="">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Structural Optimizer</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage4_1" onchange="updateResearchStageConfig('stage4_1', this.value)" __gchrome_uniqueid="122">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5" selected="">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Depth Preserver</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage4_2" onchange="updateResearchStageConfig('stage4_2', this.value)" __gchrome_uniqueid="123">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2" selected="">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Readability</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage4_3" onchange="updateResearchStageConfig('stage4_3', this.value)" __gchrome_uniqueid="124">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1" selected="">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">Insight Extractor</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" id="conf_stage4_4" onchange="updateResearchStageConfig('stage4_4', this.value)" __gchrome_uniqueid="125">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct" selected="">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                        
                    </div>
                </div>
                
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">Stage 5: Final Aggregator</div>
                    <div class="grid grid-cols-1 gap-1">
                        
                        <div class="mb-2">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 font-bold">Super Master Model</label>
                            <select class="w-full p-2 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border)] text-xs outline-none" id="conf_stage5_agg" onchange="updateResearchStageConfig('stage5_agg', this.value)" __gchrome_uniqueid="126">
                                <option value="">Default (First Available)</option><option value="nvidia|qwen/qwen3.5-397b">Qwen 3.5 397B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3.5-vision-instruct">Phi 3.5 Vision (Saksham Intelligence)</option><option value="nvidia|stockmark/stockmark-2-100b-instruct">Stockmark 2 100B (Saksham Intelligence)</option><option value="nvidia|nvidia/cosmos-reason2-8b">Cosmos Reason 2 8B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-90b-vision-instruct">Llama 3.2 90B Vision (Saksham Intelligence)</option><option value="nvidia|z-ai/glm5" selected="">GLM 5 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.5">MiniMax M2.5 (Saksham Intelligence)</option><option value="nvidia|google/shieldgemma-9b">ShieldGemma 9B (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2.1">MiniMax M2.1 (Saksham Intelligence)</option><option value="nvidia|minimaxai/minimax-m2">MiniMax M2 (Saksham Intelligence)</option><option value="nvidia|z-ai/glm4.7">GLM 4.7 (Saksham Intelligence)</option><option value="nvidia|ai21labs/jamba-1.5-mini-instruct">Jamba 1.5 Mini (Saksham Intelligence)</option><option value="nvidia|bytedance/seed-oss-36b-instruct">Seed OSS 36B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.2">DeepSeek V3.2 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1">DeepSeek V3.1 (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-v3.1-terminus">DeepSeek V3.1 Terminus (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b">DeepSeek R1 Distill Qwen 32B (Saksham Intelligence)</option><option value="nvidia|deepseek-ai/deepseek-r1-distill-llama-8b">DeepSeek R1 Distill Llama 8B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3n-e4b-it">Gemma 3N E4B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-27b-it">Gemma 3 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-3-1b-it">Gemma 3 1B (Saksham Intelligence)</option><option value="nvidia|google/gemma-2-27b-it">Gemma 2 27B (Saksham Intelligence)</option><option value="nvidia|google/gemma-7b">Gemma 7B (Saksham Intelligence)</option><option value="nvidia|ibm/granite-3.3-8b-instruct">Granite 3.3 8B (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-multimodal-instruct">Phi 4 Multimodal (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-4-mini-flash-reasoning">Phi 4 Mini Reasoning (Saksham Intelligence)</option><option value="nvidia|microsoft/phi-3-medium-4k-instruct">Phi 3 Medium (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-maverick-17b-128e-instruct">Llama 4 Maverick (Saksham Intelligence)</option><option value="nvidia|meta/llama-4-scout-17b-16e-instruct">Llama 4 Scout (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.3-70b-instruct">Llama 3.3 70B (Saksham Intelligence)</option><option value="nvidia|meta/llama-3.2-3b-instruct">Llama 3.2 3B (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2.5">Kimi K2.5 (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-thinking">Kimi K2 Thinking (Saksham Intelligence)</option><option value="nvidia|moonshotai/kimi-k2-instruct">Kimi K2 Instruct (Saksham Intelligence)</option><option value="nvidia|mistralai/devstral-2-123b-instruct-2512">Devstral 2 123B (Saksham Intelligence)</option><option value="nvidia|mistralai/mistral-large-3-675b-instruct-2512">Mistral Large 3 675B (Saksham Intelligence)</option><option value="nvidia|mistralai/ministral-14b-instruct-2512">Ministral 14B (Saksham Intelligence)</option><option value="nvidia|mistralai/magistral-small-2506">Magistral Small (Saksham Intelligence)</option><option value="nvidia|mistralai/mixtral-8x22b-instruct-v0.1">Mixtral 8x22B (Saksham Intelligence)</option><option value="nvidia|mistralai/mamba-codestral-7b-v0.1">Mamba Codestral 7B (Saksham Intelligence)</option><option value="nvidia|stepfun-ai/step-3.5-flash">Step 3.5 Flash (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-120b">GPT OSS 120B (Saksham Intelligence)</option><option value="nvidia|openai/gpt-oss-20b">GPT OSS 20B (Saksham Intelligence)</option><option value="nvidia|sarvamai/sarvam-m">Sarvam M (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-instruct">Qwen3 Next 80B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-next-80b-a3b-thinking">Qwen3 Next 80B Thinking (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-coder-480b-a35b-instruct">Qwen3 Coder 480B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen3-235b-a22b">Qwen3 235B (Saksham Intelligence)</option><option value="nvidia|qwen/qwq-32b">QwQ 32B (Saksham Intelligence)</option><option value="nvidia|qwen/qwen2.5-7b-instruct">Qwen 2.5 7B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-4-mini-hindi-4b-instruct">Nemotron 4 Mini Hindi (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-3-nano-30b-a3b">Nemotron 30B (Saksham Intelligence)</option><option value="nvidia|nvidia/nemotron-nano-12b-v2-vl">Nemotron 12B VL (Saksham Intelligence)</option><option value="nvidia|nvidia/nvidia-nemotron-nano-9b-v2">Nemotron 9B (Saksham Intelligence)</option><option value="nvidia|nvidia/llama-3.3-nemotron-super-49b-v1.5">Llama 3.3 Nemotron Super 49B (Saksham Intelligence)</option><option value="nvidia|thudm/chatglm3-6b">ChatGLM3 6B (Saksham Intelligence)</option><option value="nvidia|nvidia/usdcode-llama-3.1-70b-instruct">USDCode Llama 3.1 70B (Saksham Intelligence)</option>
                            </select>
                        </div>
                    
                    </div>
                </div>
                </div>
                </div>
                <div id="settings-providers" class="settings-view">
                    <div id="providerCheckboxes" class="grid grid-cols-1 gap-2">
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent border-[var(--accent)] bg-opacity-50">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" checked="" onchange="toggleProvider('nvidia', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Saksham Intelligence</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('sambanova', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> SambaNova</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('huggingface', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> HuggingFace</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('openrouter', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> OpenRouter</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('groq', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Groq</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('together', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Together AI</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('cerebras', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Cerebras</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('fireworks', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Fireworks AI</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('routeway', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Routeway</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('mistral', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Mistral</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('gemini', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Gemini</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('longcat', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> LongCat</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('ollama', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> Ollama Cloud</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('zenmusk', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> ZenMusk</div>
                    </div>
                </label>
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" onchange="toggleProvider('ionet', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span></span> io.net</div>
                    </div>
                </label></div>
                </div>
                <div id="settings-keys" class="settings-view space-y-3">
                    <div class="p-3 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 text-xs rounded-xl">
                        <i class="fas fa-lock mr-1"></i> Keys are stored locally in your browser.
                    </div>
                    <div id="apiKeyInputs" class="space-y-3">
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Saksham Intelligence</span></div>
                    <input type="password" id="key_nvidia" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="127">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> SambaNova</span></div>
                    <input type="password" id="key_sambanova" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="128">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> HuggingFace</span></div>
                    <input type="password" id="key_huggingface" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="129">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> OpenRouter</span></div>
                    <input type="password" id="key_openrouter" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="130">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Groq</span></div>
                    <input type="password" id="key_groq" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="131">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Together AI</span></div>
                    <input type="password" id="key_together" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="132">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Cerebras</span></div>
                    <input type="password" id="key_cerebras" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="133">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Fireworks AI</span></div>
                    <input type="password" id="key_fireworks" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="134">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Routeway</span></div>
                    <input type="password" id="key_routeway" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="135">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Mistral</span></div>
                    <input type="password" id="key_mistral" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="136">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Gemini</span></div>
                    <input type="password" id="key_gemini" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="137">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> LongCat</span></div>
                    <input type="password" id="key_longcat" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="138">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> Ollama Cloud</span></div>
                    <input type="password" id="key_ollama" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="139">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> ZenMusk</span></div>
                    <input type="password" id="key_zenmusk" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="140">
                </div>
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm"> io.net</span></div>
                    <input type="password" id="key_ionet" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none" __gchrome_uniqueid="141">
                </div></div>
                </div>
                <div id="settings-instructions" class="settings-view space-y-3">
                    <div>
                        <label class="font-medium text-sm block mb-1">User Info</label>
                        <textarea id="customInstructionsUser" placeholder="What should SAHU know about you?" class="w-full p-3 text-xs rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] h-24" __gchrome_uniqueid="65"></textarea>
                    </div>
                    <div>
                        <label class="font-medium text-sm block mb-1">Response Style</label>
                        <textarea id="customInstructionsResp" placeholder="How should SAHU respond?" class="w-full p-3 text-xs rounded-xl bg-[var(--bg-tertiary)] border border-[var(--border)] h-24" __gchrome_uniqueid="66"></textarea>
                    </div>
                     <div class="grid grid-cols-2 gap-3 mt-4">
                         <div>
                             <label class="text-xs text-[var(--text-secondary)] block mb-1">Temperature</label>
                             <input type="number" id="settingTemp" step="0.1" min="0" max="2" value="0.7" class="w-full p-2 rounded-lg bg-[var(--bg-tertiary)] border border-[var(--border)] text-xs" __gchrome_uniqueid="67">
                         </div>
                         <div>
                             <label class="text-xs text-[var(--text-secondary)] block mb-1">Default Max Tokens</label>
                             <input type="number" id="settingMaxTokens" step="1000" min="1000" value="8000" class="w-full p-2 rounded-lg bg-[var(--bg-tertiary)] border border-[var(--border)] text-xs" __gchrome_uniqueid="68">
                         </div>
                     </div>
                </div>
            </div>
            <div class="p-4 border-t border-[var(--border)] flex justify-end gap-3">
                <button onclick="closeSettings()" class="px-4 py-2.5 rounded-xl hover:bg-[var(--bg-tertiary)] transition-colors text-sm">Cancel</button>
                <button onclick="saveSettings()" class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white font-medium text-sm active:scale-95">
                    <i class="fas fa-save mr-2"></i>Save All
                </button>
            </div>
        </div>
    </div>

    <!-- Source Code Modal -->
    <div id="sourceCodeModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-[var(--bg-secondary)] rounded-2xl w-full max-w-4xl max-h-[85vh] overflow-hidden shadow-2xl flex flex-col">
            <div class="flex items-center justify-between p-4 border-b border-[var(--border)]">
                <h2 class="text-lg font-bold flex items-center gap-2"><i class="fas fa-code text-[var(--accent)]"></i> App Source Code</h2>
                <button onclick="closeSourceCode()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-4 flex-1 overflow-hidden flex flex-col">
                 <div class="flex items-center justify-between mb-2">
                    <p class="text-xs text-[var(--text-secondary)]">Single file application.</p>
                    <button onclick="copySourceCode()" class="text-xs bg-[var(--accent)] text-white px-3 py-1.5 rounded-lg hover:bg-[var(--accent-hover)] transition-colors"><i class="fas fa-copy mr-1"></i> Copy All</button>
                </div>
                <textarea id="sourceCodeViewer" readonly="" class="w-full flex-1 p-3 text-xs font-mono bg-[var(--bg-tertiary)] border border-[var(--border)] rounded-xl resize-none focus:outline-none focus:border-[var(--accent)]" onclick="this.select()" __gchrome_uniqueid="69"></textarea>
            </div>
            <div class="p-4 border-t border-[var(--border)] flex justify-end">
                 <button onclick="closeSourceCode()" class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white font-medium text-sm active:scale-95">Close</button>
            </div>
        </div>
    </div>

    <!-- Model Selector Modal -->
    <div id="modelSelectorModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-[var(--bg-secondary)] rounded-2xl w-full max-w-4xl max-h-[85vh] overflow-hidden shadow-2xl flex flex-col">
            <div class="flex items-center justify-between p-4 border-b border-[var(--border)]">
                <h2 class="text-lg font-bold flex items-center gap-2"><i class="fas fa-cubes text-[var(--accent)]"></i> Model Configuration</h2>
                <button onclick="closeModelSelector()" class="p-2 rounded-lg hover:bg-[var(--bg-tertiary)] transition-colors"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-4 overflow-y-auto flex-1">
                <p class="text-sm text-[var(--text-secondary)] mb-4">Select models and assign aggregator stages (1/2/3). Use "Select All" to quickly select active provider models.</p>
                <div id="modelSelectorContent" class="space-y-4"><div class="border border-[var(--border)] rounded-xl overflow-hidden"><div class="bg-[var(--bg-tertiary)] p-3 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><span class="font-semibold text-sm">Saksham Intelligence</span><span class="text-xs text-[var(--text-secondary)]">(57)</span></div><button onclick="toggleAllModels('nvidia')" class="text-xs px-2 py-1 bg-[var(--bg-secondary)] border border-[var(--border)] rounded hover:bg-[var(--accent)] hover:text-white transition-colors">All/None</button></div><div class="p-3 grid grid-cols-1 gap-2"><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'Qwen 3.5 397B', 'qwen/qwen3.5-397b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen 3.5 397B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 3.5 397B','qwen/qwen3.5-397b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 3.5 397B','qwen/qwen3.5-397b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 3.5 397B','qwen/qwen3.5-397b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Phi 3.5 Vision', 'microsoft/phi-3.5-vision-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Phi 3.5 Vision</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3.5 Vision','microsoft/phi-3.5-vision-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3.5 Vision','microsoft/phi-3.5-vision-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3.5 Vision','microsoft/phi-3.5-vision-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Stockmark 2 100B', 'stockmark/stockmark-2-100b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Stockmark 2 100B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Stockmark 2 100B','stockmark/stockmark-2-100b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Stockmark 2 100B','stockmark/stockmark-2-100b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Stockmark 2 100B','stockmark/stockmark-2-100b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Cosmos Reason 2 8B', 'nvidia/cosmos-reason2-8b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Cosmos Reason 2 8B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Cosmos Reason 2 8B','nvidia/cosmos-reason2-8b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Cosmos Reason 2 8B','nvidia/cosmos-reason2-8b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Cosmos Reason 2 8B','nvidia/cosmos-reason2-8b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 3.2 90B Vision', 'meta/llama-3.2-90b-vision-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 3.2 90B Vision</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 90B Vision','meta/llama-3.2-90b-vision-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 90B Vision','meta/llama-3.2-90b-vision-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 90B Vision','meta/llama-3.2-90b-vision-instruct','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'GLM 5', 'z-ai/glm5', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">GLM 5</div></div><div class="flex gap-1"><button class="stage-btn active-1" onclick="setModelStage('nvidia','GLM 5','z-ai/glm5','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','GLM 5','z-ai/glm5','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','GLM 5','z-ai/glm5','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'MiniMax M2.5', 'minimaxai/minimax-m2.5', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">MiniMax M2.5</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.5','minimaxai/minimax-m2.5','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.5','minimaxai/minimax-m2.5','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.5','minimaxai/minimax-m2.5','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'ShieldGemma 9B', 'google/shieldgemma-9b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">ShieldGemma 9B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','ShieldGemma 9B','google/shieldgemma-9b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','ShieldGemma 9B','google/shieldgemma-9b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','ShieldGemma 9B','google/shieldgemma-9b','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'MiniMax M2.1', 'minimaxai/minimax-m2.1', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">MiniMax M2.1</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.1','minimaxai/minimax-m2.1','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.1','minimaxai/minimax-m2.1','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2.1','minimaxai/minimax-m2.1','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'MiniMax M2', 'minimaxai/minimax-m2', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">MiniMax M2</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2','minimaxai/minimax-m2','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2','minimaxai/minimax-m2','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','MiniMax M2','minimaxai/minimax-m2','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'GLM 4.7', 'z-ai/glm4.7', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">GLM 4.7</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','GLM 4.7','z-ai/glm4.7','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','GLM 4.7','z-ai/glm4.7','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','GLM 4.7','z-ai/glm4.7','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Jamba 1.5 Mini', 'ai21labs/jamba-1.5-mini-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Jamba 1.5 Mini</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Jamba 1.5 Mini','ai21labs/jamba-1.5-mini-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Jamba 1.5 Mini','ai21labs/jamba-1.5-mini-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Jamba 1.5 Mini','ai21labs/jamba-1.5-mini-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Seed OSS 36B', 'bytedance/seed-oss-36b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Seed OSS 36B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Seed OSS 36B','bytedance/seed-oss-36b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Seed OSS 36B','bytedance/seed-oss-36b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Seed OSS 36B','bytedance/seed-oss-36b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'DeepSeek V3.2', 'deepseek-ai/deepseek-v3.2', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">DeepSeek V3.2</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.2','deepseek-ai/deepseek-v3.2','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.2','deepseek-ai/deepseek-v3.2','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.2','deepseek-ai/deepseek-v3.2','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'DeepSeek V3.1', 'deepseek-ai/deepseek-v3.1', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">DeepSeek V3.1</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1','deepseek-ai/deepseek-v3.1','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1','deepseek-ai/deepseek-v3.1','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1','deepseek-ai/deepseek-v3.1','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'DeepSeek V3.1 Terminus', 'deepseek-ai/deepseek-v3.1-terminus', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">DeepSeek V3.1 Terminus</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1 Terminus','deepseek-ai/deepseek-v3.1-terminus','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1 Terminus','deepseek-ai/deepseek-v3.1-terminus','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek V3.1 Terminus','deepseek-ai/deepseek-v3.1-terminus','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'DeepSeek R1 Distill Qwen 32B', 'deepseek-ai/deepseek-r1-distill-qwen-32b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">DeepSeek R1 Distill Qwen 32B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Qwen 32B','deepseek-ai/deepseek-r1-distill-qwen-32b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Qwen 32B','deepseek-ai/deepseek-r1-distill-qwen-32b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Qwen 32B','deepseek-ai/deepseek-r1-distill-qwen-32b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'DeepSeek R1 Distill Llama 8B', 'deepseek-ai/deepseek-r1-distill-llama-8b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">DeepSeek R1 Distill Llama 8B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Llama 8B','deepseek-ai/deepseek-r1-distill-llama-8b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Llama 8B','deepseek-ai/deepseek-r1-distill-llama-8b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','DeepSeek R1 Distill Llama 8B','deepseek-ai/deepseek-r1-distill-llama-8b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Gemma 3N E4B', 'google/gemma-3n-e4b-it', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Gemma 3N E4B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3N E4B','google/gemma-3n-e4b-it','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3N E4B','google/gemma-3n-e4b-it','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3N E4B','google/gemma-3n-e4b-it','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Gemma 3 27B', 'google/gemma-3-27b-it', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Gemma 3 27B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 27B','google/gemma-3-27b-it','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 27B','google/gemma-3-27b-it','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 27B','google/gemma-3-27b-it','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Gemma 3 1B', 'google/gemma-3-1b-it', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Gemma 3 1B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 1B','google/gemma-3-1b-it','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 1B','google/gemma-3-1b-it','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 3 1B','google/gemma-3-1b-it','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Gemma 2 27B', 'google/gemma-2-27b-it', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Gemma 2 27B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 2 27B','google/gemma-2-27b-it','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 2 27B','google/gemma-2-27b-it','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 2 27B','google/gemma-2-27b-it','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Gemma 7B', 'google/gemma-7b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Gemma 7B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 7B','google/gemma-7b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 7B','google/gemma-7b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Gemma 7B','google/gemma-7b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Granite 3.3 8B', 'ibm/granite-3.3-8b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Granite 3.3 8B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Granite 3.3 8B','ibm/granite-3.3-8b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Granite 3.3 8B','ibm/granite-3.3-8b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Granite 3.3 8B','ibm/granite-3.3-8b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Phi 4 Multimodal', 'microsoft/phi-4-multimodal-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Phi 4 Multimodal</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Multimodal','microsoft/phi-4-multimodal-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Multimodal','microsoft/phi-4-multimodal-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Multimodal','microsoft/phi-4-multimodal-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Phi 4 Mini Reasoning', 'microsoft/phi-4-mini-flash-reasoning', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Phi 4 Mini Reasoning</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Mini Reasoning','microsoft/phi-4-mini-flash-reasoning','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Mini Reasoning','microsoft/phi-4-mini-flash-reasoning','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 4 Mini Reasoning','microsoft/phi-4-mini-flash-reasoning','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Phi 3 Medium', 'microsoft/phi-3-medium-4k-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Phi 3 Medium</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3 Medium','microsoft/phi-3-medium-4k-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3 Medium','microsoft/phi-3-medium-4k-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Phi 3 Medium','microsoft/phi-3-medium-4k-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 4 Maverick', 'meta/llama-4-maverick-17b-128e-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 4 Maverick</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Maverick','meta/llama-4-maverick-17b-128e-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Maverick','meta/llama-4-maverick-17b-128e-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Maverick','meta/llama-4-maverick-17b-128e-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 4 Scout', 'meta/llama-4-scout-17b-16e-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 4 Scout</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Scout','meta/llama-4-scout-17b-16e-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Scout','meta/llama-4-scout-17b-16e-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 4 Scout','meta/llama-4-scout-17b-16e-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 3.3 70B', 'meta/llama-3.3-70b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 3.3 70B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 70B','meta/llama-3.3-70b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 70B','meta/llama-3.3-70b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 70B','meta/llama-3.3-70b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 3.2 3B', 'meta/llama-3.2-3b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 3.2 3B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 3B','meta/llama-3.2-3b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 3B','meta/llama-3.2-3b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.2 3B','meta/llama-3.2-3b-instruct','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'Kimi K2.5', 'moonshotai/kimi-k2.5', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Kimi K2.5</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2.5','moonshotai/kimi-k2.5','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2.5','moonshotai/kimi-k2.5','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2.5','moonshotai/kimi-k2.5','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'Kimi K2 Thinking', 'moonshotai/kimi-k2-thinking', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Kimi K2 Thinking</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Thinking','moonshotai/kimi-k2-thinking','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Thinking','moonshotai/kimi-k2-thinking','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Thinking','moonshotai/kimi-k2-thinking','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Kimi K2 Instruct', 'moonshotai/kimi-k2-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Kimi K2 Instruct</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Instruct','moonshotai/kimi-k2-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Instruct','moonshotai/kimi-k2-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Kimi K2 Instruct','moonshotai/kimi-k2-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Devstral 2 123B', 'mistralai/devstral-2-123b-instruct-2512', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Devstral 2 123B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Devstral 2 123B','mistralai/devstral-2-123b-instruct-2512','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Devstral 2 123B','mistralai/devstral-2-123b-instruct-2512','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Devstral 2 123B','mistralai/devstral-2-123b-instruct-2512','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Mistral Large 3 675B', 'mistralai/mistral-large-3-675b-instruct-2512', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Mistral Large 3 675B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Mistral Large 3 675B','mistralai/mistral-large-3-675b-instruct-2512','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Mistral Large 3 675B','mistralai/mistral-large-3-675b-instruct-2512','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Mistral Large 3 675B','mistralai/mistral-large-3-675b-instruct-2512','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Ministral 14B', 'mistralai/ministral-14b-instruct-2512', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Ministral 14B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Ministral 14B','mistralai/ministral-14b-instruct-2512','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Ministral 14B','mistralai/ministral-14b-instruct-2512','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Ministral 14B','mistralai/ministral-14b-instruct-2512','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Magistral Small', 'mistralai/magistral-small-2506', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Magistral Small</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Magistral Small','mistralai/magistral-small-2506','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Magistral Small','mistralai/magistral-small-2506','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Magistral Small','mistralai/magistral-small-2506','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Mixtral 8x22B', 'mistralai/mixtral-8x22b-instruct-v0.1', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Mixtral 8x22B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Mixtral 8x22B','mistralai/mixtral-8x22b-instruct-v0.1','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Mixtral 8x22B','mistralai/mixtral-8x22b-instruct-v0.1','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Mixtral 8x22B','mistralai/mixtral-8x22b-instruct-v0.1','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Mamba Codestral 7B', 'mistralai/mamba-codestral-7b-v0.1', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Mamba Codestral 7B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Mamba Codestral 7B','mistralai/mamba-codestral-7b-v0.1','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Mamba Codestral 7B','mistralai/mamba-codestral-7b-v0.1','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Mamba Codestral 7B','mistralai/mamba-codestral-7b-v0.1','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Step 3.5 Flash', 'stepfun-ai/step-3.5-flash', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Step 3.5 Flash</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Step 3.5 Flash','stepfun-ai/step-3.5-flash','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Step 3.5 Flash','stepfun-ai/step-3.5-flash','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Step 3.5 Flash','stepfun-ai/step-3.5-flash','3',event)">3</button></div></div><div class="model-card selected"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" checked="" onchange="toggleModelSelection('nvidia', 'GPT OSS 120B', 'openai/gpt-oss-120b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">GPT OSS 120B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 120B','openai/gpt-oss-120b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 120B','openai/gpt-oss-120b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 120B','openai/gpt-oss-120b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'GPT OSS 20B', 'openai/gpt-oss-20b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">GPT OSS 20B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 20B','openai/gpt-oss-20b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 20B','openai/gpt-oss-20b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','GPT OSS 20B','openai/gpt-oss-20b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Sarvam M', 'sarvamai/sarvam-m', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Sarvam M</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Sarvam M','sarvamai/sarvam-m','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Sarvam M','sarvamai/sarvam-m','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Sarvam M','sarvamai/sarvam-m','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Qwen3 Next 80B', 'qwen/qwen3-next-80b-a3b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen3 Next 80B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B','qwen/qwen3-next-80b-a3b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B','qwen/qwen3-next-80b-a3b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B','qwen/qwen3-next-80b-a3b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Qwen3 Next 80B Thinking', 'qwen/qwen3-next-80b-a3b-thinking', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen3 Next 80B Thinking</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B Thinking','qwen/qwen3-next-80b-a3b-thinking','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B Thinking','qwen/qwen3-next-80b-a3b-thinking','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Next 80B Thinking','qwen/qwen3-next-80b-a3b-thinking','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Qwen3 Coder 480B', 'qwen/qwen3-coder-480b-a35b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen3 Coder 480B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Coder 480B','qwen/qwen3-coder-480b-a35b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Coder 480B','qwen/qwen3-coder-480b-a35b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 Coder 480B','qwen/qwen3-coder-480b-a35b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Qwen3 235B', 'qwen/qwen3-235b-a22b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen3 235B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 235B','qwen/qwen3-235b-a22b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 235B','qwen/qwen3-235b-a22b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen3 235B','qwen/qwen3-235b-a22b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'QwQ 32B', 'qwen/qwq-32b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">QwQ 32B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','QwQ 32B','qwen/qwq-32b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','QwQ 32B','qwen/qwq-32b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','QwQ 32B','qwen/qwq-32b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Qwen 2.5 7B', 'qwen/qwen2.5-7b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Qwen 2.5 7B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 2.5 7B','qwen/qwen2.5-7b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 2.5 7B','qwen/qwen2.5-7b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Qwen 2.5 7B','qwen/qwen2.5-7b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Nemotron 4 Mini Hindi', 'nvidia/nemotron-4-mini-hindi-4b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Nemotron 4 Mini Hindi</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 4 Mini Hindi','nvidia/nemotron-4-mini-hindi-4b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 4 Mini Hindi','nvidia/nemotron-4-mini-hindi-4b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 4 Mini Hindi','nvidia/nemotron-4-mini-hindi-4b-instruct','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Nemotron 30B', 'nvidia/nemotron-3-nano-30b-a3b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Nemotron 30B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 30B','nvidia/nemotron-3-nano-30b-a3b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 30B','nvidia/nemotron-3-nano-30b-a3b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 30B','nvidia/nemotron-3-nano-30b-a3b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Nemotron 12B VL', 'nvidia/nemotron-nano-12b-v2-vl', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Nemotron 12B VL</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 12B VL','nvidia/nemotron-nano-12b-v2-vl','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 12B VL','nvidia/nemotron-nano-12b-v2-vl','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 12B VL','nvidia/nemotron-nano-12b-v2-vl','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Nemotron 9B', 'nvidia/nvidia-nemotron-nano-9b-v2', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Nemotron 9B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 9B','nvidia/nvidia-nemotron-nano-9b-v2','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 9B','nvidia/nvidia-nemotron-nano-9b-v2','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Nemotron 9B','nvidia/nvidia-nemotron-nano-9b-v2','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'Llama 3.3 Nemotron Super 49B', 'nvidia/llama-3.3-nemotron-super-49b-v1.5', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">Llama 3.3 Nemotron Super 49B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 Nemotron Super 49B','nvidia/llama-3.3-nemotron-super-49b-v1.5','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 Nemotron Super 49B','nvidia/llama-3.3-nemotron-super-49b-v1.5','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','Llama 3.3 Nemotron Super 49B','nvidia/llama-3.3-nemotron-super-49b-v1.5','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'ChatGLM3 6B', 'thudm/chatglm3-6b', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">ChatGLM3 6B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','ChatGLM3 6B','thudm/chatglm3-6b','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','ChatGLM3 6B','thudm/chatglm3-6b','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','ChatGLM3 6B','thudm/chatglm3-6b','3',event)">3</button></div></div><div class="model-card "><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" onchange="toggleModelSelection('nvidia', 'USDCode Llama 3.1 70B', 'nvidia/usdcode-llama-3.1-70b-instruct', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">USDCode Llama 3.1 70B</div></div><div class="flex gap-1"><button class="stage-btn " onclick="setModelStage('nvidia','USDCode Llama 3.1 70B','nvidia/usdcode-llama-3.1-70b-instruct','1',event)">1</button><button class="stage-btn " onclick="setModelStage('nvidia','USDCode Llama 3.1 70B','nvidia/usdcode-llama-3.1-70b-instruct','2',event)">2</button><button class="stage-btn " onclick="setModelStage('nvidia','USDCode Llama 3.1 70B','nvidia/usdcode-llama-3.1-70b-instruct','3',event)">3</button></div></div></div></div></div>
            </div>
            <div class="p-4 border-t border-[var(--border)] flex justify-between items-center gap-3">
                <div class="text-sm text-[var(--text-secondary)]"><span id="modalSelectedCount">8</span> selected</div>
                <div class="flex gap-3">
                    <button onclick="closeModelSelector()" class="px-4 py-2.5 rounded-xl hover:bg-[var(--bg-tertiary)] transition-colors text-sm">Cancel</button>
                    <button onclick="saveModelSelection()" class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white font-medium text-sm active:scale-95"><i class="fas fa-check mr-2"></i>Apply</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const LANGUAGES = [
            {code:'en',name:'English'},{code:'es',name:'Spanish'},{code:'fr',name:'French'},{code:'de',name:'German'},{code:'it',name:'Italian'},{code:'pt',name:'Portuguese'},{code:'zh',name:'Chinese'},{code:'ja',name:'Japanese'},{code:'ko',name:'Korean'},{code:'ru',name:'Russian'},
            {code:'hi',name:'Hindi'},{code:'ar',name:'Arabic'},{code:'bn',name:'Bengali'},{code:'pa',name:'Punjabi'},{code:'jv',name:'Javanese'},{code:'vi',name:'Vietnamese'},{code:'te',name:'Telugu'},{code:'mr',name:'Marathi'},{code:'ta',name:'Tamil'},{code:'ur',name:'Urdu'},
            {code:'tr',name:'Turkish'},{code:'fa',name:'Persian'},{code:'gu',name:'Gujarati'},{code:'pl',name:'Polish'},{code:'uk',name:'Ukrainian'},{code:'ro',name:'Romanian'},{code:'nl',name:'Dutch'},{code:'el',name:'Greek'},{code:'hu',name:'Hungarian'},{code:'sv',name:'Swedish'},
            {code:'cs',name:'Czech'},{code:'th',name:'Thai'},{code:'id',name:'Indonesian'},{code:'ms',name:'Malay'},{code:'da',name:'Danish'},{code:'fi',name:'Finnish'},{code:'no',name:'Norwegian'},{code:'he',name:'Hebrew'},{code:'bg',name:'Bulgarian'},{code:'hr',name:'Croatian'},
            {code:'sr',name:'Serbian'},{code:'sk',name:'Slovak'},{code:'sl',name:'Slovenian'},{code:'et',name:'Estonian'},{code:'lv',name:'Latvian'},{code:'lt',name:'Lithuanian'},{code:'af',name:'Afrikaans'},{code:'sw',name:'Swahili'},{code:'ca',name:'Catalan'},{code:'eu',name:'Basque'},
            {code:'gl',name:'Galician'},{code:'is',name:'Icelandic'},{code:'ga',name:'Irish'},{code:'sq',name:'Albanian'},{code:'mk',name:'Macedonian'},{code:'bs',name:'Bosnian'},{code:'cy',name:'Welsh'},{code:'hy',name:'Armenian'},{code:'ka',name:'Georgian'},{code:'be',name:'Belarusian'},
            {code:'az',name:'Azerbaijani'},{code:'kk',name:'Kazakh'},{code:'ky',name:'Kyrgyz'},{code:'uz',name:'Uzbek'},{code:'tk',name:'Turkmen'},{code:'tg',name:'Tajik'},{code:'mn',name:'Mongolian'},{code:'ne',name:'Nepali'},{code:'si',name:'Sinhala'},{code:'my',name:'Burmese'},
            {code:'km',name:'Khmer'},{code:'lo',name:'Lao'},{code:'am',name:'Amharic'},{code:'so',name:'Somali'},{code:'yo',name:'Yoruba'},{code:'ig',name:'Igbo'},{code:'ha',name:'Hausa'},{code:'zu',name:'Zulu'},{code:'xh',name:'Xhosa'},{code:'st',name:'Sotho'},
            {code:'fil',name:'Filipino'},{code:'mg',name:'Malagasy'},{code:'ny',name:'Chichewa'},{code:'sn',name:'Shona'},{code:'co',name:'Corsican'},{code:'fy',name:'Frisian'},{code:'gd',name:'Scots Gaelic'},{code:'ht',name:'Haitian Creole'},{code:'haw',name:'Hawaiian'},{code:'hmn',name:'Hmong'},
            {code:'jw',name:'Javanese'},{code:'kn',name:'Kannada'},{code:'ku',name:'Kurdish'},{code:'lb',name:'Luxembourgish'},{code:'mi',name:'Maori'},{code:'ml',name:'Malayalam'},{code:'mt',name:'Maltese'},{code:'ps',name:'Pashto'},{code:'sd',name:'Sindhi'},{code:'sm',name:'Samoan'},
            {code:'su',name:'Sundanese'},{code:'yi',name:'Yiddish'}
        ];

        const UI_TRANSLATIONS = {
            'es': { 'newChat': 'Nuevo Chat', 'settings': 'Ajustes', 'install': 'Instalar App', 'send': 'Enviar', 'config': 'Configurar Modelos' },
            'fr': { 'newChat': 'Nouvelle Chat', 'settings': 'Paramtres', 'install': 'Installer App', 'send': 'Envoyer', 'config': 'Configurer Modles' },
            'de': { 'newChat': 'Neuer Chat', 'settings': 'Einstellungen', 'install': 'App Installieren', 'send': 'Senden', 'config': 'Modelle Konfig.' },
            'hi': { 'newChat': ' ', 'settings': '', 'install': '  ', 'send': '', 'config': '  ' },
            'zh': { 'newChat': '', 'settings': '', 'install': '', 'send': '', 'config': '' },
            'ja': { 'newChat': '', 'settings': '', 'install': '', 'send': '', 'config': '' },
            'ru': { 'newChat': ' ', 'settings': '', 'install': '', 'send': '', 'config': '' },
            'ar': { 'newChat': ' ', 'settings': '', 'install': ' ', 'send': '', 'config': ' ' },
            'pt': { 'newChat': 'Novo Chat', 'settings': 'Configuraes', 'install': 'Instalar App', 'send': 'Enviar', 'config': 'Configurar Modelos' }
        };

        const MODEL_CONFIGS = {
            'sarvamai/sarvam-m': { max_tokens: 30000 }, 'qwen/qwq-32b': { max_tokens: 30000 }, 'qwen/qwen2.5-7b-instruct': { max_tokens: 30000 }, 'mistralai/mamba-codestral-7b-v0.1': { max_tokens: 30000 },
            'google/gemma-3-1b-it': { max_tokens: 30000 }, 'google/gemma-3n-e4b-it': { max_tokens: 30000 }, 'microsoft/phi-4-mini-flash-reasoning': { max_tokens: 60000 },
            'mistralai/mixtral-8x22b-instruct-v0.1': { max_tokens: 60000 }, 
            'google/shieldgemma-9b': { max_tokens: 1000 },
            'google/gemma-7b': { max_tokens: 6000, noSystemRole: true },
            'google/gemma-2-27b-it': { max_tokens: 6000, noSystemRole: true },
            'thudm/chatglm3-6b': { max_tokens: 6000 },
            'nvidia/nemotron-4-mini-hindi-4b-instruct': { max_tokens: 3000 },
            'microsoft/phi-3-medium-4k-instruct': { max_tokens: 3000 },
            'deepseek-ai/deepseek-r1-distill-qwen-32b': { noStream: true, max_tokens: 30000 },
            'deepseek-ai/deepseek-r1-distill-llama-8b': { noStream: true, max_tokens: 30000 },
            'ibm/granite-3.3-8b-instruct': { noStream: true, max_tokens: 30000 },
            'z-ai/glm4.7': { noStream: true, max_tokens: 30000 },
            'nvidia/cosmos-reason2-8b': { max_tokens: 4000 }
        };

        const PROVIDERS = {
            nvidia: { name: 'Saksham Intelligence', endpoint: 'https://integrate.api.nvidia.com/v1/chat/completions', keyName: 'sahu_nvidia_key', color: 'nvidia', icon: '', models: { 'Qwen 3.5 397B': 'qwen/qwen3.5-397b', 'Phi 3.5 Vision': 'microsoft/phi-3.5-vision-instruct', 'Stockmark 2 100B': 'stockmark/stockmark-2-100b-instruct', 'Cosmos Reason 2 8B': 'nvidia/cosmos-reason2-8b', 'Llama 3.2 90B Vision': 'meta/llama-3.2-90b-vision-instruct', 'GLM 5': 'z-ai/glm5', 'MiniMax M2.5': 'minimaxai/minimax-m2.5', 'ShieldGemma 9B': 'google/shieldgemma-9b', 'MiniMax M2.1': 'minimaxai/minimax-m2.1', 'MiniMax M2': 'minimaxai/minimax-m2', 'GLM 4.7': 'z-ai/glm4.7', 'Jamba 1.5 Mini': 'ai21labs/jamba-1.5-mini-instruct', 'Seed OSS 36B': 'bytedance/seed-oss-36b-instruct', 'DeepSeek V3.2': 'deepseek-ai/deepseek-v3.2', 'DeepSeek V3.1': 'deepseek-ai/deepseek-v3.1', 'DeepSeek V3.1 Terminus': 'deepseek-ai/deepseek-v3.1-terminus', 'DeepSeek R1 Distill Qwen 32B': 'deepseek-ai/deepseek-r1-distill-qwen-32b', 'DeepSeek R1 Distill Llama 8B': 'deepseek-ai/deepseek-r1-distill-llama-8b', 'Gemma 3N E4B': 'google/gemma-3n-e4b-it', 'Gemma 3 27B': 'google/gemma-3-27b-it', 'Gemma 3 1B': 'google/gemma-3-1b-it', 'Gemma 2 27B': 'google/gemma-2-27b-it', 'Gemma 7B': 'google/gemma-7b', 'Granite 3.3 8B': 'ibm/granite-3.3-8b-instruct', 'Phi 4 Multimodal': 'microsoft/phi-4-multimodal-instruct', 'Phi 4 Mini Reasoning': 'microsoft/phi-4-mini-flash-reasoning', 'Phi 3 Medium': 'microsoft/phi-3-medium-4k-instruct', 'Llama 4 Maverick': 'meta/llama-4-maverick-17b-128e-instruct', 'Llama 4 Scout': 'meta/llama-4-scout-17b-16e-instruct', 'Llama 3.3 70B': 'meta/llama-3.3-70b-instruct', 'Llama 3.2 3B': 'meta/llama-3.2-3b-instruct', 'Kimi K2.5': 'moonshotai/kimi-k2.5', 'Kimi K2 Thinking': 'moonshotai/kimi-k2-thinking', 'Kimi K2 Instruct': 'moonshotai/kimi-k2-instruct', 'Devstral 2 123B': 'mistralai/devstral-2-123b-instruct-2512', 'Mistral Large 3 675B': 'mistralai/mistral-large-3-675b-instruct-2512', 'Ministral 14B': 'mistralai/ministral-14b-instruct-2512', 'Magistral Small': 'mistralai/magistral-small-2506', 'Mixtral 8x22B': 'mistralai/mixtral-8x22b-instruct-v0.1', 'Mamba Codestral 7B': 'mistralai/mamba-codestral-7b-v0.1', 'Step 3.5 Flash': 'stepfun-ai/step-3.5-flash', 'GPT OSS 120B': 'openai/gpt-oss-120b', 'GPT OSS 20B': 'openai/gpt-oss-20b', 'Sarvam M': 'sarvamai/sarvam-m', 'Qwen3 Next 80B': 'qwen/qwen3-next-80b-a3b-instruct', 'Qwen3 Next 80B Thinking': 'qwen/qwen3-next-80b-a3b-thinking', 'Qwen3 Coder 480B': 'qwen/qwen3-coder-480b-a35b-instruct', 'Qwen3 235B': 'qwen/qwen3-235b-a22b', 'QwQ 32B': 'qwen/qwq-32b', 'Qwen 2.5 7B': 'qwen/qwen2.5-7b-instruct', 'Nemotron 4 Mini Hindi': 'nvidia/nemotron-4-mini-hindi-4b-instruct', 'Nemotron 30B': 'nvidia/nemotron-3-nano-30b-a3b', 'Nemotron 12B VL': 'nvidia/nemotron-nano-12b-v2-vl', 'Nemotron 9B': 'nvidia/nvidia-nemotron-nano-9b-v2', 'Llama 3.3 Nemotron Super 49B': 'nvidia/llama-3.3-nemotron-super-49b-v1.5', 'ChatGLM3 6B': 'thudm/chatglm3-6b', 'USDCode Llama 3.1 70B': 'nvidia/usdcode-llama-3.1-70b-instruct' } },
            sambanova: { name: 'SambaNova', endpoint: 'https://api.sambanova.ai/v1/chat/completions', keyName: 'sahu_sambanova_key', color: 'sambanova', icon: '', models: { 'ALLaM 7B': 'ALLaM-7B-Instruct-preview', 'DeepSeek R1': 'DeepSeek-R1-0528', 'DeepSeek R1 Distill 70B': 'DeepSeek-R1-Distill-Llama-70B', 'DeepSeek V3.1': 'DeepSeek-V3.1', 'DeepSeek V3.1 Terminus': 'DeepSeek-V3.1-Terminus', 'DeepSeek V3.2': 'DeepSeek-V3.2', 'Llama Swallow 70B': 'Llama-3.3-Swallow-70B-Instruct-v0.4', 'Llama 4 Maverick': 'Llama-4-Maverick-17B-128E-Instruct', 'Llama 3.1 8B': 'Meta-Llama-3.1-8B-Instruct', 'Llama 3.3 70B': 'Meta-Llama-3.3-70B-Instruct', 'GPT OSS 120B': 'gpt-oss-120b', 'Qwen3 235B': 'Qwen3-235B', 'Qwen3 32B': 'Qwen3-32B' } },
            huggingface: { name: 'HuggingFace', endpoint: 'https://router.huggingface.co/v1/chat/completions', keyName: 'sahu_huggingface_key', color: 'huggingface', icon: '', models: { 'DeepSeek OCR': 'deepseek-ai/deepseek-ocr', 'DeepSeek OCR 2': 'deepseek-ai/deepseek-ocr-2', 'GLM 5': 'zai-org/GLM-5', 'MiniMax M2.5': 'minimaxai/MiniMax-M2.5', 'GLM 5 Flash': 'zai-org/GLM-5-Flash', 'GLM 4.7': 'zai-org/GLM-4.7', 'GLM 4.7 Flash': 'zai-org/GLM-4.7-Flash', 'ERNIE 4.5 VL': 'baidu/ERNIE-4.5-VL-424B-A47B-Base-PT', 'DeepSeek V3.2': 'deepseek-ai/DeepSeek-V3.2', 'DeepSeek R1': 'deepseek-ai/DeepSeek-R1', 'DeepSeek R1 Distill': 'deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B', 'Qwen3 Coder': 'Qwen/Qwen3-Coder-480B-A35B-Instruct', 'Qwen3 Thinking': 'Qwen/Qwen3-235B-A22B-Thinking-2507', 'Mistral 7B': 'mistralai/Mistral-7B-Instruct-v0.3', 'Kimi K2 Thinking': 'moonshotai/Kimi-K2-Thinking', 'Kimi K2': 'moonshotai/Kimi-K2-Instruct', 'Kimi K2.5': 'moonshotai/Kimi-K2.5', 'GPT OSS 120B': 'openai/gpt-oss-120b', 'GPT OSS 20B': 'openai/gpt-oss-20b', 'MiMo V2 Flash': 'XiaomiMiMo/MiMo-V2-Flash', 'MiniMax M2.1': 'MiniMaxAI/MiniMax-M2.1', 'Olmo 3.1': 'allenai/Olmo-3.1-32B-Instruct', 'Olmo 3.1 Think': 'allenai/Olmo-3.1-32B-Think', 'Llama 3.3 70B': 'meta-llama/Llama-3.3-70B-Instruct', 'NextCoder 32B': 'microsoft/NextCoder-32B', 'KAT Dev': 'Kwaipilot/KAT-Dev' } },
            openrouter: { name: 'OpenRouter', endpoint: 'https://openrouter.ai/api/v1/chat/completions', keyName: 'sahu_openrouter_key', color: 'openrouter', icon: '', models: { 'Trinity Large': 'arcee-ai/trinity-large-preview:free', 'Solar Pro 3': 'upstage/solar-pro-3:free', 'LFM Thinking': 'liquid/lfm-2.5-1.2b-thinking:free', 'LFM Instruct': 'liquid/lfm-2.5-1.2b-instruct:free', 'Molmo 2 8B': 'allenai/molmo-2-8b:free', 'Nemotron 30B': 'nvidia/nemotron-3-nano-30b-a3b:free', 'Trinity Mini': 'arcee-ai/trinity-mini:free', 'TNG R1T Chimera': 'tngtech/tng-r1t-chimera:free', 'Nemotron 12B VL': 'nvidia/nemotron-nano-12b-v2-vl:free', 'Qwen3 Next 80B': 'qwen/qwen3-next-80b-a3b-instruct:free', 'Nemotron 9B': 'nvidia/nemotron-nano-9b-v2:free', 'GLM 4.5 Air': 'z-ai/glm-4.5-air:free', 'Qwen3 Coder': 'qwen/qwen3-coder:free', 'DeepSeek R1T2 Chimera': 'tngtech/deepseek-r1t2-chimera:free', 'DeepSeek R1': 'deepseek/deepseek-r1-0528:free', 'Qwen3 4B': 'qwen/qwen3-4b:free', 'DeepSeek R1T Chimera': 'tngtech/deepseek-r1t-chimera:free', 'Mistral Small': 'mistralai/mistral-small-3.1-24b-instruct:free', 'Qwen 2.5 VL': 'qwen/qwen-2.5-vl-7b-instruct:free', 'Hermes 3 405B': 'nousresearch/hermes-3-llama-3.1-405b:free', 'Llama 3.1 405B': 'meta-llama/llama-3.1-405b-instruct:free', 'Nova 2 Lite': 'amazon/nova-2-lite-v1' } },
            groq: { name: 'Groq', endpoint: 'https://api.groq.com/openai/v1/chat/completions', keyName: 'sahu_groq_key', color: 'groq', icon: '', models: { 'GPT OSS 120B': 'openai/gpt-oss-120b', 'GPT OSS 20B': 'openai/gpt-oss-20b', 'Qwen3 32B': 'qwen/qwen3-32b', 'Llama 3.1 8B': 'llama-3.1-8b-instant', 'Llama 3.3 70B': 'llama-3.3-70b-versatile', 'Llama 4 Maverick': 'meta-llama/llama-4-maverick-17b-128e-instruct', 'Llama 4 Scout': 'meta-llama/llama-4-scout-17b-16e-instruct', 'Kimi K2 Instruct': 'moonshotai/kimi-k2-instruct', 'Kimi K2 0905': 'moonshotai/kimi-k2-instruct-0905', 'Groq Compound': 'groq/compound' } },
            together: { name: 'Together AI', endpoint: 'https://api.together.xyz/v1/chat/completions', keyName: 'sahu_together_key', color: 'together', icon: '', models: { 'GLM 5': 'z-ai/glm-5', 'MiniMax M2.5': 'minimaxai/MiniMax-M2.5', 'GLM 4.7': 'zai-org/GLM-4.7', 'Llama 4 Maverick': 'meta-llama/Llama-4-Maverick-17B-128E-Instruct-FP8', 'DeepSeek R1': 'deepseek-ai/DeepSeek-R1-0528-tput', 'Ministral 14B': 'mistralai/Ministral-3-14B-Instruct-2512', 'Trinity Mini': 'arcee-ai/trinity-mini', 'Cogito 671B': 'deepcogito/cogito-v2-1-671b', 'GLM 4.5 Air': 'zai-org/GLM-4.5-Air-FP8', 'Qwen3 Next 80B': 'Qwen/Qwen3-Next-80B-A3B-Thinking', 'Gemma 3N': 'google/gemma-3n-E4B-it', 'Nemotron 9B': 'nvidia/NVIDIA-Nemotron-Nano-9B-v2', 'Llama 4 Scout': 'meta-llama/Llama-4-Scout-17B-16E-Instruct', 'Cogito 405B': 'deepcogito/cogito-v2-preview-llama-405B', 'Cogito 109B': 'deepcogito/cogito-v2-preview-llama-109B-MoE' } },
            cerebras: { name: 'Cerebras', endpoint: 'https://api.cerebras.ai/v1/chat/completions', keyName: 'sahu_cerebras_key', color: 'cerebras', icon: '', models: { 'Qwen 3 32B': 'qwen-3-32b', 'Qwen 3 235B': 'qwen-3-235b-a22b-instruct-2507', 'GPT OSS 120B': 'gpt-oss-120b', 'Llama 3.3 70B': 'llama-3.3-70b', 'Llama 3.1 8B': 'llama3.1-8b', 'ZAI GLM 4.7': 'zai-glm-4.7' } },
            fireworks: { name: 'Fireworks AI', endpoint: 'https://api.fireworks.ai/inference/v1/chat/completions', keyName: 'sahu_fireworks_key', color: 'fireworks', icon: '', models: { 'GLM 5': 'accounts/fireworks/models/glm-5', 'MiniMax M2.5': 'accounts/fireworks/models/minimax-m2.5', 'DeepSeek OCR': 'accounts/fireworks/models/deepseek-ocr', 'DeepSeek OCR 2': 'accounts/fireworks/models/deepseek-ocr-2', 'Kimi K2.5': 'accounts/fireworks/models/kimi-k2p5', 'MiniMax M2.1': 'accounts/fireworks/models/minimax-m2p1', 'GLM 4.7': 'accounts/fireworks/models/glm-4p7', 'DeepSeek V3.2': 'accounts/fireworks/models/deepseek-v3p2', 'Qwen3 VL 235B': 'accounts/fireworks/models/qwen3-vl-235b-a22b-thinking', 'DeepSeek R1': 'accounts/fireworks/models/deepseek-r1-0528', 'Qwen3 235B': 'accounts/fireworks/models/qwen3-235b-a22b-thinking-2507', 'DeepSeek V3.1': 'accounts/fireworks/models/deepseek-v3p1', 'GLM 4.6': 'accounts/fireworks/models/glm-4p6', 'MiniMax M2': 'accounts/fireworks/models/minimax-m2', 'Qwen3 Coder 480B': 'accounts/fireworks/models/qwen3-coder-480b-a35b-instruct' } },
            routeway: { name: 'Routeway', endpoint: 'https://api.routeway.ai/v1/chat/completions', keyName: 'sahu_routeway_key', color: 'routeway', icon: '', models: { 'Opus 4.5': 'claude-opus-4.5', 'Sonnet 4.5': 'claude-sonnet-4.5', 'Haiku 4.5': 'claude-haiku-4.5', 'o3 Mini High': 'o3-mini-high', 'Command R+': 'command-r-plus-08-2024', 'Command A Reasoning': 'command-a-reasoning-08-2025', 'Command A': 'command-a-03-2025', 'TNG R1T Chimera': 'tngtech/tng-r1t-chimera:free', 'Nemotron 30B': 'nemotron-3-nano-30b-a3b:free', 'Devstral': 'devstral-2512:free', 'Kimi K2 0905': 'kimi-k2-0905:free', 'MiniMax M2': 'minimax-m2:free', 'Nemotron 9B': 'nemotron-nano-9b-v2:free', 'DeepSeek R1T2 Chimera': 'deepseek-r1t2-chimera:free', 'DeepSeek R1T Chimera': 'deepseek-r1t-chimera:free', 'GPT OSS 120B': 'gpt-oss-120b:free', 'GLM 4.5 Air': 'glm-4.5-air:free', 'DeepSeek R1': 'deepseek-r1-0528:free', 'Mistral Nemo': 'mistral-nemo-instruct:free', 'DeepSeek R1 (Free)': 'deepseek-r1:free', 'DeepSeek R1 Distill 32B': 'deepseek-r1-distill-qwen-32b:free', 'Llama 3.2 3B': 'llama-3.2-3b-instruct:free', 'Llama 3.3 70B': 'llama-3.3-70b-instruct:free', 'Llama 3.1 8B': 'llama-3.1-8b-instruct:free', 'Llama 3.2 1B': 'llama-3.2-1b-instruct:free', 'Claude Opus 4.6': 'claude-opus-4-6', 'Claude Opus 4.6 Free': 'claude-opus-4-6:free' } },
            mistral: { name: 'Mistral', endpoint: 'https://api.mistral.ai/v1/agents/completions', keyName: 'sahu_mistral_key', color: 'mistral', icon: '', models: { 'Magistral Medium': 'ag_019bd61a73807623a04e608019bbd02f', 'Ministral 14B': 'ag_019bd61e5c1c751993fd59206f87615c', 'Mistral Large': 'ag_019bd5e9195c72c591ae1de889616331', 'Codestral': 'ag_019bd615fbb872f5a2f5dcaaa3de7c80', 'Devstral': 'ag_019bd5f9714b7062b5ee3544b9fd095e' } },
            gemini: { name: 'Gemini', endpoint: 'https://generativelanguage.googleapis.com/v1beta/openai/chat/completions', keyName: 'sahu_gemini_key', color: 'gemini', icon: '', models: { 'Gemini 3 Flash': 'gemini-3-flash-preview', 'Gemini 2.5 Pro': 'gemini-2.5-pro', 'Gemini 2.5 Flash': 'gemini-flash-latest', 'Gemini 2.5 Flash Lite': 'gemini-flash-lite-latest' } },
            longcat: { name: 'LongCat', endpoint: 'https://api.longcat.chat/openai/v1/chat/completions', keyName: 'sahu_longcat_key', color: 'longcat', icon: '', models: { 'LongCat Flash Chat': 'LongCat-Flash-Chat', 'LongCat Flash Thinking': 'LongCat-Flash-Thinking', 'LongCat Flash Thinking 2601': 'LongCat-Flash-Thinking-2601', 'LongCat Flash Lite': 'LongCat-Flash-Lite' } },
            ollama: { name: 'Ollama Cloud', endpoint: 'https://api.ollama.cloud/v1/chat/completions', keyName: 'sahu_ollama_key', color: 'ollama', icon: '', models: { 'Qwen3 Coder Next': 'qwen3-coder-next:cloud', 'Qwen3 VL': 'qwen3-vl:cloud', 'Qwen3 Next 80B': 'qwen3-next:80b-cloud', 'Kimi K2.5': 'kimi-k2.5:cloud', 'Kimi K2 Thinking': 'kimi-k2-thinking:cloud', 'Kimi K2 1T': 'kimi-k2:1t-cloud', 'MiniMax M2.1': 'minimax-m2.1:cloud', 'MiniMax M2': 'minimax-m2:cloud', 'DeepSeek V3.2': 'deepseek-v3.2:cloud', 'DeepSeek V3.1 671B': 'deepseek-v3.1:671b-cloud', 'GLM 4.6': 'glm-4.6:cloud', 'GLM 4.7': 'glm-4.7:cloud', 'Ministral 3 14B': 'ministral-3:14b-cloud', 'Ministral 3 8B': 'ministral-3:8b-cloud', 'Devstral Small 2 24B': 'devstral-small-2::24b-cloud', 'Devstral 2 123B': 'devstral-2:123b-cloud', 'Nemotron 3 Nano 30B': 'nemotron-3-nano:30b-cloud', 'Cogito 2.1 671B': 'cogito-2.1:671b-cloud', 'RNJ 1 8B': 'rnj-1:8b-cloud', 'Gemini 3 Pro': 'gemini-3-pro-preview', 'Gemini 3 Flash': 'gemini-3-flash-preview', 'GPT OSS 120B': 'gpt-oss:120b-cloud', 'Gemma 3 27B': 'gemma3:27b-cloud' } },
            zenmusk: { name: 'ZenMusk', endpoint: 'https://zenmux.ai/api/v1/chat/completions', keyName: 'sahu_zenmusk_key', color: 'zenmusk', icon: '', models: { 'GLM 5': 'z-ai/glm-5', 'GLM 5 Flash': 'z-ai/glm-5-flash', 'Claude Opus 4.6': 'anthropic/claude-opus-4.6', 'Step 3.5 Flash': 'stepfun/step-3.5-flash-free', 'MiniMax M2 Her': 'minimax/minimax-m2-her', 'Qwen3 Max': 'qwen/qwen3-max', 'Ernie 5.0 Thinking': 'baidu/ernie-5.0-thinking-preview', 'GLM 4.7 Flash': 'z-ai/glm-4.7-flash-free', 'MiMo V2 Flash': 'xiaomi/mimo-v2-flash-free', 'GPT 5.2 Pro': 'openai/gpt-5.2-pro', 'GPT 5.2': 'openai/gpt-5.2', 'GLM 4.6v Flash': 'z-ai/glm-4.6v-flash-free', 'Claude Opus 4.5': 'anthropic/claude-opus-4.5', 'Gemini 3 Pro': 'google/gemini-3-pro-preview', 'KAT Coder Pro': 'kuaishou/kat-coder-pro-v1-free', 'Grok Code Fast': 'x-ai/grok-code-fast-1' } },
            ionet: { name: 'io.net', endpoint: 'https://api.io.net/v1/chat/completions', keyName: 'sahu_ionet_key', color: 'ionet', icon: '', models: { 'Kimi K2 Thinking': 'Kimi-K2-Thinking', 'Kimi K2 Instruct 0905': 'Kimi-K2-Instruct-0905', 'GLM 4.7 Flash': 'GLM-4.7-Flash', 'GLM 4.7': 'GLM-4.7', 'DeepSeek V3.2': 'DeepSeek-V3.2', 'GPT OSS 120B': 'gpt-oss-120b', 'GPT OSS 20B': 'gpt-oss-20b', 'GLM 4.6': 'GLM-4.6', 'Qwen3 Next 80B': 'Qwen3-Next-80B-A3B-Instruct', 'Qwen3 Coder 480B': 'Qwen3-Coder-480B-A35B-Instruct-int4-mixed-ar', 'Llama 4 Maverick': 'Llama-4-Maverick-17B-128E-Instruct-FP8', 'Llama 3.3 70B': 'Llama-3.3-70B-Instruct', 'Mistral Nemo': 'Mistral-Nemo-Instruct-2407', 'Mistral Large': 'Mistral-Large-Instruct-2411' } }
        };

        const AGGREGATOR_PROMPTS = {
            stage1: `You are Stage 1 Aggregator. Analyze all expert answers, identify consensus, disagreements, and errors. Create an initial synthesis. Think step by step in <think> tags.`,
            stage2: `You are Stage 2 Aggregator. Verify the Stage 1 synthesis, resolve contradictions, fill gaps. Think deeply in <think> tags.`,
            stage3: `You are Stage 3 Final Aggregator. Produce a clean, polished final answer. No meta-commentary. Complete and authoritative. Think briefly in <think> tags. Use tools if necessary: SEARCH: <query> or CALC: <expr> or CODE: <python>. Cite sources as [1], [2] if provided.`
        };

        const SEARCH_ENGINES_CONFIG = {
            wikipedia: { name: 'Wikipedia', type: 'api', endpoint: 'https://en.wikipedia.org/w/api.php' },
            reddit: { name: 'Reddit', type: 'api', endpoint: 'https://www.reddit.com/search.json' },
            google: { name: 'Google', type: 'searx', bang: '!g' },
            bing: { name: 'Bing', type: 'searx', bang: '!bing' },
            duckduckgo: { name: 'DuckDuckGo', type: 'searx', bang: '!ddg' },
            yahoo: { name: 'Yahoo', type: 'searx', bang: '!yahoo' },
            yandex: { name: 'Yandex', type: 'searx', bang: '!yandex' },
            qwant: { name: 'Qwant', type: 'searx', bang: '!qwant' },
            brave: { name: 'Brave', type: 'searx', bang: '!brave' },
            startpage: { name: 'Startpage', type: 'searx', bang: '!startpage' },
            baidu: { name: 'Baidu (English)', type: 'searx', bang: '!baidu' },
            youtube: { name: 'YouTube', type: 'searx', bang: '!yt' },
            twitter: { name: 'X (Twitter)', type: 'searx', bang: '!twitter' },
            ncert: { name: 'NCERT', type: 'searx', site: 'ncert.nic.in' },
            diksha: { name: 'DIKSHA', type: 'searx', site: 'diksha.gov.in' },
            cbse: { name: 'CBSE Academic', type: 'searx', site: 'cbseacademic.nic.in' },
            epathshala: { name: 'ePathshala', type: 'searx', site: 'epathshala.nic.in' },
            vedantu: { name: 'Vedantu', type: 'searx', site: 'vedantu.com' },
            magnetbrains: { name: 'Magnet Brains', type: 'searx', site: 'magnetbrains.com' },
            byjus: { name: 'Byjus', type: 'searx', site: 'byjus.com' },
            unacademy: { name: 'Unacademy', type: 'searx', site: 'unacademy.com' },
            mpboard: { name: 'MP Board Solutions', type: 'searx', site: 'mpboardsolutions.in' },
            sahuacademy: { name: 'Sahu Academy', type: 'searx', site: 'saksham6062.github.io/sahu-10' },
            copilot: { name: 'Microsoft Copilot', type: 'searx', site: 'microsoft.com' },
            chatgpt: { name: 'ChatGPT', type: 'searx', site: 'openai.com' },
            chatglm: { name: 'ChatGLM', type: 'searx', site: 'chatglm.cn' },
            gemini: { name: 'Gemini', type: 'searx', site: 'gemini.google.com' },
            deepseek: { name: 'DeepSeek', type: 'searx', site: 'deepseek.com' },
            qwen: { name: 'Qwen', type: 'searx', site: 'aliyun.com' },
            kimi: { name: 'Kimi', type: 'searx', site: 'moonshot.cn' },
            mistral: { name: 'Mistral', type: 'searx', site: 'mistral.ai' },
            grok: { name: 'Grok', type: 'searx', site: 'x.ai' },
            minimax: { name: 'MiniMax', type: 'searx', site: 'minimaxi.com' },
            ernie: { name: 'ERNIE', type: 'searx', site: 'baidu.com' },
            perplexity: { name: 'Perplexity', type: 'searx', site: 'perplexity.ai' },
            discord: { name: 'Discord', type: 'searx', site: 'discord.com' },
            claude: { name: 'Claude', type: 'searx', site: 'anthropic.com' },
            facebook: { name: 'Facebook', type: 'searx', site: 'facebook.com' },
            instagram: { name: 'Instagram', type: 'searx', site: 'instagram.com' },
            github: { name: 'GitHub', type: 'searx', site: 'github.com' },
            googlenews: { name: 'Google News', type: 'searx', bang: '!news' },
            linkedin: { name: 'LinkedIn', type: 'searx', site: 'linkedin.com' },
            grokipedia: { name: 'Grokipedia', type: 'searx', bang: '!w' } 
        };

        const THINKING_TEMPLATES = {
            original: `ORIGINAL:\n- Use your native thinking capabilities.\n- Do not use any forced structured thinking format unless it's your default behavior.`,
            fast: `FAST (Original + Extended Medium):\n- Use your native thinking capabilities.\n- ADDITIONALLY, perform a quick decomposition and single-path reasoning check.\n- Direct answer.`,
            balanced: `BALANCED (Original + Extended High):\n- Use your native thinking capabilities.\n- ADDITIONALLY, perform multi-path reasoning.\n- One critique pass.\n- Structured explanation.`,
            ultra: `ULTRA (Original + Extended X-High):\n- Use your native thinking capabilities.\n- ADDITIONALLY, perform deep counter-analysis.\n- Full assumption testing.\n- Edge-case reasoning.\n- Logical robustness check.\n- Include Confidence Score (0100%).`
        };

        const RESEARCH_STAGES = [
            { id: 'stage1', name: 'Stage 1: Problem Decomposition', experts: ['Strategic Planner', 'Assumption Detector', 'Multimodal Context', 'Sub-question Generator', 'Risk Identification'] },
            { id: 'stage2', name: 'Stage 2: Multi-Perspective Analysis', experts: ['Analytical', 'Creative', 'Skeptical', 'Data-logic', 'Cross-domain'] },
            { id: 'stage3', name: 'Stage 3: Stress Testing', experts: ['Logical Flaw', 'Counter Argument', 'Edge Case', 'Failure Mode', 'Consistency'] },
            { id: 'stage4', name: 'Stage 4: Synthesis', experts: ['Deep Synthesizer', 'Structural Optimizer', 'Depth Preserver', 'Readability', 'Insight Extractor'] },
            { id: 'stage5', name: 'Stage 5: Final Aggregator', experts: ['Final Aggregator'] }
        ];

        const RESEARCH_DEFAULTS = {
            'stage1_0': 'nvidia|meta/llama-3.3-70b-instruct', 'stage1_1': 'nvidia|moonshotai/kimi-k2-instruct', 'stage1_2': 'nvidia|microsoft/phi-4-multimodal-instruct', 'stage1_3': 'nvidia|google/gemma-3-27b-it', 'stage1_4': 'nvidia|nvidia/nemotron-3-nano-30b-a3b',
            'stage2_0': 'nvidia|qwen/qwq-32b', 'stage2_1': 'nvidia|minimaxai/minimax-m2.1', 'stage2_2': 'nvidia|deepseek-ai/deepseek-r1-distill-qwen-32b', 'stage2_3': 'nvidia|z-ai/glm5', 'stage2_4': 'nvidia|qwen/qwen3-next-80b-a3b-thinking',
            'stage3_0': 'nvidia|deepseek-ai/deepseek-r1-distill-llama-8b', 'stage3_1': 'nvidia|moonshotai/kimi-k2-thinking', 'stage3_2': 'nvidia|microsoft/phi-4-mini-flash-reasoning', 'stage3_3': 'nvidia|mistralai/devstral-2-123b-instruct-2512', 'stage3_4': 'nvidia|mistralai/ministral-14b-instruct-2512',
            'stage4_0': 'nvidia|z-ai/glm5', 'stage4_1': 'nvidia|moonshotai/kimi-k2.5', 'stage4_2': 'nvidia|deepseek-ai/deepseek-v3.2', 'stage4_3': 'nvidia|minimaxai/minimax-m2.1', 'stage4_4': 'nvidia|meta/llama-4-scout-17b-16e-instruct',
            'stage5_agg': 'nvidia|z-ai/glm5'
        };

        const RESEARCH_FALLBACKS = {
            'stage1_0': 'nvidia|meta/llama-4-scout-17b-16e-instruct', 'stage1_1': 'nvidia|openai/gpt-oss-120b', 'stage1_2': 'nvidia|nvidia/nemotron-nano-12b-v2-vl', 'stage1_3': 'nvidia|google/gemma-3n-e4b-it', 'stage1_4': 'nvidia|sarvamai/sarvam-m',
            'stage2_0': 'nvidia|microsoft/phi-4-mini-flash-reasoning', 'stage2_1': 'nvidia|minimaxai/minimax-m2', 'stage2_2': 'nvidia|deepseek-ai/deepseek-r1-distill-llama-8b', 'stage2_3': 'nvidia|z-ai/glm4.7', 'stage2_4': 'nvidia|qwen/qwen3-next-80b-a3b-instruct',
            'stage3_0': 'nvidia|openai/gpt-oss-20b', 'stage3_1': 'nvidia|moonshotai/kimi-k2-instruct', 'stage3_2': 'nvidia|ibm/granite-3.3-8b-instruct', 'stage3_3': 'nvidia|mistralai/mamba-codestral-7b-v0.1', 'stage3_4': 'nvidia|mistralai/magistral-small-2506',
            'stage4_0': 'nvidia|z-ai/glm4.7', 'stage4_1': 'nvidia|moonshotai/kimi-k2-thinking', 'stage4_2': 'nvidia|deepseek-ai/deepseek-v3.1-terminus', 'stage4_3': 'nvidia|minimaxai/minimax-m2', 'stage4_4': 'nvidia|openai/gpt-oss-120b',
            'stage5_agg': 'nvidia|mistralai/mistral-large-3-675b-instruct-2512'
        };

        let state = {
            messages: [], chatHistory: [], currentChatId: null, isProcessing: false, theme: 'light',
            uploadedFile: null, uploadedFileContent: null, activeProviders: ['nvidia'], selectedModels: [],
            autoFallback: true, shieldGemmaEnabled: false, deepThinkEnabled: true, researchEnabled: false,
            mode: 'standard', examMode: false, pinnedMessages: [],
            totalTokens: 0, customInstructions: { user: '', resp: '' },
            searchProvider: 'ddg', selfConsistency: false, lastSources: [],
            temperature: 0.7, maxTokens: 8000, taskType: 'vibe',
            currentArtifact: { code: '', type: 'text' }, language: 'en',
            activeSearchEngines: [],
            thinkingBudget: 'balanced', // Default
            aggregationStyle: 'synthesis',
            researchConfig: {}, // Stores model selection for each stage
            neuralConsensus: false,
            debateMode: false,
            temporalReasoning: true,
            adaptiveReasoning: true,
            predictedQuestions: [],
            webSearchEnabled: true,
            agentSwarm: false, visionToCode: false, collaborativeCanvas: false, videoGeneration: false,
            rapidLearning: false, browserAgent: false, voiceCloning: false, tokenContext: false,
            gemsMarketplace: false, physicalIntegration: false, constitutionalSafety: false
        };

        let pyodide = null;

        // --- GLOBAL FUNCTIONS EXPLICITLY ASSIGNED ---
        window.toggleSidebar = () => { document.getElementById('sidebar').classList.toggle('open'); document.getElementById('sidebarOverlay').classList.toggle('show'); };
                window.toggleToolsMenu = () => {
            const menu = document.getElementById('toolsMenu');
            menu.classList.toggle('hidden');
            // Update checkbox states
            document.getElementById('toolDeepThink').checked = state.deepThinkEnabled;
            document.getElementById('toolWebSearch').checked = state.webSearchEnabled;
            
            // Handle locking
            const dtCheck = document.getElementById('toolDeepThink');
            const wsCheck = document.getElementById('toolWebSearch');
            
            if(state.mode === 'research' || state.debateMode) {
                dtCheck.disabled = true;
                wsCheck.disabled = true;
            } else if (state.mode === 'search') {
                wsCheck.disabled = true;
                dtCheck.disabled = false;
            } else {
                dtCheck.disabled = false;
                wsCheck.disabled = false;
            }
        };

        window.toggleDeepThinkFromMenu = (checked) => {
            if(state.mode === 'research' || state.debateMode) {
                document.getElementById('toolDeepThink').checked = true;
                return; // Locked
            }
            state.deepThinkEnabled = checked;
            showToast(state.deepThinkEnabled ? 'Deepthink Enabled' : 'Deepthink Disabled');
        };

        window.toggleWebSearchFromMenu = (checked) => {
             if(state.mode === 'research' || state.mode === 'search' || state.debateMode) {
                document.getElementById('toolWebSearch').checked = true;
                return; // Locked
            }
            state.webSearchEnabled = checked;
            showToast(state.webSearchEnabled ? 'Web Search Enabled' : 'Web Search Disabled');
        };

        window.startVoiceInput = () => {
            if (!('webkitSpeechRecognition' in window)) {
                showToast('Voice input not supported in this browser', 'error');
                return;
            }
            const recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = state.language || 'en-US';
            
            showToast('Listening...', 'info');
            
            recognition.onresult = (event) => {
                const text = event.results[0][0].transcript;
                const input = document.getElementById('userInput');
                input.value += (input.value ? ' ' : '') + text;
                autoResize(input);
                showToast('Voice input captured');
            };
            
            recognition.onerror = (event) => {
                showToast('Voice error: ' + event.error, 'error');
            };
            
            recognition.start();
            document.getElementById('toolsMenu').classList.add('hidden');
        };

        window.toggleDeepThink = () => {
            state.deepThinkEnabled = !state.deepThinkEnabled;
            // Removed button update since it's now in menu
            showToast(state.deepThinkEnabled ? 'Deepthink Enabled (All Models)' : 'Deepthink Disabled');
        };

        window.updateMode = (mode) => {
            state.mode = mode;
            const btn = document.getElementById('taskTypeBtn');
            const welcome = document.getElementById('defaultWelcomeContent');
            const discovery = document.getElementById('discoveryFeed');
            
            // Set Thinking Budget Defaults based on Mode
            if (mode === 'research') {
                state.thinkingBudget = 'ultra';
                state.deepThinkEnabled = true; // Force ON
                state.webSearchEnabled = true; // Force ON
            } else if (mode === 'task') {
                if (state.taskType === 'file_creation') {
                    state.thinkingBudget = 'balanced';
                } else {
                    state.thinkingBudget = 'ultra'; // vibe or agentic
                }
                state.deepThinkEnabled = true;
            } else if (mode === 'search') {
                state.webSearchEnabled = true; // Force ON
            } else {
                state.thinkingBudget = 'balanced'; // Standard default
            }
            if(document.getElementById('thinkingBudget')) document.getElementById('thinkingBudget').value = state.thinkingBudget;

            if(mode === 'task') {
                btn.classList.remove('hidden');
                if(!['vibe', 'agentic', 'file_creation'].includes(state.taskType)) state.taskType = 'vibe';
                updateTaskTypeLabel();
                showToast('Task Mode Active');
            } else {
                btn.classList.add('hidden');
            }

            if(mode === 'search') {
                document.body.classList.add('mode-search-ui');
                if(state.messages.length === 0) {
                    if(welcome) welcome.style.display = 'none';
                    if(discovery) {
                        discovery.style.display = 'grid';
                        renderDiscovery();
                    }
                }
                showToast('SahuAI Search Mode: Conversational & Cited');
            } else {
                document.body.classList.remove('mode-search-ui');
                if(welcome) welcome.style.display = 'block';
                if(discovery) discovery.style.display = 'none';
            }
            
            if(mode !== 'task' && mode !== 'search') showToast('Mode: ' + mode.charAt(0).toUpperCase() + mode.slice(1));
        };

        window.toggleTaskType = () => {
            if(state.taskType === 'vibe') state.taskType = 'agentic';
            else if(state.taskType === 'agentic') state.taskType = 'file_creation';
            else state.taskType = 'vibe';
            
            updateTaskTypeLabel();
            window.updateMode('task'); 
        };

        function updateTaskTypeLabel() {
            const btn = document.getElementById('taskTypeBtn');
            const label = document.getElementById('taskTypeLabel');
            
            if(state.taskType === 'vibe') {
                label.textContent = 'VIBE';
                btn.className = 'p-2 rounded-xl task-btn-vibe transition-all active:scale-95 font-bold text-xs flex items-center gap-1';
            } else if (state.taskType === 'agentic') {
                label.textContent = 'AGENTIC';
                btn.className = 'p-2 rounded-xl task-btn-agentic transition-all active:scale-95 font-bold text-xs flex items-center gap-1';
            } else {
                label.textContent = 'CREATE FILE';
                btn.className = 'p-2 rounded-xl task-btn-file transition-all active:scale-95 font-bold text-xs flex items-center gap-1';
            }
            showToast(`Task Type: ${label.textContent}`);
        }
        
        window.openSettings = () => { 
            document.getElementById('settingsModal').classList.remove('hidden'); 
            navigateSettings('main'); 
            
            renderApiKeyInputs(); 
            renderProviderCheckboxes();
            renderLanguageSelector();
            renderSearchEngines(); 
            renderResearchConfig(); 

            document.getElementById('stageSelector').value = document.querySelector('#sidebar #stageSelector')?.value || '1'; 
            document.getElementById('autoFallback').checked = state.autoFallback;
            document.getElementById('neuralConsensusCheck').checked = state.neuralConsensus;
            document.getElementById('debateModeCheck').checked = state.debateMode;
            document.getElementById('temporalReasoningCheck').checked = state.temporalReasoning;
            document.getElementById('adaptiveReasoningCheck').checked = state.adaptiveReasoning;
            
            document.getElementById('uncertaintyBadgeCheck').checked = state.uncertaintyBadge;
            document.getElementById('tokenEstimatorCheck').checked = state.tokenEstimator;
            document.getElementById('responseRatingCheck').checked = state.responseRating;
            document.getElementById('threeTierMemoryCheck').checked = state.threeTierMemory;
            document.getElementById('selfCorrectingCodeCheck').checked = state.selfCorrectingCode;
            document.getElementById('usageAnalyticsCheck').checked = state.usageAnalytics;

            document.getElementById('agentSwarmCheck').checked = state.agentSwarm;
            document.getElementById('visionToCodeCheck').checked = state.visionToCode;
            document.getElementById('collaborativeCanvasCheck').checked = state.collaborativeCanvas;
            document.getElementById('videoGenerationCheck').checked = state.videoGeneration;
            document.getElementById('rapidLearningCheck').checked = state.rapidLearning;
            document.getElementById('browserAgentCheck').checked = state.browserAgent;
            document.getElementById('voiceCloningCheck').checked = state.voiceCloning;
            document.getElementById('tokenContextCheck').checked = state.tokenContext;
            document.getElementById('gemsMarketplaceCheck').checked = state.gemsMarketplace;
            document.getElementById('physicalIntegrationCheck').checked = state.physicalIntegration;
            document.getElementById('constitutionalSafetyCheck').checked = state.constitutionalSafety;

            document.getElementById('shieldGemmaCheck').checked = state.shieldGemmaEnabled;
            document.getElementById('selfConsistencyCheck').checked = state.selfConsistency;
            document.getElementById('customInstructionsUser').value = state.customInstructions.user || ''; 
            document.getElementById('customInstructionsResp').value = state.customInstructions.resp || ''; 
            document.getElementById('settingTemp').value = state.temperature; 
            document.getElementById('settingMaxTokens').value = state.maxTokens; 
            document.getElementById('thinkingBudget').value = state.thinkingBudget || 'balanced';
            document.getElementById('aggregationStyle').value = state.aggregationStyle || 'synthesis';
        };
        window.closeSettings = () => { document.getElementById('settingsModal').classList.add('hidden'); };

        window.navigateSettings = (view) => {
            document.querySelectorAll('.settings-view').forEach(el => el.classList.remove('active'));
            document.getElementById(`settings-${view}`).classList.add('active');
            
            const title = document.getElementById('settingsTitle');
            const backBtn = document.getElementById('settingsBackBtn');
            
            if(view === 'main') {
                title.innerHTML = '<i class="fas fa-cog text-[var(--accent)]"></i> Settings';
                backBtn.classList.add('hidden');
            } else {
                let name = view.charAt(0).toUpperCase() + view.slice(1);
                if(view === 'keys') name = 'API Keys';
                if(view === 'search') name = 'Search Engines';
                if(view === 'research') name = 'Research Config';
                title.textContent = name;
                backBtn.classList.remove('hidden');
            }
        };
        
        window.openSourceCode = () => { document.getElementById('sourceCodeModal').classList.remove('hidden'); document.getElementById('sourceCodeViewer').value = document.documentElement.outerHTML; };
        window.closeSourceCode = () => { document.getElementById('sourceCodeModal').classList.add('hidden'); };
        window.copySourceCode = () => { const viewer = document.getElementById('sourceCodeViewer'); viewer.select(); navigator.clipboard.writeText(viewer.value).then(() => showToast('Source Code Copied!')); };
        window.toggleTheme = () => { state.theme = state.theme === 'light' ? 'dark' : 'light'; document.body.classList.toggle('dark-mode'); localStorage.setItem('sahu_theme', state.theme); const icon = document.getElementById('themeIcon'); icon.className = state.theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon'; document.getElementById('themeText').textContent = state.theme === 'dark' ? 'Light Mode' : 'Dark Mode'; };
        
        function renderResearchConfig() {
            const container = document.getElementById('researchStagesConfig');
            if(!container) return;
            
            let modelOptions = '<option value="">Default (First Available)</option>';
            state.activeProviders.forEach(p => {
                if(PROVIDERS[p] && PROVIDERS[p].models) {
                    Object.keys(PROVIDERS[p].models).forEach(mName => {
                        const mId = PROVIDERS[p].models[mName];
                        modelOptions += `<option value="${p}|${mId}">${mName} (${PROVIDERS[p].name})</option>`;
                    });
                }
            });

            container.innerHTML = RESEARCH_STAGES.map(stage => {
                let expertSelectors = '';
                
                if (stage.id === 'stage5') {
                    const configKey = `${stage.id}_agg`;
                    const saved = state.researchConfig[configKey] || "";
                    expertSelectors = `
                        <div class="mb-2">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 font-bold">Super Master Model</label>
                            <select class="w-full p-2 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border)] text-xs outline-none" 
                                    id="conf_${configKey}" onchange="updateResearchStageConfig('${configKey}', this.value)">
                                ${modelOptions.replace(`value="${saved}"`, `value="${saved}" selected`)}
                            </select>
                        </div>
                    `;
                } else {
                    expertSelectors = stage.experts.map((exp, idx) => {
                        const configKey = `${stage.id}_${idx}`;
                        const saved = state.researchConfig[configKey] || "";
                        return `
                        <div class="mb-2 pl-2 border-l-2 border-[var(--border)]">
                            <label class="text-[10px] text-[var(--text-secondary)] block mb-1 truncate">${exp}</label>
                            <select class="w-full p-1.5 rounded bg-[var(--bg-secondary)] border border-[var(--border)] text-[10px] outline-none" 
                                    id="conf_${configKey}" onchange="updateResearchStageConfig('${configKey}', this.value)">
                                ${modelOptions.replace(`value="${saved}"`, `value="${saved}" selected`)}
                            </select>
                        </div>
                        `;
                    }).join('');
                }

                return `
                <div class="p-3 bg-[var(--bg-tertiary)] rounded-xl border border-[var(--border)] mb-2">
                    <div class="font-medium text-sm mb-2 text-[var(--accent)]">${stage.name}</div>
                    <div class="grid grid-cols-1 gap-1">
                        ${expertSelectors}
                    </div>
                </div>
                `;
            }).join('');
        }

        window.updateResearchStageConfig = (key, val) => {
            state.researchConfig[key] = val;
        };

        window.saveSettings = () => { 
            Object.keys(PROVIDERS).forEach(k => { const i = document.getElementById(`key_${k}`); if(i) localStorage.setItem(PROVIDERS[k].keyName, i.value); }); 
            state.customInstructions = { user: document.getElementById('customInstructionsUser').value, resp: document.getElementById('customInstructionsResp').value }; 
            localStorage.setItem('sahu2_custom_instructions', JSON.stringify(state.customInstructions)); 
            
            state.temperature = parseFloat(document.getElementById('settingTemp').value);
            state.maxTokens = parseInt(document.getElementById('settingMaxTokens').value);
            localStorage.setItem('sahu2_temp', state.temperature);
            localStorage.setItem('sahu2_max_tokens', state.maxTokens);

            state.neuralConsensus = document.getElementById('neuralConsensusCheck').checked; localStorage.setItem('sahu2_neural_consensus', state.neuralConsensus);
            state.debateMode = document.getElementById('debateModeCheck').checked; localStorage.setItem('sahu2_debate_mode', state.debateMode);
            state.temporalReasoning = document.getElementById('temporalReasoningCheck').checked; localStorage.setItem('sahu2_temporal_reasoning', state.temporalReasoning);
            state.adaptiveReasoning = document.getElementById('adaptiveReasoningCheck').checked; localStorage.setItem('sahu2_adaptive_reasoning', state.adaptiveReasoning);
            
            state.uncertaintyBadge = document.getElementById('uncertaintyBadgeCheck').checked; localStorage.setItem('sahu2_uncertainty_badge', state.uncertaintyBadge);
            state.tokenEstimator = document.getElementById('tokenEstimatorCheck').checked; localStorage.setItem('sahu2_token_estimator', state.tokenEstimator);
            state.responseRating = document.getElementById('responseRatingCheck').checked; localStorage.setItem('sahu2_response_rating', state.responseRating);
            state.threeTierMemory = document.getElementById('threeTierMemoryCheck').checked; localStorage.setItem('sahu2_three_tier_memory', state.threeTierMemory);
            state.selfCorrectingCode = document.getElementById('selfCorrectingCodeCheck').checked; localStorage.setItem('sahu2_self_correcting_code', state.selfCorrectingCode);
            state.usageAnalytics = document.getElementById('usageAnalyticsCheck').checked; localStorage.setItem('sahu2_usage_analytics', state.usageAnalytics);

            state.agentSwarm = document.getElementById('agentSwarmCheck').checked; localStorage.setItem('sahu_agent_swarm', state.agentSwarm);
            state.visionToCode = document.getElementById('visionToCodeCheck').checked; localStorage.setItem('sahu_vision_to_code', state.visionToCode);
            state.collaborativeCanvas = document.getElementById('collaborativeCanvasCheck').checked; localStorage.setItem('sahu_collaborative_canvas', state.collaborativeCanvas);
            state.videoGeneration = document.getElementById('videoGenerationCheck').checked; localStorage.setItem('sahu_video_generation', state.videoGeneration);
            state.rapidLearning = document.getElementById('rapidLearningCheck').checked; localStorage.setItem('sahu_rapid_learning', state.rapidLearning);
            state.browserAgent = document.getElementById('browserAgentCheck').checked; localStorage.setItem('sahu_browser_agent', state.browserAgent);
            state.voiceCloning = document.getElementById('voiceCloningCheck').checked; localStorage.setItem('sahu_voice_cloning', state.voiceCloning);
            state.tokenContext = document.getElementById('tokenContextCheck').checked; localStorage.setItem('sahu_token_context', state.tokenContext);
            state.gemsMarketplace = document.getElementById('gemsMarketplaceCheck').checked; localStorage.setItem('sahu_gems_marketplace', state.gemsMarketplace);
            state.physicalIntegration = document.getElementById('physicalIntegrationCheck').checked; localStorage.setItem('sahu_physical_integration', state.physicalIntegration);
            state.constitutionalSafety = document.getElementById('constitutionalSafetyCheck').checked; localStorage.setItem('sahu_constitutional_safety', state.constitutionalSafety);

            state.autoFallback = document.getElementById('autoFallback').checked; localStorage.setItem('sahu_auto_fallback', state.autoFallback);
            state.shieldGemmaEnabled = document.getElementById('shieldGemmaCheck').checked; localStorage.setItem('sahu_shield_gemma', state.shieldGemmaEnabled);
            state.selfConsistency = document.getElementById('selfConsistencyCheck').checked; localStorage.setItem('sahu2_self_consistency', state.selfConsistency);
            
            state.thinkingBudget = document.getElementById('thinkingBudget').value;
            localStorage.setItem('sahu2_thinking_budget', state.thinkingBudget);
            
            state.aggregationStyle = document.getElementById('aggregationStyle').value;
            localStorage.setItem('sahu2_aggregation_style', state.aggregationStyle);
            
            localStorage.setItem('sahu2_research_config', JSON.stringify(state.researchConfig));
            localStorage.setItem('sahu_search_engines', JSON.stringify(state.activeSearchEngines));

            updateLanguage(state.language); 
            localStorage.setItem('sahu_language', state.language);

            closeSettings(); showToast('Settings Saved!'); 
        };

        window.toggleProvider = (k, e) => { if(e) { if(!state.activeProviders.includes(k)) state.activeProviders.push(k); } else { state.activeProviders = state.activeProviders.filter(p => p !== k); } localStorage.setItem('sahu_active_providers', JSON.stringify(state.activeProviders)); renderProviderCheckboxes(); updateUI(); };
        
        window.renderSearchEngines = () => {
            const list = document.getElementById('searchEngineList');
            if(!list) return;
            list.innerHTML = Object.entries(SEARCH_ENGINES_CONFIG).map(([key, config]) => `
                <label class="flex items-center gap-2 p-2 rounded-lg bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)]">
                    <input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" ${state.activeSearchEngines.includes(key) ? 'checked' : ''} onchange="toggleSearchEngine('${key}', this.checked)">
                    <div class="flex-1 text-sm font-medium">${config.name} <span class="text-[10px] text-[var(--text-secondary)]">${config.type === 'api' ? '(API)' : '(SearXNG)'}</span></div>
                </label>
            `).join('');
        };

        window.toggleSearchEngine = (key, checked) => {
            if(checked) {
                if(!state.activeSearchEngines.includes(key)) state.activeSearchEngines.push(key);
            } else {
                state.activeSearchEngines = state.activeSearchEngines.filter(k => k !== key);
            }
        };

        window.toggleAllSearchEngines = () => {
            const allKeys = Object.keys(SEARCH_ENGINES_CONFIG);
            if(state.activeSearchEngines.length === allKeys.length) {
                state.activeSearchEngines = [];
            } else {
                state.activeSearchEngines = [...allKeys];
            }
            renderSearchEngines();
        };

        window.openDocs = () => { document.getElementById('docsModal').classList.remove('hidden'); };
        window.closeDocs = () => { document.getElementById('docsModal').classList.add('hidden'); };
        
        window.openModelSelector = () => { document.getElementById('modelSelectorModal').classList.remove('hidden'); renderModelSelector(); };
        window.closeModelSelector = () => { document.getElementById('modelSelectorModal').classList.add('hidden'); };
        window.toggleAllModels = (k) => { const p = PROVIDERS[k]; const all = Object.entries(p.models); const sel = all.filter(([mk]) => state.selectedModels.find(m => m.provider === k && m.modelKey === mk)).length; const isAll = sel === all.length; if(isAll) state.selectedModels = state.selectedModels.filter(m => m.provider !== k); else all.forEach(([mk, mid]) => { if(!state.selectedModels.find(m => m.provider === k && m.modelKey === mk)) state.selectedModels.push({provider: k, modelKey: mk, modelId: mid, stage: 'none'}); }); renderModelSelector(); };
        window.toggleModelSelection = (p, mk, mid, s) => { if(s) { if(!state.selectedModels.find(m => m.provider === p && m.modelKey === mk)) state.selectedModels.push({provider: p, modelKey: mk, modelId: mid, stage: 'none'}); } else { state.selectedModels = state.selectedModels.filter(m => !(m.provider === p && m.modelKey === mk)); } renderModelSelector(); };
        window.setModelStage = (p, mk, mid, s, e) => { e.stopPropagation(); let m = state.selectedModels.find(x => x.provider === p && x.modelKey === mk); if(!m) { m = {provider: p, modelKey: mk, modelId: mid, stage: 'none'}; state.selectedModels.push(m); } if(m.stage === s) m.stage = 'none'; else { state.selectedModels.forEach(x => { if(x.stage === s) x.stage = 'none'; }); m.stage = s; } renderModelSelector(); };
        window.saveModelSelection = () => { localStorage.setItem('sahu_selected_models', JSON.stringify(state.selectedModels)); closeModelSelector(); updateUI(); showToast(`${state.selectedModels.length} models configured`); };
        
        window.newChat = () => { state.currentChatId = null; state.messages = []; document.getElementById('messagesContainer').innerHTML = ''; document.getElementById('messagesContainer').classList.add('hidden'); document.getElementById('welcomeScreen').classList.remove('hidden'); document.getElementById('userInput').value = ''; removeFile(); toggleSidebar(); window.location.hash = ''; 
            if(state.mode === 'search') {
                document.getElementById('discoveryFeed').style.display = 'grid';
                renderDiscovery();
            }
        };
        window.triggerFileUpload = () => document.getElementById('fileInput').click();
        window.handleFileUpload = async (e) => { const f = e.target.files[0]; if(!f) return; const t = await f.text().catch(()=>'BINARY_FILE_PLACEHOLDER'); state.uploadedFile = f; state.uploadedFileContent = t.substring(0, 50000); document.getElementById('fileUploadPreview').innerHTML = `<div class="flex items-center gap-3 p-3 bg-[var(--bg-tertiary)] rounded-xl"><div class="w-10 h-10 bg-[var(--accent)] rounded-lg flex items-center justify-center text-white"><i class="fas fa-file"></i></div><div class="flex-1 min-w-0"><div class="font-medium text-sm truncate">${escapeHtml(f.name)}</div><div class="text-xs text-[var(--text-secondary)]">${(f.size/1024).toFixed(1)} KB</div></div><button class="p-2 rounded-lg hover:bg-[var(--bg-secondary)]" onclick="removeFile()"><i class="fas fa-times text-[var(--text-secondary)]"></i></button></div>`; document.getElementById('fileUploadPreview').classList.remove('hidden'); };
        window.removeFile = () => { state.uploadedFile = null; state.uploadedFileContent = null; document.getElementById('fileUploadPreview').classList.add('hidden'); document.getElementById('fileInput').value = ''; };
        window.handleKeyDown = (e) => { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); } if(e.key === 'Escape') { state.isProcessing = false; } };
        window.autoResize = (t) => { t.style.height = 'auto'; t.style.height = Math.min(t.scrollHeight, 120) + 'px'; };
        window.quickPrompt = (t) => { document.getElementById('userInput').value = t; sendMessage(); };
        window.generateShareLink = () => { if(state.messages.length===0){showToast('Chat empty','error');return;} const d = LZString.compressToEncodedURIComponent(JSON.stringify(state.messages)); window.location.hash = d; navigator.clipboard.writeText(window.location.href).then(()=>showToast('Share Link Copied!')); };

        window.loadChat = (id) => { 
            const c = state.chatHistory.find(x => x.id === id); 
            if(c) { 
                state.currentChatId = id; 
                state.messages = c.messages || []; 
                const container = document.getElementById('messagesContainer');
                const welcome = document.getElementById('welcomeScreen');
                
                if(welcome) welcome.classList.add('hidden');
                if(container) {
                    container.classList.remove('hidden');
                    container.innerHTML = '';
                    state.messages.forEach(msg => {
                        if(msg.role === 'user') {
                             container.innerHTML += `<div class="flex justify-end mb-4"><div class="message-user px-4 py-3 rounded-2xl max-w-[85%] shadow-lg"><p class="text-white text-sm whitespace-pre-wrap">${escapeHtml(msg.content)}</p></div></div>`;
                        } else if (msg.role === 'assistant') {
                             let ratingHtml = '';
                             if (state.responseRating) {
                                 ratingHtml = `
                                 <div class="flex gap-2 mt-2 justify-end opacity-50 hover:opacity-100 transition-opacity">
                                     <button class="text-xs p-1 hover:text-green-500" onclick="rateResponse('${msg.id}', 'up')"><i class="fas fa-thumbs-up"></i></button>
                                     <button class="text-xs p-1 hover:text-red-500" onclick="rateResponse('${msg.id}', 'down')"><i class="fas fa-thumbs-down"></i></button>
                                 </div>`;
                             }
                             container.innerHTML += `<div class="flex justify-start mb-4"><div class="message-assistant px-4 py-3 rounded-2xl max-w-[85%] border border-[var(--border)] shadow-sm"><div class="prose max-w-none text-sm">${formatMarkdown(msg.content)}</div>${ratingHtml}</div></div>`;
                        }
                    });
                    setTimeout(() => container.scrollTop = container.scrollHeight, 100);
                }
            } 
            if(window.innerWidth < 768) toggleSidebar(); 
        };

        window.rateResponse = (msgId, rating) => {
            showToast(`Response rated ${rating === 'up' ? 'Good' : 'Bad'}`);
            // In a real app, save this to analytics
            if (state.usageAnalytics) {
                const analytics = JSON.parse(localStorage.getItem('sahu_analytics') || '[]');
                analytics.push({ type: 'rating', msgId, rating, timestamp: Date.now() });
                localStorage.setItem('sahu_analytics', JSON.stringify(analytics));
            }
        };

        window.filterHistory = function(q) {
             if(!q) return renderChatHistory();
             try {
                 const fuse = new Fuse(state.chatHistory, { keys: ['title', 'messages.content'], threshold: 0.4 });
                 const res = fuse.search(q);
                 document.getElementById('chatHistory').innerHTML = res.slice(0, 10).map(r => `<div onclick="loadChat('${r.item.id}')" class="p-3 rounded-xl hover:bg-[var(--bg-tertiary)] cursor-pointer flex items-center gap-3 active:scale-98"><i class="fas fa-search text-[var(--accent)]"></i><span class="text-sm truncate flex-1">${escapeHtml(r.item.title)}</span></div>`).join('');
             } catch(e) { console.error(e); }
        };

        async function searchWeb(query) {
            let limit = 5;
            if (state.mode === 'research') {
                limit = 15;
            } else if (state.mode === 'search') {
                limit = 20;
            }

            const encodedQuery = encodeURIComponent(query);
            const corsProxy = 'https://corsproxy.io/?'; 
            
            const fetchJson = async (url) => {
                const controller = new AbortController();
                const id = setTimeout(() => controller.abort(), 15000); 
                try {
                    const res = await fetch(url, { signal: controller.signal });
                    clearTimeout(id);
                    if (!res.ok) return null;
                    return await res.json();
                } catch(e) { return null; }
            };

            const querySearX = async (bang, site, sourceLabel) => {
                const instances = [
                    'https://searx.be', 
                    'https://search.mdosch.de',
                    'https://op.nx.is',
                    'https://searx.work' 
                ];
                
                let qParam = query;
                if(bang) qParam = `${bang} ${qParam}`;
                if(site) qParam = `${qParam} site:${site}`;
                
                const encodedQ = encodeURIComponent(qParam);

                for (const instance of instances) {
                    let url = `${instance}/search?q=${encodedQ}&format=json&language=en`; 
                    let data = await fetchJson(url);
                    if (!data) data = await fetchJson(`${corsProxy}${url}`); 
                    
                    if (data && data.results) {
                        return data.results.slice(0, limit).map(r => ({
                            title: r.title,
                            link: r.url,
                            snippet: r.content || r.title,
                            source: sourceLabel,
                            date: r.publishedDate ? new Date(r.publishedDate).toISOString().split('T')[0] : null
                        }));
                    }
                }
                return [];
            };

            const promises = [];
            const activeEngines = state.activeSearchEngines.length > 0 ? state.activeSearchEngines : ['google', 'wikipedia', 'reddit'];

            activeEngines.forEach(key => {
                const config = SEARCH_ENGINES_CONFIG[key];
                if (!config) return;

                if (config.type === 'api') {
                    if (key === 'wikipedia') {
                        promises.push(async () => {
                            const data = await fetchJson(`https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodedQuery}&limit=${limit}&namespace=0&format=json&origin=*`);
                            if (data && data[1]) {
                                return data[1].map((title, i) => ({ title, link: data[3][i], snippet: `Wikipedia: ${title}`, source: 'Wikipedia' }));
                            }
                            return [];
                        });
                    } else if (key === 'reddit') {
                        promises.push(async () => {
                            const data = await fetchJson(`https://www.reddit.com/search.json?q=${encodedQuery}&limit=${limit}&sort=relevance`);
                            if (data && data.data && data.data.children) {
                                return data.data.children.map(c => ({
                                    title: c.data.title,
                                    link: `https://www.reddit.com${c.data.permalink}`,
                                    snippet: c.data.selftext?.substring(0, 150) || `r/${c.data.subreddit}`,
                                    source: 'Reddit',
                                    date: new Date(c.data.created_utc * 1000).toISOString().split('T')[0]
                                }));
                            }
                            return [];
                        });
                    }
                } else if (config.type === 'searx') {
                    promises.push(() => querySearX(config.bang, config.site, config.name));
                }
            });

            const resultsNested = await Promise.all(promises.map(p => p().catch(e => [])));
            const flat = resultsNested.flat().filter(x => x && x.title && x.link);
            const unique = flat.filter((v,i,a) => a.findIndex(t => t.link === v.link) === i);
            
            state.lastSources = unique;
            return JSON.stringify(unique);
        }

        async function executeTool(cmd) {
            const firstColon = cmd.indexOf(':');
            const tool = cmd.substring(0, firstColon).trim();
            const arg = cmd.substring(firstColon + 1).trim();
            
            if(tool === 'SEARCH') {
                return `SEARCH RESULTS: ${await searchWeb(arg)}`;
            }
            if(tool === 'CALC') { try { return `CALC: ${eval(arg.replace(/[^-()\d/*+.]/g, ''))}`; } catch(e) { return "CALC ERROR"; } }
            if(tool === 'CODE') {
                if(!pyodide) return "PYTHON ERROR: Pyodide not loaded";
                try {
                    pyodide.runPython(`import sys\nfrom io import StringIO\nsys.stdout = StringIO()`);
                    await pyodide.runPythonAsync(arg);
                    const stdout = pyodide.runPython("sys.stdout.getvalue()");
                    return `CODE OUTPUT:\n${stdout}`;
                } catch(e) { return `CODE ERROR: ${e.message}`; }
            }
            if(tool === 'CREATE_FILE') {
                try {
                    const data = JSON.parse(arg);
                    if(data.type === 'pdf') {
                        if(!window.jspdf) return "PDF Lib missing";
                        const doc = new window.jspdf.jsPDF();
                        doc.text(doc.splitTextToSize(data.content, 180), 10, 10);
                        doc.save(`${data.filename || 'generated'}.pdf`);
                        return `File ${data.filename}.pdf created.`;
                    }
                    if(data.type === 'txt') {
                        saveAs(new Blob([data.content], {type: "text/plain"}), `${data.filename || 'generated'}.txt`);
                        return `File ${data.filename}.txt created.`;
                    }
                    if(data.type === 'xlsx' || data.type === 'excel') {
                        const wb = XLSX.utils.book_new();
                        const ws = XLSX.utils.aoa_to_sheet(Array.isArray(data.content) ? data.content : [[data.content]]);
                        XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                        XLSX.writeFile(wb, `${data.filename || 'generated'}.xlsx`);
                        return `File ${data.filename}.xlsx created.`;
                    }
                    if(data.type === 'pptx' || data.type === 'slides') {
                        const pres = new PptxGenJS();
                        const slides = Array.isArray(data.content) ? data.content : [data.content];
                        slides.forEach(txt => {
                            let slide = pres.addSlide();
                            slide.addText(txt, { x:1, y:1, w:'80%', fontSize:18 });
                        });
                        pres.writeFile({ fileName: `${data.filename || 'generated'}.pptx` });
                        return `File ${data.filename}.pptx created.`;
                    }
                    if(data.type === 'zip') {
                        const zip = new JSZip();
                        if(typeof data.content === 'object' && !Array.isArray(data.content)) {
                            Object.entries(data.content).forEach(([k,v]) => zip.file(k, v));
                        } else {
                            zip.file("content.txt", data.content);
                        }
                        zip.generateAsync({type:"blob"}).then(blob => saveAs(blob, `${data.filename || 'archive'}.zip`));
                        return `File ${data.filename}.zip created.`;
                    }
                    if(data.type === 'docx' || data.type === 'word') {
                         if(!window.docx) return "Docx lib missing";
                         const { Document, Packer, Paragraph, TextRun } = window.docx;
                         const doc = new Document({ sections: [{ children: [new Paragraph({ children: [new TextRun(data.content)] })] }] });
                         Packer.toBlob(doc).then(blob => saveAs(blob, `${data.filename || 'generated'}.docx`));
                         return `File ${data.filename}.docx created.`;
                    }
                } catch(e) { return `CREATE_FILE ERROR: ${e.message}`; }
            }
            return "UNKNOWN TOOL";
        }
        
        async function renderDiscovery() {
            const container = document.getElementById('discoveryFeed');
            if(!container || container.children.length > 0) return; 
            
            container.innerHTML = '<div class="col-span-full text-center text-xs text-[var(--text-secondary)]"><i class="fas fa-circle-notch animate-spin"></i> Discovering...</div>';
            
            try {
                const resultsJson = await searchWeb("latest technology news world");
                const results = JSON.parse(resultsJson);
                
                if(results && results.length > 0) {
                    container.innerHTML = results.slice(0, 8).map(item => `
                        <a href="${item.link}" target="_blank" class="discovery-card">
                            <div class="discovery-source">
                                <img src="https://www.google.com/s2/favicons?domain=${new URL(item.link).hostname}" class="w-3 h-3" onerror="this.style.display='none'">
                                <span>${item.source || new URL(item.link).hostname}</span>
                            </div>
                            <div class="discovery-title">${escapeHtml(item.title)}</div>
                            <div class="discovery-snippet">${escapeHtml(item.snippet)}</div>
                        </a>
                    `).join('');
                } else {
                    container.innerHTML = '<div class="col-span-full text-center text-xs text-[var(--text-secondary)]">No news found.</div>';
                }
            } catch(e) {
                container.innerHTML = '';
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            loadSettings(); loadChatHistory(); initTheme(); renderProviderCheckboxes(); renderApiKeyInputs(); updateUI(); renderPinned();
            document.addEventListener('keydown', e => {
               if(e.ctrlKey && e.key === 'Enter') sendMessage();
               if(e.ctrlKey && e.key === 'k') { e.preventDefault(); document.getElementById('historySearch').focus(); }
            });
            try { pyodide = await loadPyodide(); await pyodide.loadPackage("micropip"); } catch(e) { console.warn("Pyodide init failed", e); }
        });

        function loadSettings() {
            try { state.activeProviders = JSON.parse(localStorage.getItem('sahu_active_providers') || '["nvidia"]'); } catch(e){}
            const defaultModels = [
                {provider: 'nvidia', modelKey: 'Qwen 3.5 397B', modelId: 'qwen/qwen3.5-397b-a17b-instruct', stage: 'none'}, 
                {provider: 'nvidia', modelKey: 'MiniMax M2.5', modelId: 'minimaxai/minimax-m2.5', stage: 'none'}, 
                {provider: 'nvidia', modelKey: 'Kimi K2.5', modelId: 'moonshotai/kimi-k2.5', stage: 'none'},
                {provider: 'nvidia', modelKey: 'GLM 5', modelId: 'z-ai/glm5', stage: '1'},
                {provider: 'nvidia', modelKey: 'Kimi K2 Thinking', modelId: 'moonshotai/kimi-k2-thinking', stage: 'none'},
                {provider: 'nvidia', modelKey: 'GPT OSS 120B', modelId: 'openai/gpt-oss-120b', stage: 'none'},
                {provider: 'nvidia', modelKey: 'GLM 4.7', modelId: 'z-ai/glm4.7', stage: 'none'},
                {provider: 'nvidia', modelKey: 'MiniMax M2.1', modelId: 'minimaxai/minimax-m2.1', stage: 'none'}
            ];
            try { 
                const stored = localStorage.getItem('sahu_selected_models');
                state.selectedModels = (stored && JSON.parse(stored).length > 0) ? JSON.parse(stored) : defaultModels; 
            } catch(e){
                state.selectedModels = defaultModels;
            }
            state.autoFallback = localStorage.getItem('sahu_auto_fallback') !== 'false';
            state.neuralConsensus = localStorage.getItem('sahu2_neural_consensus') === 'true';
            state.debateMode = localStorage.getItem('sahu2_debate_mode') === 'true';
            state.temporalReasoning = localStorage.getItem('sahu2_temporal_reasoning') !== 'false'; // Default true
            state.adaptiveReasoning = localStorage.getItem('sahu2_adaptive_reasoning') !== 'false'; // Default true
            
            state.uncertaintyBadge = localStorage.getItem('sahu2_uncertainty_badge') !== 'false';
            state.tokenEstimator = localStorage.getItem('sahu2_token_estimator') !== 'false';
            state.responseRating = localStorage.getItem('sahu2_response_rating') !== 'false';
            state.threeTierMemory = localStorage.getItem('sahu2_three_tier_memory') !== 'false';
            state.selfCorrectingCode = localStorage.getItem('sahu2_self_correcting_code') !== 'false';
            state.usageAnalytics = localStorage.getItem('sahu2_usage_analytics') !== 'false';

            state.agentSwarm = localStorage.getItem('sahu_agent_swarm') === 'true';
            state.visionToCode = localStorage.getItem('sahu_vision_to_code') === 'true';
            state.collaborativeCanvas = localStorage.getItem('sahu_collaborative_canvas') === 'true';
            state.videoGeneration = localStorage.getItem('sahu_video_generation') === 'true';
            state.rapidLearning = localStorage.getItem('sahu_rapid_learning') === 'true';
            state.browserAgent = localStorage.getItem('sahu_browser_agent') === 'true';
            state.voiceCloning = localStorage.getItem('sahu_voice_cloning') === 'true';
            state.tokenContext = localStorage.getItem('sahu_token_context') === 'true';
            state.gemsMarketplace = localStorage.getItem('sahu_gems_marketplace') === 'true';
            state.physicalIntegration = localStorage.getItem('sahu_physical_integration') === 'true';
            state.constitutionalSafety = localStorage.getItem('sahu_constitutional_safety') === 'true';

            state.shieldGemmaEnabled = localStorage.getItem('sahu_shield_gemma') === 'true';
            try { state.customInstructions = JSON.parse(localStorage.getItem('sahu2_custom_instructions') || '{"user":"","resp":""}'); } catch(e){}
            try { state.pinnedMessages = JSON.parse(localStorage.getItem('sahu2_pinned') || '[]'); } catch(e){}
            try { 
                const storedEngines = localStorage.getItem('sahu_search_engines');
                state.activeSearchEngines = storedEngines ? JSON.parse(storedEngines) : Object.keys(SEARCH_ENGINES_CONFIG);
            } catch(e){ 
                state.activeSearchEngines = Object.keys(SEARCH_ENGINES_CONFIG); 
            }
            state.temperature = parseFloat(localStorage.getItem('sahu2_temp') || '0.7');
            state.maxTokens = parseInt(localStorage.getItem('sahu2_max_tokens') || '8000');
            state.selfConsistency = localStorage.getItem('sahu2_self_consistency') === 'true';
            state.thinkingBudget = localStorage.getItem('sahu2_thinking_budget') || 'balanced';
            state.aggregationStyle = localStorage.getItem('sahu2_aggregation_style') || 'synthesis';
            try {
                const storedConfig = JSON.parse(localStorage.getItem('sahu2_research_config') || '{}');
                state.researchConfig = { ...RESEARCH_DEFAULTS, ...storedConfig };
            } catch(e) { state.researchConfig = RESEARCH_DEFAULTS; }
            state.language = localStorage.getItem('sahu_language') || 'en';
            updateLanguage(state.language);
        }

        function initTheme() {
            state.theme = localStorage.getItem('sahu_theme') || 'light';
            if(state.theme === 'dark') { document.body.classList.add('dark-mode'); document.getElementById('themeIcon').className = 'fas fa-sun'; document.getElementById('themeText').textContent = 'Light Mode'; }
        }

        function renderProviderCheckboxes() {
            const container = document.getElementById('providerCheckboxes');
            if(!container) return;
            container.innerHTML = Object.entries(PROVIDERS).map(([k, p]) => `
                <label class="flex items-center gap-2 p-3 rounded-xl bg-[var(--bg-tertiary)] cursor-pointer hover:bg-[var(--border)] transition-colors border border-transparent ${state.activeProviders.includes(k) ? 'border-[var(--accent)] bg-opacity-50' : ''}">
                    <input type="checkbox" class="w-5 h-5 accent-[var(--accent)]" ${state.activeProviders.includes(k) ? 'checked' : ''} onchange="toggleProvider('${k}', this.checked)">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 font-medium text-sm"><span>${p.icon}</span> ${p.name}</div>
                    </div>
                </label>`).join('');
        }

        function renderApiKeyInputs() {
            const c = document.getElementById('apiKeyInputs');
            if(!c) return;
            c.innerHTML = Object.entries(PROVIDERS).map(([k, p]) => `
                <div class="p-2 bg-[var(--bg-secondary)] rounded-lg border border-[var(--border)]">
                    <div class="flex items-center gap-2 mb-1"><span class="text-sm">${p.icon} ${p.name}</span></div>
                    <input type="password" id="key_${k}" placeholder="Enter API Key" class="w-full p-2 rounded bg-[var(--bg-primary)] border border-[var(--border)] text-xs focus:border-[var(--accent)] outline-none">
                </div>`).join('');
            Object.keys(PROVIDERS).forEach(k => { const v = localStorage.getItem(PROVIDERS[k].keyName); if(v) document.getElementById(`key_${k}`).value = v; });
        }
        
        function renderLanguageSelector() {
            const sel = document.getElementById('languageSelector');
            if(!sel) return;
            sel.innerHTML = LANGUAGES.map(l => `<option value="${l.code}" ${state.language === l.code ? 'selected' : ''}>${l.name}</option>`).join('');
        }

        function updateLanguage(langCode) {
            state.language = langCode;
            const t = UI_TRANSLATIONS[langCode];
            const setTxt = (id, key, def) => { const el = document.getElementById(id); if(el) el.innerHTML = (t && t[key]) ? (t[key].includes('<') ? t[key] : (el.innerHTML.includes('<i') ? el.innerHTML.replace(/<\/i>\s*(.*)/, `</i> ${t[key]}`) : t[key])) : el.innerHTML.replace(/<\/i>\s*(.*)/, `</i> ${def || el.innerText.trim()}`); };
            const setAttr = (id, attr, key) => { const el = document.getElementById(id); if(el && t && t[key]) el.setAttribute(attr, t[key]); };

            if(t) {
                const nc = document.getElementById('btn-new-chat'); if(nc) nc.innerHTML = `<i class="fas fa-plus"></i> ${t.newChat || 'New Chat'}`;
                const inst = document.getElementById('btn-install'); if(inst) inst.innerHTML = `<i class="fab fa-android text-green-600"></i><span>${t.install || 'Install Android App'}</span>`;
                const sets = document.getElementById('btn-settings'); if(sets) sets.innerHTML = `<i class="fas fa-cog text-[var(--text-secondary)]"></i><span class="text-sm">${t.settings || 'Settings'}</span>`;
                const conf = document.getElementById('btn-config-models'); if(conf) conf.innerHTML = `<span class="flex items-center gap-2"><i class="fas fa-cubes text-[var(--accent)]"></i>${t.config || 'Configure Models'}</span><span id="selectedModelCount" class="text-xs bg-[var(--accent)] text-white px-2 py-0.5 rounded-full">${state.selectedModels.length}</span>`;
            } else {
                if(langCode === 'en') {
                   const nc = document.getElementById('btn-new-chat'); if(nc) nc.innerHTML = `<i class="fas fa-plus"></i> New Chat`;
                }
            }
        }

        function renderModelSelector() {
            const c = document.getElementById('modelSelectorContent');
            let h = '';
            state.activeProviders.forEach(pk => {
                const p = PROVIDERS[pk];
                h += `<div class="border border-[var(--border)] rounded-xl overflow-hidden"><div class="bg-[var(--bg-tertiary)] p-3 flex items-center justify-between"><div class="flex items-center gap-2"><span>${p.icon}</span><span class="font-semibold text-sm">${p.name}</span><span class="text-xs text-[var(--text-secondary)]">(${Object.keys(p.models).length})</span></div><button onclick="toggleAllModels('${pk}')" class="text-xs px-2 py-1 bg-[var(--bg-secondary)] border border-[var(--border)] rounded hover:bg-[var(--accent)] hover:text-white transition-colors">All/None</button></div><div class="p-3 grid grid-cols-1 gap-2">${Object.entries(p.models).map(([mk, mid]) => {
                    const ex = state.selectedModels.find(m => m.provider === pk && m.modelKey === mk);
                    const s = ex?.stage || 'none';
                    return `<div class="model-card ${ex ? 'selected' : ''}"><input type="checkbox" class="w-4 h-4 accent-[var(--accent)]" ${ex ? 'checked' : ''} onchange="toggleModelSelection('${pk}', '${mk}', '${mid}', this.checked)"><div class="flex-1 min-w-0"><div class="text-sm font-medium truncate">${mk}</div></div><div class="flex gap-1"><button class="stage-btn ${s==='1'?'active-1':''}" onclick="setModelStage('${pk}','${mk}','${mid}','1',event)">1</button><button class="stage-btn ${s==='2'?'active-2':''}" onclick="setModelStage('${pk}','${mk}','${mid}','2',event)">2</button><button class="stage-btn ${s==='3'?'active-3':''}" onclick="setModelStage('${pk}','${mk}','${mid}','3',event)">3</button></div></div>`;
                }).join('')}</div></div>`;
            });
            c.innerHTML = h || '<div class="text-center py-8 text-[var(--text-secondary)]">Select a provider.</div>';
            document.getElementById('modalSelectedCount').textContent = state.selectedModels.length;
        }

        function updateUI() { document.getElementById('selectedModelCount').textContent = state.selectedModels.length; updateTokenCounter(); }
        function loadChatHistory() { const s = localStorage.getItem('sahu_chat_history'); if(s) { state.chatHistory = JSON.parse(s); renderChatHistory(); } }
        function renderChatHistory() { document.getElementById('chatHistory').innerHTML = state.chatHistory.slice(0, 10).map(c => `<div onclick="loadChat('${c.id}')" class="p-3 rounded-xl hover:bg-[var(--bg-tertiary)] cursor-pointer flex items-center gap-3 active:scale-98"><i class="fas fa-message text-[var(--text-secondary)]"></i><span class="text-sm truncate flex-1">${escapeHtml(c.title)}</span></div>`).join(''); }
        
        function showToast(msg, type='success') { const t = document.createElement('div'); t.className = `toast ${type==='error'?'bg-red-500':'bg-green-500'}`; t.innerHTML = `<i class="fas fa-${type==='error'?'exclamation-circle':'check-circle'}"></i><span>${msg}</span>`; document.body.appendChild(t); setTimeout(() => t.remove(), 3000); }
        function escapeHtml(t) { 
            if(t === null || t === undefined) return '';
            const d = document.createElement('div'); 
            d.textContent = t; 
            return d.innerHTML; 
        }

        function renderPinned() {
             const c = document.getElementById('pinnedList');
             const s = document.getElementById('pinnedSection');
             if(state.pinnedMessages.length === 0) { s.classList.add('hidden'); return; }
             s.classList.remove('hidden');
             c.innerHTML = state.pinnedMessages.map((msg, i) => `<div class="p-2 bg-[var(--bg-tertiary)] rounded-lg text-xs truncate cursor-pointer" onclick="showToast('Jump to message')"><i class="fas fa-thumbtack text-yellow-500 mr-2"></i>${escapeHtml(msg.substring(0, 30))}...</div>`).join('');
        }
        window.togglePin = (txt) => {
            const idx = state.pinnedMessages.indexOf(txt);
            if(idx > -1) state.pinnedMessages.splice(idx, 1);
            else state.pinnedMessages.push(txt);
            localStorage.setItem('sahu2_pinned', JSON.stringify(state.pinnedMessages));
            renderPinned();
        };

        function updateTokenCounter() {
            state.totalTokens = Math.ceil((window.lastAnswer?.length || 0) / 4);
            document.getElementById('totalTokensVal').textContent = state.totalTokens > 1000 ? (state.totalTokens/1000).toFixed(1)+'k' : state.totalTokens;
        }

        window.openArtifact = (code, type) => {
            const modal = document.getElementById('artifactModal');
            const codeArea = document.getElementById('canvas-code-area');
            const frame = document.getElementById('canvas-frame');
            
            state.currentArtifact = { code, type };
            codeArea.value = code;
            
            if(type === 'html' || type === 'svg') {
                frame.srcdoc = code;
                switchCanvasTab('preview');
            } else {
                switchCanvasTab('code'); 
                frame.srcdoc = `<html><body style="font-family:sans-serif;padding:20px;color:#666;">No preview available for ${type.toUpperCase()}.<br>View code in 'Code' tab.<script type="module" src="/index.tsx"><\/script>
</body></html>`;
            }
            
            modal.classList.remove('hidden');
        };

        window.closeArtifact = () => {
            document.getElementById('artifactModal').classList.add('hidden');
        };

        window.switchCanvasTab = (tab) => {
            document.getElementById('tab-code').classList.toggle('active', tab === 'code');
            document.getElementById('tab-preview').classList.toggle('active', tab === 'preview');
            document.getElementById('canvas-editor').classList.toggle('active', tab === 'code');
            document.getElementById('canvas-preview').classList.toggle('active', tab === 'preview');
            
            if(tab === 'preview' && (state.currentArtifact.type === 'html' || state.currentArtifact.type === 'svg')) {
                const code = document.getElementById('canvas-code-area').value; 
                document.getElementById('canvas-frame').srcdoc = code;
            }
        };

        async function callModelWithFallback(providerKey, modelId, messages, retryCount = 0, onToken = null) {
            const provider = PROVIDERS[providerKey];
            let apiKey = localStorage.getItem(provider.keyName);
            
            if (providerKey === 'nvidia' && !apiKey) {
                apiKey = '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';
            }

            if (!apiKey) throw new Error(`No API key for ${provider.name}`);
            
            let useRealStreaming = true;
            if (providerKey !== 'nvidia' && providerKey !== 'gemini') {
                useRealStreaming = false;
            }

            const headers = { 'Content-Type': 'application/json' };
            if (providerKey === 'gemini') {
                headers['Authorization'] = `Bearer ${apiKey}`; 
            } else {
                headers['Authorization'] = `Bearer ${apiKey}`;
            }

            if (providerKey === 'openrouter') { headers['HTTP-Referer'] = window.location.href; headers['X-Title'] = 'SAHU 2.0'; }
            
            let finalMessages = JSON.parse(JSON.stringify(messages)); 
            const modelConfig = MODEL_CONFIGS[modelId] || {};
            
            let modelHumanName = modelId;
            if(provider.models) {
                const entry = Object.entries(provider.models).find(([key, val]) => val === modelId);
                if(entry) modelHumanName = entry[0];
            }

            let sysPrompt = `User Info: ${state.customInstructions.user}\nResponse Style: ${state.customInstructions.resp}`;
            sysPrompt += `\nIDENTITY INSTRUCTION: You are ${modelHumanName}. If asked about your identity, state your original name (${modelHumanName}) and your original creator company. Then, ALWAYS add 'Hosted by Saksham Intelligence'. Do not claim to be created by Saksham Intelligence, only hosted by them.`;
            
            const selectedLang = LANGUAGES.find(l => l.code === state.language)?.name || 'English';
            sysPrompt += `\nLANGUAGE INSTRUCTION: You must respond in ${selectedLang} language.`;

            if (state.neuralConsensus) {
                sysPrompt += `\n\n========================================\nSPECIFIC FEATURES ENABLED\n========================================\n`;
                
                if (state.uncertaintyBadge) {
                    sysPrompt += `1. UNCERTAINTY QUANTIFICATION: For every major claim or answer, append a confidence score in brackets like [Confidence: 85%]. If uncertain, state why.\n`;
                }
                
                if (state.temporalReasoning) {
                    sysPrompt += `2. TEMPORAL REASONING: The current date is ${new Date().toISOString().split('T')[0]}. Compare this timestamp against the query. If the user asks for data that might be outdated or if there is a time gap, add a warning at the end like this:\n[FRESHNESS_WARNING] Your warning here.\n3. TIMELINE EXTRACTION: If the answer involves a sequence of historical events or future plans, output a structured timeline at the very end (after follow-ups) in this format:\n[TIMELINE_START]\n[{"date": "YYYY-MM-DD or Text", "event": "Description"}, ...]\n[TIMELINE_END]\n`;
                }

                if (state.adaptiveReasoning) {
                    sysPrompt += `4. ADAPTIVE REASONING: Analyze the complexity of the user's query. If it requires multi-step logic, explicitly break it down into steps before answering.\n`;
                }

                sysPrompt += `5. PREDICTIVE REASONING: At the very end of your response, generate exactly 3 likely follow-up questions the user might ask, and provide a brief answer for each. Format them exactly like this:\n[FOLLOWUP_Q] Question 1\n[FOLLOWUP_A] Answer 1\n[FOLLOWUP_Q] Question 2\n[FOLLOWUP_A] Answer 2\n[FOLLOWUP_Q] Question 3\n[FOLLOWUP_A] Answer 3\n`;
            }

            const deepThinkActive = state.deepThinkEnabled; 
            if (deepThinkActive) {
                const budget = state.thinkingBudget; 
                
                if (budget !== 'original') {
                    const deepThinkPrompt = `
\n\n========================================
You are operating in DeepThink Mode.
All reasoning must be shown explicitly.
Do not hide intermediate steps.

========================================
USER SETTINGS
========================================
THINKING_BUDGET = ${budget.toUpperCase()}

Complexity:
- fast  medium reasoning
- balanced  high reasoning
- ultra  x-high reasoning

========================================
DEEPTHINK PROCESS
========================================
STEP 1  Clarify the Problem
- Restate clearly
- Identify constraints

STEP 2  Decompose
- Break into logical components
- Identify dependencies

STEP 3  Multi-Path Reasoning
- Explore multiple solution paths
- Compare strengths and weaknesses

STEP 4  Assumption Analysis
- List assumptions
- Test whether they hold

STEP 5  Counter-Argument
- Attempt to disprove your reasoning
- Stress-test logic

STEP 6  Edge Case Examination
- Identify extreme or boundary cases
- Test solution stability

STEP 7  Final Synthesis
- Rebuild strongest logical answer

========================================
MODE BEHAVIOR
========================================
${THINKING_TEMPLATES[budget]}

========================================
OUTPUT FORMAT
========================================
1. Problem Restatement
2. Step-by-Step Reasoning
3. Alternative Path(s)
4. Critical Evaluation
5. Final Answer
${budget === 'ultra' ? 'If ULTRA:\n6. Confidence Score\n7. Remaining DOUBTS' : ''}

CRITICAL INSTRUCTION: Output your internal monologue enclosed in <think> tags based on the process above. Then provide the final response.
`;
                    sysPrompt += deepThinkPrompt;
                }
            }

            let dynamicMaxTokens = 9000;
            if (state.mode === 'task' || state.mode === 'research' || state.mode === 'search') {
                dynamicMaxTokens = 30000;
                sysPrompt += "\nMODE: HIGH CAPACITY. Generating extended output.";
            }

            if(modelConfig.max_tokens) {
                 dynamicMaxTokens = modelConfig.max_tokens;
            }

            if(state.mode === 'task') {
                if(state.taskType === 'vibe') {
                     sysPrompt += "\nMODE: TASK/CODE (VIBE CODE). Protocol: 1. PLAN (Think) 2. GENERATE FULL CODE (HTML/CSS/JS in one block or React) 3. EXPLAIN. Focus on modern aesthetics, responsiveness, and robustness. Use ```html for HTML/JS/CSS combos to trigger preview.";
                } else if(state.taskType === 'agentic') {
                     sysPrompt += "\nMODE: TASK/CODE (AGENTIC CODE). Protocol: AUTONOMOUS. Build complete, self-contained solutions. No placeholders. Self-correct if needed. Use ```html for UI components.";
                } else if(state.taskType === 'file_creation') {
                     sysPrompt += "\nMODE: FILE CREATION. You are a tool-using agent capable of creating files. To create a file, you MUST output a tool call block like this: `CREATE_FILE: {\"type\": \"pdf|xlsx|pptx|txt|docx|zip\", \"filename\": \"name\", \"content\": \"...\"}`. For Excel/PPTX, provide array data. For Zip, provide object of filenames. Wait for user confirmation.";
                }
            } else if (state.mode === 'research') {
                sysPrompt += "\nMODE: DEEP RESEARCH. Protocol: Analyze provided search results deeply. Synthesize multiple sources. Be exhaustive and detailed.";
            } else if (state.mode === 'search') {
                sysPrompt += "\nMODE: SAHUAI SEARCH (Perplexity Style). Answer concisely but comprehensively based on the provided search results. You MUST cite sources using [1], [2] notation inline with the text where the information is used. Do NOT create a separate reference list at the end, just use inline citations.";
            } else {
                sysPrompt += "\nMODE: STANDARD. Use available search results to answer accurately. Cite sources if used.";
            }

            if(state.uploadedFileContent && finalMessages[0].role !== 'system') {
                 sysPrompt += `\n\n[ATTACHED FILE CONTENT]:\n${state.uploadedFileContent}\n[END FILE CONTENT]\nAnalyze this file context if relevant.`;
            }

            const lastUserMsg = finalMessages[finalMessages.length - 1];
            if(lastUserMsg.role === 'user' && lastUserMsg.content.includes('[MANDATORY WEB SEARCH CONTEXT]')) {
                 const splitContent = lastUserMsg.content.split('[MANDATORY WEB SEARCH CONTEXT]:');
                 if(splitContent.length > 1) {
                     const searchData = splitContent[1].split('[END CONTEXT]')[0];
                     sysPrompt += `\n\n=== MANDATORY SEARCH RESULTS (${new Date().toISOString().split('T')[0]}) ===\n${searchData}\n=== END SEARCH RESULTS ===\nINSTRUCTION: You MUST use the search results above to answer. Cite specific sources. If the answer is not in the results, state that. Do NOT ignore this data.`;
                     lastUserMsg.content = splitContent[0].trim(); 
                 }
            }

            if(finalMessages[0].role === 'system' && !modelConfig.noSystemRole) {
                finalMessages[0].content += `\n${sysPrompt}`;
            } else if (!modelConfig.noSystemRole && finalMessages[0].role !== 'system') {
                 finalMessages.unshift({ role: 'system', content: sysPrompt });
            }

            // Token Estimator Logic
            if (state.tokenEstimator) {
                const estimatedInputTokens = Math.ceil(fullPrompt.length / 4);
                const costEstimate = (estimatedInputTokens / 1000) * 0.0001; // Rough estimate
                showToast(`Sending ~${estimatedInputTokens} tokens ($${costEstimate.toFixed(5)})`);
            }

            let requestBody = { 
                model: modelId, 
                messages: finalMessages, 
                max_tokens: dynamicMaxTokens, 
                temperature: state.temperature, 
                stream: !modelConfig.noStream && useRealStreaming 
            };
            if (providerKey === 'mistral') requestBody = { agent_id: modelId, messages: finalMessages };
            if (providerKey === 'nvidia') { requestBody.temperature = state.temperature; requestBody.top_p = 0.95; }
            
            let url = provider.endpoint;
            if (providerKey === 'nvidia') {
               if (modelId === 'nvidia/cosmos-reason2-8b') {
                   url = 'https://thingproxy.freeboard.io/fetch/' + provider.endpoint;
               } else {
                   url = 'https://thingproxy.freeboard.io/fetch/' + provider.endpoint;
               }
            }
            if (providerKey === 'ollama') url = 'https://thingproxy.freeboard.io/fetch/' + provider.endpoint;
            
            const controller = new AbortController();
            const startTime = Date.now(); 
            let currentTokenCount = 0; 

            try {
                const response = await fetch(url, { 
                    method: 'POST', 
                    headers, 
                    body: JSON.stringify(requestBody), 
                    signal: controller.signal 
                });
                
                if (!response.ok) throw new Error(`${response.status}: ${await response.text()}`);
                
                const updateMetrics = () => {
                    const elapsed = (Date.now() - startTime) / 1000;
                    const speed = elapsed > 0 ? (currentTokenCount / elapsed).toFixed(1) : 0;
                    const timeStr = 60 > elapsed ? elapsed.toFixed(1) + 's' : (elapsed/60).toFixed(1) + 'm';
                    
                    document.getElementById('metricTime').textContent = timeStr;
                    document.getElementById('metricSpeed').textContent = speed + ' t/s';
                    document.getElementById('metricTotal').textContent = currentTokenCount + ' tok';
                };

                if (response.body && requestBody.stream) {
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder("utf-8");
                    let fullText = "";
                    let thinkingText = "";
                    
                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        
                        const chunk = decoder.decode(value, { stream: true });
                        const lines = chunk.split('\n');
                        for (const line of lines) {
                            if (line.trim().startsWith('data: ')) {
                                const jsonStr = line.replace('data: ', '').trim();
                                if (jsonStr === '[DONE]') break;
                                try {
                                    const json = JSON.parse(jsonStr);
                                    const contentChunk = json.choices?.[0]?.delta?.content || "";
                                    const thinkingChunk = json.choices?.[0]?.delta?.reasoning_content || "";
                                    
                                    fullText += contentChunk;
                                    thinkingText += thinkingChunk;
                                    
                                    if (contentChunk || thinkingChunk) {
                                        currentTokenCount++; 
                                        updateMetrics();
                                    }
                                    
                                    if(onToken) onToken(fullText, thinkingText, contentChunk);
                                } catch (e) {}
                            }
                        }
                    }
                    return { content: fullText, thinking: thinkingText, provider: providerKey };
                } else {
                    const data = await response.json();
                    let content = data.choices?.[0]?.message?.content || '';
                    let thinking = data.choices?.[0]?.message?.reasoning_content || '';

                    const thinkMatch = content.match(new RegExp('\\x3Cthink>([\\s\\S]*?)\\x3C\\/think>'));
                    if (thinkMatch) {
                        thinking = thinkMatch[1];
                        content = content.replace(new RegExp('\\x3Cthink>[\\s\\S]*?\\x3C\\/think>'), '').trim();
                    }

                    if (onToken && content) {
                        if(thinking) onToken("", thinking, ""); 
                        
                        const chunks = content.split(/(\s+)/); 
                        let currentAcc = "";
                        
                        for(const chunk of chunks) {
                            currentAcc += chunk;
                            onToken(currentAcc, thinking, chunk);
                            currentTokenCount++;
                            updateMetrics();
                            await new Promise(r => setTimeout(r, 2));
                        }
                    }

                    // Response Rating Logic
                    if (state.responseRating) {
                        // This would ideally be appended to the message UI, but for now we just log it or handle it in the UI rendering part
                        // We'll add a property to the returned object so the UI renderer knows to show rating buttons
                    }

                    return { content, thinking, provider: providerKey, showRating: state.responseRating };
                }
            } catch (error) {
                 if (state.autoFallback && 1 > retryCount) {
                    const fallback = state.activeProviders.find(p => p !== providerKey && localStorage.getItem(PROVIDERS[p].keyName));
                    if (fallback) return { ...await callModelWithFallback(fallback, Object.values(PROVIDERS[fallback].models)[0], messages, retryCount + 1, onToken), fallback: true };
                 }
                 throw error;
            }
        }

        window.runDebatePipeline = async (prompt, container, chatId) => {
            container.innerHTML += `<div class="mb-4 text-center text-purple-500 font-bold animate-pulse"><i class="fas fa-balance-scale"></i> Initializing Multi-Perspective Debate...</div>`;
            
            const activeModels = state.selectedModels.filter(m => state.activeProviders.includes(m.provider));
            if (activeModels.length === 0) {
                container.innerHTML += `<div class="text-red-500">Error: At least 1 model required for debate.</div>`;
                return;
            }

            // Assign roles
            const roles = ['PRO', 'CON', 'NEUTRAL'];
            const debateRounds = [];
            
            // Use up to 3 models, cycle if fewer
            const debaters = roles.map((role, i) => {
                const model = activeModels[i % activeModels.length];
                return { role, model };
            });

            const debateId = `debate-${Date.now()}`;
            container.innerHTML += `<div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4" id="${debateId}"></div>`;
            const debateGrid = document.getElementById(debateId);

            const debateResults = [];

            await Promise.all(debaters.map(async (debater, idx) => {
                if(state.currentChatId !== chatId) return;
                
                const divId = `debater-${idx}`;
                debateGrid.innerHTML += `
                <div class="expert-card thinking rounded-xl p-3" id="${divId}">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-xs font-bold px-2 py-1 rounded ${debater.role === 'PRO' ? 'bg-green-100 text-green-700' : debater.role === 'CON' ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-700'}">${debater.role}</span>
                        <div class="flex-1 min-w-0"><div class="font-medium text-xs truncate">${debater.model.modelKey}</div></div>
                    </div>
                    <div class="text-xs text-gray-500 font-mono whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar" id="stream-${divId}"></div>
                </div>`;

                const rolePrompt = `You are a debater in a formal debate.
TOPIC: ${prompt}
YOUR ROLE: ${debater.role} (Argue ${debater.role === 'PRO' ? 'IN FAVOR OF' : debater.role === 'CON' ? 'AGAINST' : 'NEUTRALLY/OBJECTIVELY about'} the topic).
INSTRUCTIONS: Provide strong arguments, evidence, and reasoning supporting your position. Be persuasive but factual.`;

                const onToken = (text, thinking, chunk) => {
                     if(state.currentChatId !== chatId) return;
                     const el = document.getElementById(`stream-${divId}`);
                     if(el) { el.textContent += chunk; el.scrollTop = el.scrollHeight; }
                };

                try {
                    const res = await callModelWithFallback(debater.model.provider, debater.model.modelId, [{ role: 'user', content: rolePrompt }], 0, onToken);
                    debateResults.push({ role: debater.role, content: res.content, model: debater.model.modelKey });
                    
                    const card = document.getElementById(divId);
                    if(card) {
                        card.className = "expert-card complete rounded-xl p-3";
                        // Keep content
                    }
                } catch(e) {
                    const card = document.getElementById(divId);
                    if(card) card.innerHTML += `<div class="text-red-500 text-xs">Failed: ${e.message}</div>`;
                }
            }));

            if(state.currentChatId !== chatId) return;

            // Synthesis
            container.innerHTML += `<div class="p-3 mb-2 rounded-xl bg-[var(--bg-tertiary)] text-xs border border-dashed border-[var(--accent)]"><i class="fas fa-brain animate-spin mr-2"></i>Synthesizing Debate...</div>`;
            
            const synthesisPrompt = `
            Analyze the following debate arguments:
            
            ${debateResults.map(r => `[${r.role} - ${r.model}]:\n${r.content}`).join('\n\n')}
            
            TASK: Produce a Multi-Perspective Debate Synthesis.
            1. Areas of Agreement: Where do all sides align?
            2. Key Disagreements: What are the fundamental conflicts?
            3. Evidence Gaps: What data is missing?
            4. Balanced Conclusion: A synthesized view.
            `;

            const aggModel = activeModels[0];
            const aggRes = await callModelWithFallback(aggModel.provider, aggModel.modelId, [{ role: 'user', content: synthesisPrompt }]);
            
            container.innerHTML += `
            <div class="aggregator-response rounded-2xl p-4 mt-4 border-2 border-purple-500">
                <div class="font-bold text-lg mb-2 text-purple-600">Debate Synthesis</div>
                <div class="prose max-w-none text-sm">${formatMarkdown(aggRes.content)}</div>
            </div>`;
            
            window.lastAnswer = aggRes.content;
            state.messages.push({ role: 'assistant', content: aggRes.content });
            localStorage.setItem('sahu_chat_history', JSON.stringify(state.chatHistory));
        };

        window.toggleResearchStage = (id) => {
            const el = document.getElementById(id);
            if(el) el.classList.toggle('open');
        };

        window.runDeepResearch = async (originalContent, container, chatId) => {
            let aggregationContext = "";
            let stageOutputs = [];
            
            container.innerHTML += `<div class="mb-4 text-center text-[var(--accent)] font-bold animate-pulse"><i class="fas fa-microscope"></i> Initializing Deep Research Pipeline...</div>`;
            
            const getDefaultModel = () => {
                if(state.selectedModels.length > 0) return state.selectedModels[0];
                return {provider: 'nvidia', modelId: 'minimaxai/minimax-m2.5'};
            }

            const activeModels = state.selectedModels.filter(m => state.activeProviders.includes(m.provider));
            
            if(activeModels.length > 0) {
                const phase0Id = `phase-0-${Date.now()}`;
                container.innerHTML += `
                <div class="research-stage active" id="${phase0Id}">
                    <div class="research-header" onclick="toggleResearchStage('${phase0Id}')">
                        <span class="flex items-center gap-2">
                            <i class="fas fa-users text-blue-500"></i> 
                            Phase 0: Initial Consensus (${activeModels.length} Models)
                        </span>
                        <span class="text-[10px] bg-[var(--bg-tertiary)] px-2 py-1 rounded">Mass Generation</span>
                    </div>
                    <div class="research-content" id="content-${phase0Id}" style="display:block;">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="grid-${phase0Id}"></div>
                    </div>
                </div>`;
                
                const phase0Grid = document.getElementById(`grid-${phase0Id}`);
                const phase0Results = [];

                await Promise.all(activeModels.map(async (model, idx) => {
                    if(state.currentChatId !== chatId) return;
                    
                    const divId = `p0-${idx}`;
                    phase0Grid.innerHTML += `
                    <div class="expert-card thinking rounded-xl p-3 mb-2" id="${divId}">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-xl">${PROVIDERS[model.provider].icon}</span>
                            <div class="flex-1 min-w-0">
                                <div class="font-medium text-sm truncate">${model.modelKey}</div>
                                <div class="text-[10px] text-[var(--text-secondary)]">${PROVIDERS[model.provider].name}</div>
                            </div>
                            <div class="typing-indicator flex gap-1">
                                <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                            </div>
                        </div>
                        <div class="text-xs text-[var(--text-secondary)] mb-1" id="status-${divId}">Thinking...</div>
                        <div class="text-xs text-gray-500 font-mono whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar" id="stream-${divId}"></div>
                    </div>`;
                    
                    try {
                        const onPhase0Token = (text, thinking, chunk) => {
                            if(state.currentChatId !== chatId) return;
                            const el = document.getElementById(`stream-${divId}`);
                            if(el) { el.textContent += chunk; el.scrollTop = el.scrollHeight; }
                            const st = document.getElementById(`status-${divId}`);
                            if(st) st.textContent = thinking ? "Thinking..." : "Generating...";
                        };

                        const res = await callModelWithFallback(model.provider, model.modelId, [{ role: 'user', content: originalContent }], 0, onPhase0Token);
                        if(state.currentChatId !== chatId) return;
                        
                        phase0Results.push(res.content);
                        
                        const card = document.getElementById(divId);
                        if(card) {
                            card.className = "expert-card complete rounded-xl p-3 mb-2";
                            card.innerHTML = `
                                <div class="flex items-center gap-2 mb-2">
                                    <span>${PROVIDERS[model.provider].icon}</span>
                                    <div class="flex-1 min-w-0">
                                        <div class="font-medium text-sm truncate">${model.modelKey}</div>
                                        <div class="text-[10px] text-[var(--text-secondary)]">${PROVIDERS[model.provider].name}</div>
                                    </div>
                                    <i class="fas fa-check-circle text-green-500"></i>
                                </div>
                                ${res.thinking ? `<div class="thinking-block"><div class="thinking-header"><i class="fas fa-brain"></i> Thinking Process</div><div class="text-[var(--text-secondary)] text-xs whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar">${escapeHtml(res.thinking)}</div></div>` : ''}
                                <div class="text-sm max-h-64 overflow-y-auto">${formatMarkdown(res.content)}</div>
                            `;
                        }
                    } catch(e) {
                        const card = document.getElementById(divId);
                        if(card) {
                            card.className = "expert-card error rounded-xl p-3 mb-2";
                            card.innerHTML = `<div class="font-bold text-[10px] text-red-500">${model.modelKey} (Failed: ${e.message})</div>`;
                        }
                    }
                }));
                
                if(phase0Results.length > 0) {
                    aggregationContext = "Initial Insights from " + activeModels.length + " models:\n" + phase0Results.slice(0, 3).join('\n---\n') + "\n...";
                }
            }

            for (const stage of RESEARCH_STAGES) {
                if(state.currentChatId !== chatId) return; 

                const stageId = `res-stage-${stage.id}-${Date.now()}`;
                const contentId = `res-content-${stageId}`;
                
                container.innerHTML += `
                <div class="research-stage active" id="${stageId}">
                    <div class="research-header" onclick="toggleResearchStage('${stageId}')">
                        <span class="flex items-center gap-2">
                            <i class="fas fa-circle-notch animate-spin text-[var(--accent)]" id="spin-${stageId}"></i> 
                            ${stage.name}
                        </span>
                        <span class="text-[10px] bg-[var(--bg-tertiary)] px-2 py-1 rounded">${stage.id === 'stage5' ? 'Super Master' : '5 Experts'}</span>
                    </div>
                    <div class="research-content" id="${contentId}" style="display:block;">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="experts-${stageId}"></div>
                    </div>
                </div>`;
                container.scrollTop = container.scrollHeight;

                const stageResults = [];
                const expertsContainer = document.getElementById(`experts-${stageId}`);

                if (stage.id !== 'stage5') {
                    await Promise.all(stage.experts.map(async (expertRole, idx) => {
                        if(state.currentChatId !== chatId) return;
                        
                        let expertModel = getDefaultModel();
                        const configVal = state.researchConfig[`${stage.id}_${idx}`];
                        if(configVal) {
                            const [p, m] = configVal.split('|');
                            expertModel = { provider: p, modelId: m, modelKey: m };
                        }

                        const expertDivId = `exp-${stageId}-${idx}`;
                        expertsContainer.innerHTML += `
                        <div class="expert-card thinking rounded-xl p-3 mb-2" id="${expertDivId}">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-xl">${PROVIDERS[expertModel.provider].icon}</span>
                                <div class="flex-1 min-w-0">
                                    <div class="font-medium text-sm text-[var(--accent)]">${expertRole}</div>
                                    <div class="text-[10px] text-[var(--text-secondary)]">${expertModel.modelKey}</div>
                                </div>
                                <div class="typing-indicator flex gap-1">
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                </div>
                            </div>
                            <div class="text-xs text-[var(--text-secondary)] mb-1" id="status-${expertDivId}">Thinking...</div>
                            <div class="text-xs text-gray-500 font-mono whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar" id="stream-${expertDivId}"></div>
                        </div>`;
                        
                        const prompt = `
                        You are participating in a Deep Research Pipeline.
                        ROLE: ${expertRole}
                        STAGE: ${stage.name}
                        
                        CONTEXT SO FAR:
                        ${aggregationContext ? aggregationContext : "Initial Problem Statement: " + originalContent}
                        
                        TASK: Provide your specialized analysis based on your role. Be critical and thorough.
                        `;

                        try {
                            const onExpertToken = (text, thinking, chunk) => {
                                if(state.currentChatId !== chatId) return;
                                const el = document.getElementById(`stream-${expertDivId}`);
                                if(el) { el.textContent += chunk; el.scrollTop = el.scrollHeight; }
                                const st = document.getElementById(`status-${expertDivId}`);
                                if(st) st.textContent = thinking ? "Thinking..." : "Generating...";
                            };

                            let res;
                            try {
                                res = await callModelWithFallback(expertModel.provider, expertModel.modelId, [{ role: 'user', content: prompt }], 0, onExpertToken);
                            } catch(primaryError) {
                                const fallbackKey = `${stage.id}_${idx}`;
                                const fallbackVal = RESEARCH_FALLBACKS[fallbackKey];
                                if(fallbackVal) {
                                    const [fp, fm] = fallbackVal.split('|');
                                    const st = document.getElementById(`status-${expertDivId}`);
                                    if(st) st.textContent = `Fallback to ${fm}...`;
                                    res = await callModelWithFallback(fp, fm, [{ role: 'user', content: prompt }], 0, onExpertToken);
                                    res.content = `[Fallback Used: ${fm}]\n` + res.content;
                                } else {
                                    throw primaryError;
                                }
                            }

                            if(state.currentChatId !== chatId) return;
                            
                            stageResults.push(`### ${expertRole}\n${res.content}`);
                            
                            const card = document.getElementById(expertDivId);
                            if(card) {
                                card.className = "expert-card complete rounded-xl p-3 mb-2";
                                card.innerHTML = `
                                    <div class="flex items-center gap-2 mb-2">
                                        <span>${PROVIDERS[expertModel.provider].icon}</span>
                                        <div class="flex-1 min-w-0">
                                            <div class="font-medium text-sm text-[var(--accent)]">${expertRole}</div>
                                            <div class="text-[10px] text-[var(--text-secondary)]">${expertModel.modelKey}</div>
                                        </div>
                                        <i class="fas fa-check-circle text-green-500"></i>
                                    </div>
                                    ${res.thinking ? `<div class="thinking-block"><div class="thinking-header"><i class="fas fa-brain"></i> Thinking Process</div><div class="text-[var(--text-secondary)] text-xs whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar">${escapeHtml(res.thinking)}</div></div>` : ''}
                                    <div class="text-sm max-h-64 overflow-y-auto">${formatMarkdown(res.content)}</div>
                                `;
                            }
                        } catch (e) {
                            stageResults.push(`### ${expertRole}\n[Failed: ${e.message}]`);
                            const card = document.getElementById(expertDivId);
                            if(card) {
                                card.className = "expert-card error rounded-xl p-3 mb-2";
                                card.innerHTML = `<div class="font-bold text-[10px] text-red-500">${expertRole} (Failed)</div>`;
                            }
                        }
                    }));
                } else {
                    let masterModel = getDefaultModel();
                    const configVal = state.researchConfig[`${stage.id}_agg`];
                    if(configVal) {
                        const [p, m] = configVal.split('|');
                        masterModel = { provider: p, modelId: m, modelKey: m };
                    }
                    
                    stageResults.push(`Final Synthesis Running on ${masterModel.modelKey || masterModel.modelId}...`); 
                }

                if(state.currentChatId !== chatId) return;

                const aggPrompt = `
                You are the Aggregator for ${stage.name}.
                AGGREGATION STYLE: ${state.aggregationStyle.toUpperCase()}
                
                INPUTS:
                ${stageResults.join('\n\n')}
                
                TASK: Synthesize these inputs into a cohesive output for this stage.
                ${stage.id === 'stage5' ? 'This is the Final Stage. Produce the Final Executive Summary, Core Analysis, and Conclusion.' : 'Prepare the output to be used as context for the next stage.'}
                `;

                const spinner = document.getElementById(`spin-${stageId}`);
                if(spinner) spinner.className = "fas fa-cog animate-spin text-orange-500";

                let aggModel = getDefaultModel();
                if(stage.id === 'stage5') {
                     const configVal = state.researchConfig[`${stage.id}_agg`];
                     if(configVal) {
                        const [p, m] = configVal.split('|');
                        aggModel = { provider: p, modelId: m, modelKey: m };
                     }
                }

                let aggRes;
                try {
                    aggRes = await callModelWithFallback(aggModel.provider, aggModel.modelId, [{ role: 'user', content: aggPrompt }]);
                } catch (aggError) {
                    const fallbackKey = `${stage.id}_agg`;
                    const fallbackVal = RESEARCH_FALLBACKS[fallbackKey];
                    if(fallbackVal) {
                        const [fp, fm] = fallbackVal.split('|');
                        if(spinner) spinner.className = "fas fa-exclamation-triangle text-yellow-500";
                        aggRes = await callModelWithFallback(fp, fm, [{ role: 'user', content: aggPrompt }]);
                        aggRes.content = `[Fallback Aggregator Used: ${fm}]\n` + aggRes.content;
                    } else {
                        throw aggError;
                    }
                }
                
                if(state.currentChatId !== chatId) return;

                aggregationContext = aggRes.content;
                stageOutputs.push(aggRes.content);

                if(spinner) spinner.className = "fas fa-check-circle text-green-500";
                
                expertsContainer.innerHTML += `
                <div class="col-span-full mt-2 pt-2 border-t border-[var(--border)]">
                    <div class="font-bold text-xs text-[var(--text-primary)] mb-1">AGGREGATION RESULT</div>
                    ${aggRes.thinking ? `<div class="thinking-block"><div class="thinking-header">Aggregator Thinking</div><div class="text-[10px]">${escapeHtml(aggRes.thinking)}</div></div>`:''}
                    <div class="text-sm prose max-w-none dark:prose-invert">${formatMarkdown(aggRes.content)}</div>
                </div>`;
                
                if(stage.id === 'stage5') {
                    window.lastAnswer = aggRes.content;
                    const assistMsgObj = { role: 'assistant', content: aggRes.content };
                    state.messages.push(assistMsgObj);
                    const currentChat = state.chatHistory.find(c => c.id === state.currentChatId);
                    if(currentChat) currentChat.messages.push(assistMsgObj);
                    localStorage.setItem('sahu_chat_history', JSON.stringify(state.chatHistory));
                    
                    container.innerHTML += `<div class="mt-6 p-4 rounded-xl bg-[var(--bg-tertiary)] border border-[var(--accent)] shadow-lg"><div class="font-bold text-lg mb-4 gradient-text">Final Research Output</div><div class="prose max-w-none text-sm">${formatMarkdown(aggRes.content)}</div></div>`;
                }
            }
            
            container.innerHTML += `
                <div class="export-buttons">
                    <button class="export-btn" onclick="copyToClipboard()"><i class="fas fa-copy"></i><span>Copy</span></button>
                    <button class="export-btn" onclick="downloadTxt()"><i class="fas fa-file-alt"></i><span>TXT</span></button>
                    <button class="export-btn" onclick="downloadPdf()"><i class="fas fa-file-pdf"></i><span>PDF</span></button>
                    <button class="export-btn" onclick="downloadDocx()"><i class="fas fa-file-word"></i><span>DOCX</span></button>
                </div>`;
            container.scrollTop = container.scrollHeight;
        };

        window.sendMessage = async function() {
            try {
                const input = document.getElementById('userInput');
                if(!input) return;
                
                let content = input.value.trim();
                
                if (state.isProcessing && (Date.now() - (window.lastProcessStart || 0) > 60000)) {
                     state.isProcessing = false; 
                }

                if (!content && !state.uploadedFile) return;
                if (state.isProcessing) return;
                
                window.lastProcessStart = Date.now(); 
                state.isProcessing = true; 
                document.getElementById('sendBtn').disabled = true;

                document.getElementById('welcomeScreen').classList.add('hidden');
                document.getElementById('discoveryFeed').style.display = 'none';
                const container = document.getElementById('messagesContainer');
                container.classList.remove('hidden');

                if (!state.currentChatId) {
                    state.currentChatId = Date.now().toString();
                    state.chatHistory.unshift({ id: state.currentChatId, title: content.substring(0, 50), messages: [], timestamp: Date.now() });
                }
                const thisChatId = state.currentChatId;

                let displayContent = content;
                if(state.uploadedFile) displayContent += `\n[File: ${state.uploadedFile.name}]`;
                
                const userMsgObj = { role: 'user', content: displayContent };
                state.messages.push(userMsgObj);
                const currentChat = state.chatHistory.find(c => c.id === state.currentChatId);
                if(currentChat) currentChat.messages.push(userMsgObj);
                localStorage.setItem('sahu_chat_history', JSON.stringify(state.chatHistory));
                renderChatHistory();

                container.innerHTML += `<div class="flex justify-end"><div class="message-user px-4 py-3 rounded-2xl max-w-[85%] shadow-lg"><p class="text-white text-sm whitespace-pre-wrap">${escapeHtml(displayContent)}</p><div class="text-[10px] text-white/70 mt-1 flex gap-2"><span>${state.mode.toUpperCase()} MODE</span></div></div></div>`;
                input.value = ''; input.style.height = 'auto'; removeFile();

                const searchId = `search-${Date.now()}`;
                
                let fullPrompt = content;
                
                // --- PROMPT REFINER (All modes except Search) ---
                if (state.mode !== 'search') {
                    try {
                        const refinerModel = { provider: 'nvidia', modelId: 'nvidia/llama-3.1-nemotron-70b-instruct' }; // Using reliable model as proxy for "gpt-oss-120b" concept
                        // Note: Using a reliable model available in the list. User asked for "gpt oss 120b", mapping to a high-quality open model.
                        
                        const refineSystemPrompt = "You are a Prompt Refiner. Your task is to read the user's query and rewrite it to be more precise, detailed, and optimized for LLMs. Do NOT answer the query. ONLY output the refined prompt text. Do not add any conversational filler.";
                        
                        // Silent call - no UI
                        const refinedRes = await callModelWithFallback(refinerModel.provider, refinerModel.modelId, [{ role: 'system', content: refineSystemPrompt }, { role: 'user', content: fullPrompt }]);
                        
                        if (refinedRes && refinedRes.content) {
                            fullPrompt = refinedRes.content.trim();
                            // console.log("Prompt Refined:", fullPrompt); // Debug
                        }
                    } catch (e) {
                        // console.error("Refiner failed, using original prompt", e);
                    }
                }

                if (state.webSearchEnabled) {
                    container.innerHTML += `<div class="p-3 mb-2 rounded-xl bg-[var(--bg-tertiary)] text-xs border border-dashed border-[var(--accent)]" id="${searchId}"><i class="fas fa-globe animate-spin mr-2"></i>Searching Web...</div>`;
                    
                    const searchResJson = await searchWeb(content); 
                    const searchRes = JSON.parse(searchResJson);
                    const searchEl = document.getElementById(searchId);

                    if(searchEl) {
                        if(searchRes.length > 0) {
                            state.lastSources = searchRes;
                            const isSearchMode = state.mode === 'search';
                            let gridClass = `grid grid-cols-1 gap-2`;
                            if (!isSearchMode) { gridClass += ` max-h-60 overflow-y-auto scrollbar-thin pr-1`; }
                            
                            searchEl.className = "p-4 mb-4 rounded-xl bg-[var(--bg-secondary)] border border-[var(--border)] shadow-sm";
                            searchEl.innerHTML = `
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center gap-2">
                                        <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center"><i class="fas fa-search"></i></div>
                                        <div><div class="font-semibold text-sm">Sources</div><div class="text-xs text-[var(--text-secondary)]">Found ${searchRes.length} results</div></div>
                                    </div>
                                    ${isSearchMode ? '<div class="sahu-search-header text-sm">SahuAI Search</div>' : ''}
                                </div>
                                <div class="${gridClass}">
                                    ${searchRes.map((s, idx) => `
                                        <div class="p-3 rounded-lg bg-[var(--bg-tertiary)] border border-transparent hover:border-[var(--accent)] transition-all h-full">
                                            <a href="${s.link}" target="_blank" class="flex flex-col gap-2 h-full group text-decoration-none">
                                                <div class="flex items-center gap-2">
                                                    <img src="https://www.google.com/s2/favicons?domain=${new URL(s.link).hostname}" class="w-4 h-4 opacity-70" onerror="this.src='about:blank'">
                                                    <div class="font-medium text-xs text-blue-600 truncate flex-1">${escapeHtml(s.source)}</div>
                                                    <span class="bg-gray-200 px-1.5 py-0.5 rounded text-[8px] font-bold">${idx + 1}</span>
                                                </div>
                                                <div class="font-medium text-xs text-[var(--text-primary)] line-clamp-2 leading-tight group-hover:underline">${escapeHtml(s.title)}</div>
                                                <div class="text-[10px] text-[var(--text-secondary)] line-clamp-2">${escapeHtml(s.snippet)}</div>
                                            </a>
                                        </div>`).join('')}
                                </div>`;
                            
                            const searchContext = `\n\n[MANDATORY WEB SEARCH CONTEXT]:\nCurrent Date: ${new Date().toISOString().split('T')[0]}\n${searchRes.map((s, i)=>`[${i+1}] Source: ${s.title} (${s.link})\nEngine: ${s.source}\nDate: ${s.date || 'N/A'}\nSnippet: ${s.snippet}`).join('\n\n')}\n[END CONTEXT]\n`;
                            fullPrompt += searchContext;
                        } else {
                            searchEl.style.display = 'none';
                        }
                    }
                }

                if (state.mode === 'research') {
                    await runDeepResearch(fullPrompt, container, thisChatId);
                    state.isProcessing = false; 
                    document.getElementById('sendBtn').disabled = false;
                    updateTokenCounter();
                    return;
                }
                
                // Check for Debate Mode override
                if (state.debateMode && (state.mode === 'standard' || state.mode === 'task' || state.mode === 'research')) {
                    await runDebatePipeline(fullPrompt, container, thisChatId);
                    state.isProcessing = false;
                    document.getElementById('sendBtn').disabled = false;
                    updateTokenCounter();
                    return;
                }

                const activeModels = state.selectedModels.filter(m => state.activeProviders.includes(m.provider));
                if (activeModels.length === 0) { showToast('No models selected', 'error'); openModelSelector(); state.isProcessing = false; document.getElementById('sendBtn').disabled = false; return; }

                const expertGridId = 'expert-grid-' + Date.now();
                container.innerHTML += `<div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4" id="${expertGridId}"></div>`;
                const expertGrid = document.getElementById(expertGridId);
                
                if(expertGrid) {
                    expertGrid.innerHTML = activeModels.map((m, i) => 
                        `<div class="expert-card thinking rounded-xl p-3" id="expert-${i}">
                            <div class="flex items-center gap-2 mb-2">
                                <span>${PROVIDERS[m.provider].icon}</span>
                                <div class="flex-1 min-w-0"><div class="font-medium text-sm truncate">${m.modelKey}</div></div>
                                <div class="typing-indicator flex gap-1">
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                    <span class="w-1.5 h-1.5 bg-yellow-400 rounded-full"></span>
                                </div>
                            </div>
                            <div class="text-xs text-[var(--text-secondary)]" id="expert-text-${i}">Thinking & Generating...</div>
                            <div class="text-xs mt-2 overflow-hidden max-h-32 text-gray-500 transition-all whitespace-pre-wrap" id="expert-stream-${i}"></div>
                        </div>`
                    ).join('');
                }

                const expertResults = [];
                
                await Promise.all(activeModels.map(async (model, idx) => {
                    try {
                        const onTokenUpdate = (text, thinking, chunk) => {
                            if(state.currentChatId !== thisChatId) return;
                            const cardText = document.getElementById(`expert-stream-${idx}`);
                            const cardStatus = document.getElementById(`expert-text-${idx}`);
                            if(cardText) { cardText.textContent += chunk; cardText.scrollTop = cardText.scrollHeight; }
                            if(cardStatus) { cardStatus.textContent = thinking ? "Thinking..." : "Generating..."; }
                        };

                        let res = await callModelWithFallback(model.provider, model.modelId, [{ role: 'user', content: fullPrompt }], 0, onTokenUpdate);
                        
                        if(state.currentChatId !== thisChatId) return;

                        expertResults[idx] = { ...model, ...res, success: true };
                        
                        const card = document.getElementById(`expert-${idx}`);
                        if(card) {
                            card.className = 'expert-card complete rounded-xl p-3';
                            card.innerHTML = `<div class="flex items-center gap-2 mb-2"><span>${PROVIDERS[model.provider].icon}</span><div class="flex-1 min-w-0"><div class="font-medium text-sm truncate">${model.modelKey}</div><div class="text-[10px] text-[var(--text-secondary)]">${PROVIDERS[model.provider].name}</div></div><i class="fas fa-check-circle text-green-500"></i></div>${res.thinking ? `<div class="thinking-block"><div class="thinking-header"><i class="fas fa-brain"></i> Thinking Process</div><div class="text-[var(--text-secondary)] text-xs whitespace-pre-wrap max-h-32 overflow-y-auto">${escapeHtml(res.thinking)}</div></div>` : ''}<div class="text-sm max-h-64 overflow-y-auto">${formatMarkdown(res.content)}</div>`;
                        }
                    } catch (e) {
                        expertResults[idx] = { success: false, error: e.message, modelKey: model.modelKey }; 
                        const card = document.getElementById(`expert-${idx}`);
                        if(card) {
                            card.className = 'expert-card error rounded-xl p-3';
                            card.innerHTML = `<div class="text-red-500 text-xs"><i class="fas fa-exclamation-circle"></i> ${model.modelKey}: ${e.message}</div>`;
                        }
                    }
                }));

                if(state.currentChatId !== thisChatId) return;

                const successfulExperts = expertResults.filter(r => r && r.success && r.content);
                if (successfulExperts.length > 1) {
                    const councilId = `council-${Date.now()}`;
                    container.innerHTML += `<div id="${councilId}" class="consensus-panel mb-4"></div>`;
                    const councilEl = document.getElementById(councilId);
                    if(councilEl) {
                        let matrixHtml = '<div class="overflow-x-auto"><table class="agreement-table"><thead><tr><th>Model</th>';
                        successfulExperts.forEach(m => matrixHtml += `<th>${m.modelKey.substring(0, 10)}...</th>`);
                        matrixHtml += '</tr></thead><tbody>';

                        successfulExperts.forEach((rowModel, i) => {
                            matrixHtml += `<tr><td class="font-bold text-xs truncate max-w-[100px]" title="${rowModel.modelKey}">${rowModel.modelKey}</td>`;
                            successfulExperts.forEach((colModel, j) => {
                                if (i === j) {
                                    matrixHtml += '<td class="bg-gray-100 text-center text-xs">-</td>';
                                } else {
                                    const sim = stringSimilarity.compareTwoStrings(rowModel.content, colModel.content);
                                    const pct = Math.round(sim * 100);
                                    let colorClass = 'text-red-500';
                                    if (pct >= 80) colorClass = 'text-green-600 font-bold';
                                    else if (pct >= 50) colorClass = 'text-yellow-600 font-medium';
                                    matrixHtml += `<td class="text-center text-xs ${colorClass}">${pct}%</td>`;
                                }
                            });
                            matrixHtml += '</tr>';
                        });
                        matrixHtml += '</tbody></table></div><div class="text-[10px] text-[var(--text-secondary)] mt-2 text-right flex justify-end gap-3"><span><i class="fas fa-circle text-green-500 text-[8px]"></i> >80% High</span><span><i class="fas fa-circle text-yellow-500 text-[8px]"></i> 50-80% Med</span><span><i class="fas fa-circle text-red-500 text-[8px]"></i> &lt;50% Low</span></div>';
                        councilEl.innerHTML = `<div class="font-bold text-sm mb-2 flex items-center gap-2 text-[var(--accent)]"><i class="fas fa-balance-scale"></i> Model Council Agreement</div>${matrixHtml}`;
                    }
                }

                const stageVal = document.getElementById('stageSelector').value;
                let stagesToRun = [];
                if (stageVal === '1') stagesToRun = [3];
                else if (stageVal === '2') stagesToRun = [1, 3]; 
                else if (stageVal === '3') stagesToRun = [1, 2, 3]; 
                
                let currentContext = successfulExperts.map(r => `### ${r.modelKey}\n${r.content}`).join('\n\n');
                window.lastAnswer = currentContext; 
                
                if (!currentContext && activeModels.length > 0) {
                     container.innerHTML += `<div class="text-red-500 p-4 border border-red-200 rounded-xl">All experts failed to respond. Check API keys and connection.</div>`;
                } else {
                    for (const stage of stagesToRun) {
                         if(state.currentChatId !== thisChatId) return;

                         const aggModel = activeModels.find(m => m.stage === String(stage));
                         const modelToUse = aggModel || activeModels[0];
                         
                         if (!modelToUse) continue;

                         const stageId = `stage-${stage}-${Date.now()}`;
                         const stageContentId = `content-${stageId}`;
                         
                         container.innerHTML += `<div class="aggregator-response stage-${stage} rounded-2xl p-4" id="${stageId}"><div class="flex items-center gap-3 mb-3"><div class="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-sm bg-gray-400">${stage}</div><div><span class="font-semibold text-sm">Stage ${stage}</span><p class="text-xs text-[var(--text-secondary)]">${modelToUse.modelKey}</p></div></div><div class="text-sm whitespace-pre-wrap" id="${stageContentId}">Generating...</div></div>`;
                         container.scrollTop = container.scrollHeight;
                         try {
                             const prompt = AGGREGATOR_PROMPTS[`stage${stage}`];
                             
                             const onStageToken = (text, thinking, chunk) => {
                                 if(state.currentChatId !== thisChatId) return;
                                 const el = document.getElementById(stageContentId);
                                 if(el) el.textContent += chunk; 
                                 container.scrollTop = container.scrollHeight;
                             };
                             
                             document.getElementById(stageContentId).textContent = "";

                             const res = await callModelWithFallback(modelToUse.provider, modelToUse.modelId, [{ role: 'system', content: prompt }, { role: 'user', content: currentContext }], 0, onStageToken);
                             
                             if(state.currentChatId !== thisChatId) return;

                             currentContext = res.content;
                             window.lastAnswer = res.content;

                             if (stage === stagesToRun[stagesToRun.length - 1]) {
                                 const assistMsgObj = { role: 'assistant', content: res.content };
                                 state.messages.push(assistMsgObj);
                                 if(currentChat) currentChat.messages.push(assistMsgObj);
                                 localStorage.setItem('sahu_chat_history', JSON.stringify(state.chatHistory));
                             }
                             
                             const stageEl = document.getElementById(stageId);
                             if(stageEl) {
                                 stageEl.innerHTML = `
                                    <div class="flex items-center gap-3 mb-3">
                                        <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-sm bg-green-500">${stage}</div>
                                        <div class="flex-1"><span class="font-semibold text-sm">Stage ${stage}</span><p class="text-xs text-[var(--text-secondary)]">${modelToUse.modelKey}</p></div>
                                        <button onclick="togglePin('${escapeHtml(res.content.substring(0,100))}')" class="text-[var(--text-secondary)] hover:text-yellow-500"><i class="fas fa-thumbtack"></i></button>
                                    </div>
                                    ${res.thinking ? `<div class="thinking-block"><div class="thinking-header"><i class="fas fa-brain"></i> Thinking</div><div class="text-[var(--text-secondary)] text-xs whitespace-pre-wrap">${escapeHtml(res.thinking)}</div></div>` : ''}
                                    <div class="prose max-w-none text-sm">${formatMarkdown(res.content)}</div>
                                    `;
                             }
                         } catch (e) {
                             const stageEl = document.getElementById(stageId);
                             if(stageEl) stageEl.innerHTML += `<div class="text-red-500 text-sm mt-2">Aggregation Failed: ${e.message}</div>`;
                         }
                    }
                }
                
                container.innerHTML += `
                <div class="export-buttons">
                    <button class="export-btn" onclick="copyToClipboard()"><i class="fas fa-copy"></i><span>Copy</span></button>
                    <button class="export-btn" onclick="downloadTxt()"><i class="fas fa-file-alt"></i><span>TXT</span></button>
                    <button class="export-btn" onclick="downloadPdf()"><i class="fas fa-file-pdf"></i><span>PDF</span></button>
                    <button class="export-btn" onclick="downloadDocx()"><i class="fas fa-file-word"></i><span>DOCX</span></button>
                    <button class="export-btn" onclick="downloadMarkdown()"><i class="fab fa-markdown"></i><span>MD</span></button>
                    <button class="export-btn" onclick="openPreview()"><i class="fas fa-eye"></i><span>Preview</span></button>
                </div>`;
                container.scrollTop = container.scrollHeight;
            } catch(error) {
                console.error("Critical error in sendMessage:", error);
                showToast("Error sending message: " + error.message, "error");
            } finally {
                state.isProcessing = false;
                document.getElementById('sendBtn').disabled = false;
                updateTokenCounter();
            }
        };

        function formatMarkdown(text) { 
            if(!text) return '';
            
            text = text.replace(/\[(\d+)\]/g, (match, id) => {
                const src = state.lastSources[parseInt(id)-1];
                if(src) {
                    return `<a href="${src.link}" target="_blank" class="citation relative">[${id}]<div class="citation-tooltip"><div class="font-bold mb-1 truncate">${escapeHtml(src.title)}</div><div class="line-clamp-3">${escapeHtml(src.snippet)}</div><div class="mt-1 text-[9px] text-gray-400 truncate">${src.link}</div></div></a>`;
                }
                return match;
            });

            text = text.replace(/\[TIMELINE_START\]([\s\S]*?)\[TIMELINE_END\]/g, (match, jsonStr) => {
                try {
                    const events = JSON.parse(jsonStr);
                    if(!Array.isArray(events)) return '';
                    return `<div class="timeline-container"><div class="font-bold text-sm mb-3 flex items-center gap-2"><i class="fas fa-history text-[var(--accent)]"></i> Temporal Analysis</div>${events.map(e => `
                        <div class="timeline-item">
                            <div class="timeline-date">${escapeHtml(e.date)}</div>
                            <div class="timeline-content">${escapeHtml(e.event)}</div>
                        </div>`).join('')}</div>`;
                } catch(e) { return ''; }
            });

            const artifactRegex = /```(\w+)?\n([\s\S]*?)```/g;
            return text.replace(artifactRegex, (match, lang, code) => {
                lang = lang || 'text';
                const escapedCode = escapeHtml(code);
                const id = 'code-' + Math.random().toString(36).substr(2, 9);
                let actions = `<button onclick="navigator.clipboard.writeText(document.getElementById('${id}').innerText).then(()=>showToast('Code copied'))" class="hover:text-[var(--accent)]"><i class="fas fa-copy"></i> Copy</button>`;
                
                if(lang === 'python') actions += `<button onclick="executeTool('CODE:${code.replace(new RegExp('&quot;', 'g'), '\\&quot;').replace(new RegExp('\\n', 'g'), '\\n')}')" class="hover:text-green-500 ml-2"><i class="fas fa-play"></i> Run</button>`;
                
                if(lang === 'html' || state.mode === 'task') {
                     actions += `<button onclick="openArtifact(document.getElementById('${id}').innerText, '${lang}')" class="hover:text-blue-500 ml-2 font-bold"><i class="fas fa-desktop"></i> Open Canvas</button>`;
                }

                return `
                <div class="artifact-container">
                    <div class="artifact-header">
                        <span>${lang.toUpperCase()}</span>
                        <div class="flex gap-2 text-xs">${actions}</div>
                    </div>
                    <div class="artifact-content">
                        <pre><code id="${id}" class="language-${lang}">${escapedCode}</code></pre>
                    </div>
                </div>`;
            })
            .replace(/`([^`]+)`/g, '<code class="bg-[var(--bg-tertiary)] px-1 py-0.5 rounded text-xs">$1</code>')
            .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
            .replace(/\n/g, '<br>'); 
        }

        window.copyToClipboard = () => navigator.clipboard.writeText(window.lastAnswer || '').then(() => showToast('Copied!'));
        window.downloadMarkdown = () => saveAs(new Blob([window.lastAnswer || ''], {type: "text/markdown"}), "sahu-chat.md");
        window.downloadTxt = () => saveAs(new Blob([window.lastAnswer || ''], { type: 'text/plain' }), 'sahu-answer.txt');
        
        window.downloadPdf = () => { 
            if(!window.jspdf) { showToast('PDF library not loaded', 'error'); return; }
            try {
                const doc = new window.jspdf.jsPDF(); 
                const lines = doc.splitTextToSize(window.lastAnswer || '', 180); 
                doc.text(lines, 15, 20); 
                doc.save('sahu-answer.pdf'); 
            } catch(e) { showToast('PDF Export Error', 'error'); }
        };
        
        window.downloadDocx = () => { 
            if(!window.docx) { showToast('DOCX library not loaded', 'error'); return; }
            try {
                const { Document, Packer, Paragraph, TextRun } = window.docx; 
                const doc = new Document({ sections: [{ children: [new Paragraph({ children: [new TextRun(window.lastAnswer || '')] })] }] }); 
                Packer.toBlob(doc).then(blob => saveAs(blob, 'sahu-answer.docx')); 
            } catch(e) { showToast('DOCX Export Error', 'error'); }
        };

        window.openPreview = () => { const w = window.open(); w.document.write(window.lastAnswer); };
        
        if(window.location.hash) {
            try {
                const data = JSON.parse(LZString.decompressFromEncodedURIComponent(window.location.hash.substring(1)));
                if(data) { state.messages = data; showToast('Conversation Restored'); }
            } catch(e) {}
        }
    </script>

</body></html>
